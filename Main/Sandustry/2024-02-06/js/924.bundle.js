(()=>{"use strict";var e,t,r,n,a={3734:(e,t,r)=>{var n,a,o,i,l,s,d,u,c,v,h,p,f,y,g,m,S,x,A,b,M,C,R,k,T,w,F,B,z,D,J,P,I;r.d(t,{$U:()=>D,JU:()=>w,KW:()=>I,Np:()=>d,RJ:()=>a,Z5:()=>x,b1:()=>B,bF:()=>f,dD:()=>p,es:()=>v,ev:()=>h,qy:()=>u,s0:()=>z,vJ:()=>A,vZ:()=>n,xQ:()=>b,yT:()=>y}),function(e){e[e.Empty=0]="Empty",e[e.Element=1]="Element",e[e.SandSoil=2]="SandSoil",e[e.SporeSoil=3]="SporeSoil",e[e.Fog=4]="Fog",e[e.FogJetpackBlock=5]="FogJetpackBlock",e[e.FogWater=6]="FogWater",e[e.FreezingIceSoil=7]="FreezingIceSoil",e[e.Divider=8]="Divider",e[e.Grass=9]="Grass",e[e.Moss=10]="Moss",e[e.GoldSoil=11]="GoldSoil",e[e.Petal=12]="Petal",e[e.FogLava=13]="FogLava",e[e.Fluxite=14]="Fluxite",e[e.Block=15]="Block",e[e.SlidingBlock=16]="SlidingBlock",e[e.SlidingBlockLeft=17]="SlidingBlockLeft",e[e.SlidingBlockRight=18]="SlidingBlockRight",e[e.ConveyorLeft=19]="ConveyorLeft",e[e.ConveyorRight=20]="ConveyorRight",e[e.ShakerLeft=21]="ShakerLeft",e[e.ShakerRight=22]="ShakerRight",e[e.Bedrock=23]="Bedrock",e[e.VelocitySoaker=24]="VelocitySoaker",e[e.Ice=25]="Ice",e[e.Grower=26]="Grower",e[e.NascentWater=27]="NascentWater",e[e.SandiumSoil=28]="SandiumSoil",e[e.Obsidian=29]="Obsidian",e[e.Crackstone=30]="Crackstone"}(n||(n={})),function(e){e[e.Sand=1]="Sand",e[e.Particle=2]="Particle",e[e.Water=3]="Water",e[e.WetSand=4]="WetSand",e[e.Sandium=5]="Sandium",e[e.Slag=6]="Slag",e[e.Gold=7]="Gold",e[e.Gloom=8]="Gloom",e[e.Shake=9]="Shake",e[e.Steam=10]="Steam",e[e.Fire=11]="Fire",e[e.FreezingIce=12]="FreezingIce",e[e.Flame=13]="Flame",e[e.BurntSlag=14]="BurntSlag",e[e.Spore=15]="Spore",e[e.WetSpore=16]="WetSpore",e[e.Seed=17]="Seed",e[e.Petalium=18]="Petalium",e[e.Lava=19]="Lava",e[e.Basalt=20]="Basalt"}(a||(a={})),function(e){e[e.Clip=1]="Clip",e[e.Single=2]="Single",e[e.OverTime=3]="OverTime"}(o||(o={})),function(e){e[e.Bullet=1]="Bullet",e[e.Rocket=2]="Rocket",e[e.GrapplingHook=3]="GrapplingHook",e[e.Fire=4]="Fire",e[e.Bouncer=5]="Bouncer"}(i||(i={})),function(e){e[e.Weapon=1]="Weapon",e[e.Building=2]="Building",e[e.Tool=3]="Tool"}(l||(l={})),function(e){e[e.Weapon=1]="Weapon",e[e.Tool=2]="Tool",e[e.Consumable=3]="Consumable"}(s||(s={})),function(e){e[e.Shovel=1]="Shovel",e[e.Grabber=2]="Grabber",e[e.Demolisher=3]="Demolisher",e[e.GrapplingHook=4]="GrapplingHook",e[e.Vacuum=5]="Vacuum",e[e.Gun=6]="Gun",e[e.Copier=7]="Copier",e[e.RocketLauncher=8]="RocketLauncher",e[e.Bouncer=9]="Bouncer",e[e.Shotgun=10]="Shotgun",e[e.Teleporter=11]="Teleporter",e[e.Flamethrower=12]="Flamethrower",e[e.PipeRemover=13]="PipeRemover",e[e.Hauler=14]="Hauler",e[e.Cryoblaster=15]="Cryoblaster"}(d||(d={})),function(e){e[e.Start=1]="Start",e[e.Active=2]="Active",e[e.End=3]="End"}(u||(u={})),function(e){e[e.Dig=1]="Dig",e[e.Shoot=2]="Shoot",e[e.Spray=3]="Spray",e[e.Laser=4]="Laser"}(c||(c={})),function(e){e[e.Solid=1]="Solid",e[e.Liquid=2]="Liquid",e[e.Particle=3]="Particle",e[e.Gas=4]="Gas",e[e.Static=5]="Static",e[e.Slushy=6]="Slushy",e[e.Wisp=7]="Wisp"}(v||(v={})),function(e){e[e.ConveyorLeft=1]="ConveyorLeft",e[e.ConveyorRight=2]="ConveyorRight",e[e.ShakerLeft=3]="ShakerLeft",e[e.ShakerRight=4]="ShakerRight",e[e.LauncherUp=5]="LauncherUp",e[e.LauncherLeft=6]="LauncherLeft",e[e.LauncherRight=7]="LauncherRight",e[e.SplitterLeft=8]="SplitterLeft",e[e.SplitterRight=9]="SplitterRight",e[e.Dropper=10]="Dropper",e[e.Foundation=11]="Foundation",e[e.FoundationAngledLeft=12]="FoundationAngledLeft",e[e.FoundationTriangleLeftDel=13]="FoundationTriangleLeftDel",e[e.FoundationAngledRight=14]="FoundationAngledRight",e[e.FoundationTriangleRightDel=15]="FoundationTriangleRightDel",e[e.Collector=16]="Collector",e[e.FilterLeft=17]="FilterLeft",e[e.FilterRight=18]="FilterRight",e[e.SlidingFoundation=19]="SlidingFoundation",e[e.VelocitySoaker=20]="VelocitySoaker",e[e.Grower=21]="Grower",e[e.SoundBox=22]="SoundBox",e[e.Pipe=23]="Pipe",e[e.Pump=24]="Pump",e[e.LiquidVent=25]="LiquidVent",e[e.Light=26]="Light",e[e.GloomEmitter=27]="GloomEmitter"}(h||(h={})),function(e){e[e.Init=1]="Init",e[e.RunUpdate=2]="RunUpdate",e[e.SetCell=3]="SetCell",e[e.Blast=4]="Blast",e[e.Dig=5]="Dig",e[e.Vacuum=6]="Vacuum",e[e.AddStructure=7]="AddStructure",e[e.RemoveStructuresBetween=8]="RemoveStructuresBetween",e[e.HandleGrabber=9]="HandleGrabber",e[e.SwapElement=10]="SwapElement",e[e.SetChunkActive=11]="SetChunkActive",e[e.Tally=12]="Tally",e[e.Ignite=13]="Ignite",e[e.StartFogReveal=14]="StartFogReveal",e[e.SetTutorialStep=15]="SetTutorialStep",e[e.FireProjectileHit=16]="FireProjectileHit",e[e.StartWaterFreeze=17]="StartWaterFreeze",e[e.StartMelt=18]="StartMelt",e[e.Burn=19]="Burn",e[e.Explode=20]="Explode",e[e.TriggerShockwaves=21]="TriggerShockwaves",e[e.RedrawSurroundingCells=22]="RedrawSurroundingCells",e[e.IncrementFluxite=23]="IncrementFluxite",e[e.SpawnFluxiteParticles=24]="SpawnFluxiteParticles",e[e.DebugCell=25]="DebugCell",e[e.StartLavaFreeze=26]="StartLavaFreeze",e[e.PingChunk=27]="PingChunk",e[e.QueueSetCell=28]="QueueSetCell",e[e.InitFinished=29]="InitFinished",e[e.UpdateFinished=30]="UpdateFinished",e[e.SetPixel=31]="SetPixel",e[e.Collector=32]="Collector",e[e.TutorialStep=33]="TutorialStep",e[e.PlaySound=34]="PlaySound",e[e.AddLight=35]="AddLight",e[e.MoveCamera=36]="MoveCamera",e[e.SpawnWorldItem=37]="SpawnWorldItem",e[e.ForceCompleteObjective=38]="ForceCompleteObjective",e[e.Save=39]="Save",e[e.RunConveyorBelts=40]="RunConveyorBelts",e[e.UpdateStructure=41]="UpdateStructure",e[e.SetPaused=42]="SetPaused"}(p||(p={})),function(e){e[e.Main=1]="Main",e[e.Worker=2]="Worker",e[e.Manager=3]="Manager"}(f||(f={})),function(e){e[e.Even=1]="Even",e[e.Odd=2]="Odd",e[e.Both=3]="Both"}(y||(y={})),function(e){e.OpenBuildMenu="OpenBuildMenu",e.GrapplingHook="GrapplingHook",e.Escape="Escape",e.OpenTechTree="OpenTechTree",e.OpenInventory="OpenInventory",e.ReverseBuildDirection="ReverseBuildDirection",e.Marquee="Marquee",e.Pause="Pause",e.Copy="Copy",e.Delete="Delete",e.PauseCamera="PauseCamera",e.OpenUpgrades="OpenUpgrades",e.BuildMode="BuildMode",e.Demolish="Demolish",e.Jump="Jump",e.Ruler="Ruler",e.Left="Left",e.Right="Right",e.Boost="Boost",e.Descend="Descend"}(g||(g={})),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Pressed=3]="Pressed",e[e.Released=4]="Released",e[e.All=5]="All"}(m||(m={})),function(e){e[e.Building=1]="Building",e[e.Hotbar=2]="Hotbar",e[e.MainMenu=3]="MainMenu",e[e.TechTree=4]="TechTree",e[e.Research=5]="Research",e[e.InventoryItem=6]="InventoryItem",e[e.SubNavigation=7]="SubNavigation",e[e.FilterConfig=8]="FilterConfig"}(S||(S={})),function(e){e[e.MainMenu=1]="MainMenu",e[e.Intro=2]="Intro",e[e.Game=3]="Game"}(x||(x={})),function(e){e[e.Move=1]="Move",e[e.Dig=2]="Dig",e[e.Hotbar=3]="Hotbar",e[e.PickUpSand=4]="PickUpSand",e[e.WetSand=5]="WetSand",e[e.RefineWetSand=6]="RefineWetSand",e[e.SellGold=7]="SellGold",e[e.OpenTechTree=8]="OpenTechTree",e[e.UnlockRefining=9]="UnlockRefining",e[e.OpenBuildMenu=10]="OpenBuildMenu",e[e.BuildShaker=11]="BuildShaker",e[e.RefineGoldWithShaker=12]="RefineGoldWithShaker",e[e.UnlockLogistics=13]="UnlockLogistics",e[e.TutorialEnd=14]="TutorialEnd"}(A||(A={})),function(e){e[e.Refining1=1]="Refining1",e[e.Logistics1=2]="Logistics1",e[e.Guns1=3]="Guns1",e[e.Filters1=4]="Filters1",e[e.Tools1=5]="Tools1",e[e.Tools2=6]="Tools2",e[e.Refining2=7]="Refining2",e[e.Guns2=8]="Guns2",e[e.Drones1=9]="Drones1",e[e.Upgrading2=10]="Upgrading2",e[e.Filters2=11]="Filters2",e[e.Upgrading3=12]="Upgrading3",e[e.Upgrading4=13]="Upgrading4",e[e.Upgrading5=14]="Upgrading5",e[e.Upgrading6=15]="Upgrading6",e[e.Upgrading7=16]="Upgrading7",e[e.Upgrading8=17]="Upgrading8",e[e.Upgrading9=18]="Upgrading9",e[e.Upgrading10=19]="Upgrading10",e[e.Refining3=20]="Refining3",e[e.Refining4=21]="Refining4",e[e.Tools3=22]="Tools3",e[e.Pipes1=23]="Pipes1",e[e.Lights1=24]="Lights1",e[e.Drones2=25]="Drones2",e[e.Refining5=26]="Refining5",e[e.Tools4=27]="Tools4",e[e.Guns3=28]="Guns3"}(b||(b={})),function(e){e[e.Available=0]="Available",e[e.Visible=1]="Visible",e[e.Researched=2]="Researched",e[e.Unknown=3]="Unknown",e[e.Hidden=4]="Hidden"}(M||(M={})),function(e){e[e.ConveyorBelts=1]="ConveyorBelts",e[e.Shakers=2]="Shakers",e[e.UpdateMachinery=3]="UpdateMachinery",e[e.SpawnMainMenuElements=4]="SpawnMainMenuElements",e[e.Autosave=5]="Autosave",e[e.Pump=6]="Pump",e[e.EmitGloom=7]="EmitGloom",e[e.PingPumpChunksFIX=8]="PingPumpChunksFIX"}(C||(C={})),function(e){e[e.Linear=1]="Linear",e[e.Rectangular=2]="Rectangular"}(R||(R={})),function(e){e[e.Above=1]="Above",e[e.TransitioningAbove=2]="TransitioningAbove",e[e.TransitioningBelow=3]="TransitioningBelow",e[e.Below=4]="Below"}(k||(k={})),function(e){e[e.Available=1]="Available",e[e.FullyBlocked=2]="FullyBlocked",e[e.PartiallyBlocked=3]="PartiallyBlocked"}(T||(T={})),function(e){e[e.Hotbar=1]="Hotbar",e[e.SoundBoxConfig=2]="SoundBoxConfig",e[e.Debug=3]="Debug",e[e.Root=4]="Root",e[e.Menu=5]="Menu",e[e.Management=6]="Management",e[e.FilterConfig=7]="FilterConfig",e[e.Resources=8]="Resources",e[e.TechTree=9]="TechTree",e[e.Tutorial=10]="Tutorial",e[e.Loader=11]="Loader",e[e.Options=12]="Options",e[e.ShortcutHelper=13]="ShortcutHelper",e[e.Upgrades=14]="Upgrades",e[e.Tooltip=15]="Tooltip",e[e.Notifications=16]="Notifications",e[e.Objectives=17]="Objectives"}(w||(w={})),function(e){e[e.Unselected=0]="Unselected",e[e.Selected=1]="Selected",e[e.Copying=2]="Copying",e[e.Moving=3]="Moving"}(F||(F={})),function(e){e[e.None=0]="None",e[e.ObstacleStart=252]="ObstacleStart",e[e.Misc=253]="Misc",e[e.Darkness=254]="Darkness"}(B||(B={})),function(e){e[e.NoJetpack=1]="NoJetpack",e[e.NoGrab=2]="NoGrab",e[e.NoBuild=3]="NoBuild",e[e.NoFlamethrower=4]="NoFlamethrower"}(z||(z={})),function(e){e[e.Artifact1=1]="Artifact1",e[e.Artifact2=2]="Artifact2"}(D||(D={})),function(e){e[e.Boss1=1]="Boss1"}(J||(J={})),function(e){e[e.Digger=1]="Digger",e[e.Hauler=2]="Hauler"}(P||(P={})),function(e){e[e.Artifact=1]="Artifact"}(I||(I={}))},8288:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(7028),a=r(6921),o=r(6185);const i={init:function(e){e.session.lookup.conveyorBeltsGroupedByX=[];for(var t=function(t){e.session.lookup.conveyorBeltsGroupedByX.push(function(e){for(var t={},r=0,n=e;r<n.length;r++)t[n[r]]=[];return t}(a.CC)),o.A.getThreadIndexFromCellX(t,e.environment.threadMeta.threadCount)===e.environment.threadMeta.startingIndex&&e.store.structures.forEach((function(r){r.x===t&&a.CC.includes(r.type)&&e.session.lookup.conveyorBeltsGroupedByX[t/n.A.snapGridCellSize][r.type].push(r)}))},r=0;r<Math.floor(e.store.world.size.width/n.A.snapGridCellSize)*n.A.snapGridCellSize;r+=n.A.snapGridCellSize)t(r)},set:function(e,t,r){if("conveyorBeltsGroupedByX"===t)return function(e,t){e.session.lookup.conveyorBeltsGroupedByX[t.structure.x/n.A.snapGridCellSize][t.structure.type].push(t.structure)}(e,r)},remove:function(e,t,r){if("conveyorBeltsGroupedByX"===t){var a=r.structure,o=a.x,i=a.type,l=o/n.A.snapGridCellSize,s=e.session.lookup.conveyorBeltsGroupedByX[l][i],d=s.findIndex((function(e){return e.type===r.structure.type&&e.x===r.structure.x&&e.y===r.structure.y}));if(-1!==d)return s.splice(d,1);console.error("Could not find structure to remove in lookup",r.structure,s)}}}},3103:(e,t,r)=>{r.d(t,{Ls:()=>c,Y8:()=>i,in:()=>d,pp:()=>u});var n=r(7028),a=r(3734),o=r(9025),i=function(e,t){return 1e6*Math.sin(437057.545323*(112.01716*e+718.233*t))&255},l=function(e,t,r){r/=100;var n=function(t){return(t+e/30)%12},a=(t/=100)*Math.min(r,1-r),o=function(e){return r-a*Math.max(-1,Math.min(n(e)-3,Math.min(9-n(e),1)))};return[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4)),255]},s=n.A.debug.defaultBaseHue,d=(l(s,60,40),l(s,60,37),function(e,t,r,n){return e.session.colors.damagedSoilByColor?!!e.session.colors.damagedSoilByColor[t]&&!!e.session.colors.damagedSoilByColor[t][r]&&!!e.session.colors.damagedSoilByColor[t][r][n]:(console.log("NO ISDAMAMS",e.session.colors.damagedSoilByColor),!1)}),u=function(e,t,r,s){var u,c,v;if(s===a.vZ.Empty)return[0,0,0,0];if([a.vZ.SandSoil,a.vZ.SporeSoil,a.vZ.Bedrock,a.vZ.Fog,a.vZ.FogJetpackBlock,a.vZ.FogWater,a.vZ.FogLava,a.vZ.FreezingIceSoil,a.vZ.Ice,a.vZ.Divider,a.vZ.Grass,a.vZ.Moss,a.vZ.GoldSoil,a.vZ.Petal,a.vZ.Fluxite,a.vZ.SandiumSoil,a.vZ.Obsidian,a.vZ.Crackstone].includes(s)){for(var h=!1,p=t-5;p<t+5;p++)for(var f=r-5;f<r+5;f++)if(!(p<0||f<0||p>=e.store.world.matrix.length||f>=e.store.world.matrix[0].length)){var y=p-t,g=f-r,m=Math.sqrt(y*y+g*g);if(!(m>=5))if(n.A.useMultithreading){var S=e.shared.obstacleImageData,x=4*(p+f*S.width),A=S.data[x],b=S.data[x+1],M=S.data[x+2];(0===S.data[x+3]||d(e,A,b,M))&&(!1===h||h>m)&&(h=m)}else e.store.world.matrix[f][p]!==a.vZ.SandSoil&&(!1===h||h>m)&&(h=m)}if(!1===h)return[0,0,0,255];var C=null!==(c=((u={})[a.vZ.Bedrock]={H:0,S:0,L:66},u[a.vZ.Ice]={H:199,S:99,L:90},u[a.vZ.Divider]={H:30,S:100,L:50},u[a.vZ.GoldSoil]={H:60,S:100,L:50},u)[s])&&void 0!==c?c:{H:e.session.colors.scheme.soil[s][0][0],S:e.session.colors.scheme.soil[s][0][1],L:e.session.colors.scheme.soil[s][0][2]},R=C.H,k=C.S,T=C.L,w=T-T/4*(h-1);return s===a.vZ.Fog?[0,0,0,Math.max(1,10*h)]:l(R,k,w)}if([a.vZ.Block,a.vZ.ConveyorLeft,a.vZ.ConveyorRight,a.vZ.ShakerLeft,a.vZ.ShakerRight,a.vZ.SlidingBlock,a.vZ.SlidingBlockLeft,a.vZ.SlidingBlockRight,a.vZ.VelocitySoaker,a.vZ.Grower].includes(s))return[255,255,255,255];if([a.vZ.SandSoil,a.vZ.SporeSoil,a.vZ.FreezingIceSoil,a.vZ.Grass,a.vZ.Moss,a.vZ.GoldSoil,a.vZ.Petal].includes(s.cellType)){var F=(null===(v=o.l2[s.cellType])||void 0===v?void 0:v.hp)||4;return i(t,r)>s.hp/F*200?e.session.colors.scheme.soil[s.cellType][1]:e.session.colors.scheme.soil[s.cellType][2]}if(s.type===a.RJ.Sand)return(B=e.session.colors.scheme.element[a.RJ.Sand])[s.variantIndex];if(s.type===a.RJ.Particle){var B=e.session.colors.scheme.element[s.element.type];return s.element.type!==a.RJ.Sand?B[0]:B[s.element.variantIndex]}if(s.type===a.RJ.Water)return e.session.colors.scheme.element[a.RJ.Water][0];if(s.type===a.RJ.WetSand)return(B=e.session.colors.scheme.element[a.RJ.WetSand])[s.variantIndex];if(s.type===a.RJ.Slag)return(B=e.session.colors.scheme.element[a.RJ.Slag])[s.variantIndex];if(s.type===a.RJ.Gold)return(B=e.session.colors.scheme.element[a.RJ.Gold])[s.variantIndex];if(s.type===a.RJ.Steam)return e.session.colors.scheme.element[a.RJ.Steam][0];if(s.type===a.RJ.Spore)return(B=e.session.colors.scheme.element[a.RJ.Spore])[s.variantIndex];if(s.type===a.RJ.Petalium)return(B=e.session.colors.scheme.element[a.RJ.Petalium])[s.variantIndex];if(s.type===a.RJ.Seed)return(B=e.session.colors.scheme.element[a.RJ.Seed])[0];if(s.type===a.RJ.WetSpore)return(B=e.session.colors.scheme.element[a.RJ.WetSpore])[s.variantIndex];if(s.type===a.RJ.BurntSlag)return(B=e.session.colors.scheme.element[a.RJ.BurntSlag])[s.variantIndex];if(s.type===a.RJ.FreezingIce)return e.session.colors.scheme.element[a.RJ.FreezingIce][0];if(s.type===a.RJ.Flame)return(B=e.session.colors.scheme.element[a.RJ.Flame])[s.variantIndex];if(s.type===a.RJ.Fire){var z=s.duration.max-s.duration.left;return x=Math.floor(z/s.duration.max*4),e.session.colors.scheme.element[a.RJ.Fire][x]}return s.type===a.RJ.Lava?(B=e.session.colors.scheme.element[a.RJ.Lava])[s.variantIndex]:s.type===a.RJ.Sandium?(B=e.session.colors.scheme.element[a.RJ.Sandium])[s.variantIndex]:s.type===a.RJ.Gloom?e.session.colors.scheme.element[a.RJ.Gloom][0]:s.type===a.RJ.Basalt?(B=e.session.colors.scheme.element[a.RJ.Basalt])[s.variantIndex]:[255,0,0,255]},c=[.9,.7,.65,.45,.4,.32,.2,.05]},1823:(e,t,r)=>{r.d(t,{J:()=>d});var n=r(6921),a=r(3734),o=r(9025),i=r(1872),l=r(3103),s=l.Ls.length,d=function(e,t,r,d,u){return void 0===u&&(u=!1),t===a.vZ.Empty?a.b1.None:(0,i.Bp)(t)?function(e,t){var r=t.type,n=t.variantIndex;if(t.type===a.RJ.Particle&&(r=t.element.type,n=t.element.variantIndex),t.type===a.RJ.Fire){var o=t.duration.max-t.duration.left;n=Math.floor(o/t.duration.max*4)}return e.session.colors.colorIdByElementType[r][n]||e.session.colors.colorIdByElementType[r][0]}(e,t):(0,i.ez)(t)?function(e,t,r,d,u){var c;if(Number.isInteger(t))return function(e,t,r,o,d){if(n.b6.includes(t))return a.b1.Darkness;var u=e.session.colors.colorIdByGroundCellType[t];if(void 0===u)return a.b1.Misc;for(var c=!1,v=r-5;v<r+5;v++)for(var h=o-5;h<o+5;h++)if(!(d||v<0||h<0||v>=e.store.world.matrix.length||h>=e.store.world.matrix[0].length)){var p=v-r,f=h-o,y=Math.sqrt(p*p+f*f);if(!(y>=5)){var g=e.shared.mapData,m=v+h*g.width,S=g.data[m],x=e.session.colors.colorByColorId[S];(!(0,i.eH)(S)||x&&(0,l.in)(e,x[0],x[1],x[2]))&&(!1===c||c>y)&&(c=y)}}return!1===c?a.b1.Darkness:u[0===c?0:Math.round((c-1)/5*(s+3))]}(e,t,r,d,u);var v=t.cellType,h=e.session.colors.colorIdByGroundCellType[v];if(void 0===h)return a.b1.Misc;var p=(null===(c=o.l2[t.cellType])||void 0===c?void 0:c.hp)||4,f=t.hp/p*200;return h[(0,l.Y8)(r,d)>f?s+1:s+2]}(e,t,r,d,u):(console.log("This should never happen!"),a.b1.Misc)}},2370:(e,t,r)=>{r.d(t,{X:()=>s});var n=r(7028),a=r(3734),o=r(1872),i=r(3103),l=function(e,t){return n.A.useMultithreading&&e.environment.context===a.bF.Worker?(0,o.ez)(t)?e.shared.obstacleImageData:e.shared.imageData:(0,o.ez)(t)?e.session.rendering.obstacleImageData:e.session.rendering.imageData},s=function(e,t,r,n,o){var s=(0,i.pp)(e,t,r,n);if(!s)return console.log("No rgba for cell"),void d(l(e,n),t,r,0,105,108,255);if(o){var u=n===a.vZ.Empty?l(e,o):l(e,n);if(d(u,t,r,s[0],s[1],s[2],s[3]),n!==a.vZ.Empty){var c=l(e,o);c!==u&&d(c,t,r,0,0,0,0)}}else d(l(e,n),t,r,s[0],s[1],s[2],s[3])},d=function(e,t,r,n,a,o,i){var l=4*(t+r*e.width);e.data[l+0]=n,e.data[l+1]=a,e.data[l+2]=o,e.data[l+3]=i}},4249:(e,t,r)=>{r.d(t,{Ak:()=>o});var n={vaporize:1},a={},o=function(e,t,r){if(void 0===r&&(r={}),n[t]){var o=Date.now();if(o-(a[t]||0)<n[t])return;a[t]=o}!function(e,t,r){var n,a,o,i,l,s,d,u,c,v,h;void 0===r&&(r={}),r.restart&&t.source&&(t.source.stop(),t.source=null),t.opts.loop?(t.source&&(t.source.stop(),t.source=null),t.source=e.audioContext.createBufferSource(),v=t.source,t.gainNode?t.gainNode.gain.cancelScheduledValues(e.audioContext.currentTime):t.gainNode=e.audioContext.createGain(),h=t.gainNode):(v=e.audioContext.createBufferSource(),t.source=v,h=e.audioContext.createGain()),v.buffer=t.buffer,v.loop=!!t.opts.loop;var p=null!==(a=null!==(n=r.playbackRate)&&void 0!==n?n:t.opts.playbackRate)&&void 0!==a&&a;p&&(v.playbackRate.value=p),t.filter=e.audioContext.createBiquadFilter();var f=r.filters?r.filters[0]:t.opts.filters[0];t.filter.type=f.type,t.filter.frequency.value=null!==(o=f.frequency)&&void 0!==o?o:2e3*Math.random()+100,v.connect(t.filter);var y=null!==(l=null!==(i=r.pan)&&void 0!==i?i:t.opts.pan)&&void 0!==l&&l;t.gainNode=h,!1!==y?(t.panner=e.audioContext.createStereoPanner(),t.panner.pan.value=y,t.filter.connect(t.panner),t.panner.connect(t.gainNode)):t.filter.connect(t.gainNode),t.gainNode.connect(e.audioContext.destination),h.gain.setValueAtTime((null!==(d=null!==(s=r.volume)&&void 0!==s?s:t.opts.volume)&&void 0!==d?d:1)*(r.ignoreGlobalVolume?1:e.globalVolume),e.audioContext.currentTime);var g=null!==(c=null!==(u=r.fadeOut)&&void 0!==u?u:t.opts.fadeOut)&&void 0!==c&&c;g&&h.gain.linearRampToValueAtTime(0,e.audioContext.currentTime+g),t.opts.offset?v.start(0,t.opts.offset):v.start(0),t.start=Date.now()}(e,e.sfx[t],r)}},9750:(e,t,r)=>{r.d(t,{A0:()=>o}),r(7028);var n=r(3734),a=(r(4249),r(6185)),o=(r(5502),n.ev.ConveyorLeft,n.ev.ConveyorRight,n.ev.LauncherLeft,n.ev.LauncherRight,n.ev.LauncherUp,n.ev.ShakerLeft,n.ev.ShakerRight,function(e,t){var r=Math.min(600,Math.max(e.x-t.x,-600))/1e3,n=a.A.getDistance({x:e.x,y:e.y},{x:t.x,y:t.y});return{pan:r,volMod:Math.pow(200/Math.max(200,n),2)}})},4693:(e,t,r)=>{r.d(t,{NH:()=>u,ib:()=>s,uQ:()=>d,xR:()=>l});var n=r(7514),a=r(7028),o=r(3734),i={1:[o.s0.NoJetpack,o.s0.NoGrab,o.s0.NoBuild,o.s0.NoFlamethrower],2:[o.s0.NoBuild,o.s0.NoGrab,o.s0.NoFlamethrower],3:[o.s0.NoBuild]},l=function(e,t,r,n,a,o){return void 0===o&&(o={}),d(e,t,r,n,a,o).authorized},s=function(e,t){var r=n.A.get(e.session,"structures",Math.floor(t.x/a.A.snapGridCellSize)*a.A.snapGridCellSize,Math.floor(t.y/a.A.snapGridCellSize)*a.A.snapGridCellSize);return!!r&&(r.filter||r.queued)},d=function(e,t,r,i,l,s){void 0===s&&(s={});var d=n.A.get(e.session,"structures",Math.floor(r/a.A.snapGridCellSize)*a.A.snapGridCellSize,Math.floor(i/a.A.snapGridCellSize)*a.A.snapGridCellSize);if(!d)return{authorized:!0};if(d.type===o.ev.Collector&&t.type!==o.RJ.Gold)return{authorized:!1,isFilter:!1};var u=!1;if(d.filter){if(u=!0,s.isDiagonalCheck)return{authorized:!1,isFilter:u};var c="allow"===d.filter.mode,v=!0;return d.filter.density&&t.density<d.filter.density&&(v=!1),d.filter.elementType&&((Array.isArray(d.filter.elementType)?d.filter.elementType:[d.filter.elementType]).includes(t.type)||(v=!1)),{authorized:c?v:!v,isFilter:u}}return l?{authorized:!0,isFilter:u}:d.queued?{authorized:!1,isFilter:u}:{authorized:!0,isFilter:u}},u=function(e,t,r){var n=e.shared.authorization.data[t+r*e.shared.authorization.width];return!(i[n]||[]).includes(o.s0.NoGrab)}},8498:(e,t,r)=>{r.d(t,{f:()=>l,x:()=>o});var n=r(6622),a=r(9241),o=function(e,t,r){var n=(0,a.TR)(e,t,r);if(n&&n.queued){var o=e.store.postProcessing.buildCheck.locations;i(o,t,r)||(o[r]||(o[r]=[]),o[r][t]=!0,e.store.postProcessing.buildCheck.cellPositionsToTry.push({x:t,y:r}))}},i=function(e,t,r){return!!e[r]&&e[r][t]},l=function(e){0!==e.store.postProcessing.buildCheck.cellPositionsToTry.length&&(e.store.postProcessing.buildCheck.cellPositionsToTry.forEach((function(t){var r=(0,a.TR)(e,t.x,t.y);r&&r.queued&&(0,n.zh)(e,r)})),e.store.postProcessing.buildCheck.cellPositionsToTry=[],e.store.postProcessing.buildCheck.locations=[])}},6622:(e,t,r)=>{var n;r.d(t,{Ic:()=>x,x7:()=>A,zh:()=>y});for(var a,o=r(7028),i=r(1656),l=r(3734),s=(r(6185),r(1872)),d=(r(9241),r(9529),r(5468),r(4249),r(9750),r(4693),r(7509),r(3844),r(7733),r(9379),r(2539),function(){return d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},d.apply(this,arguments)}),u={},c=0,v=Object.entries(n||(n=r.t(i,2)));c<v.length;c++){var h=v[c],p=h[0],f=h[1];f.map&&(u[p]=f.map((function(e){return e.map((function(e){return{0:l.vZ.Empty,3:l.vZ.Block,4:l.vZ.ConveyorLeft,5:l.vZ.ConveyorRight,6:l.vZ.ShakerLeft,7:l.vZ.ShakerRight,8:l.vZ.SlidingBlock,9:l.vZ.SlidingBlockLeft,10:l.vZ.SlidingBlockRight,11:l.vZ.VelocitySoaker,12:l.vZ.Grower}[e]}))})))}var y=function(e,t){if(!m(e,t.x,t.y)){var r=x(t.type);delete t.queued,g(e,{x:t.x,y:t.y},r),e.environment.postMessage([l.dD.UpdateStructure,t])}},g=function(e,t,r){for(var n,a=r.shape,o=0;o<a.length;o++)for(var i=0;i<a[o].length;i++){var l=a[o][i];if(0!==l){var d=null!==(n=r.offset)&&void 0!==n?n:{x:0,y:0},u=i+t.x+d.x,c=o+t.y+d.y;(0,s.Jx)(e,u,c,l)}}},m=function(e,t,r){for(var n=0;n<o.A.cellSize;n++)for(var a=0;a<o.A.cellSize;a++){if(!o.A.useMultithreading)throw new Error("Not implemented");var i=e.shared.imageData,l=4*(t+n+(r+a)*i.width);if(0!==i.data[l+3])return!0;if(0!==e.shared.obstacleImageData.data[l+3])return!0}return!1},S=((a={})[l.ev.ConveyorRight]={shape:u["conveyor-belt-right"],variants:[{id:l.ev.ConveyorLeft,angles:[-180,180]},{id:l.ev.ConveyorRight,angles:[0]}],name:"Conveyor Belt",description:"Transports sand and other solid elements. Hold Shift to reverse direction when building."},a[l.ev.ConveyorLeft]={shape:u["conveyor-belt-left"]},a[l.ev.ShakerRight]={variants:[{id:l.ev.ShakerLeft,angles:[-45,135]},{id:l.ev.ShakerRight,angles:[45,-135]}],name:"Shaker",description:"Place Wet Sand on the shaker to refine it automatically to Gold (↓) and Slag. Should be built diagonally to allow natural throughput."},a[l.ev.ShakerLeft]={},a[l.ev.LauncherUp]={shape:u["launcher-up"],variants:[{id:l.ev.LauncherLeft,angles:[-135]},{id:l.ev.LauncherUp,angles:[-90,90]},{id:l.ev.LauncherRight,angles:[-45]}],name:"Launcher",description:"Will launch elements upward (straight or to the sides). You can build a column of launchers to create a vertical conveyor lift."},a[l.ev.LauncherLeft]={shape:u["launcher-left"]},a[l.ev.LauncherRight]={shape:u["launcher-right"]},a[l.ev.SplitterLeft]={shape:u["splitter-left"],variants:[{id:l.ev.SplitterLeft,angles:[180]},{id:l.ev.SplitterRight,angles:[0]}]},a[l.ev.SplitterRight]={shape:u["splitter-right"]},a[l.ev.Dropper]={shape:u.dropper,variants:[{id:l.ev.Dropper,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[l.ev.Foundation]={shape:u.foundation,variants:[{id:l.ev.FoundationAngledLeft,angles:[135]},{id:l.ev.FoundationTriangleRightDel,angles:[-45]},{id:l.ev.FoundationAngledRight,angles:[45]},{id:l.ev.FoundationTriangleLeftDel,angles:[-135]},{id:l.ev.Foundation,angles:[-180,-90,0,90,180]}],name:"Block",description:"A basic block foundation. Hold Shift to reverse the direction of angled blocks."},a[l.ev.FoundationAngledLeft]={shape:u["foundation-triangle-left"]},a[l.ev.FoundationAngledRight]={shape:u["foundation-triangle-right"]},a[l.ev.Collector]={variants:[{id:l.ev.Collector,angles:[-180,-90,0,90,180,-135,-45,45,135]}],name:"Collector",description:"A collector tile that you can put gold in, giving you credits ($). Gold needs to stay inside the collector for it to be available (i.e. it needs to have a solid foundation below it). When used it will be removed automatically."},a[l.ev.FoundationTriangleRightDel]={shape:u["foundation-triangle-right-del"],variants:[{id:l.ev.FoundationTriangleRightDel,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[l.ev.FoundationTriangleLeftDel]={shape:u["foundation-triangle-left-del"]},a[l.ev.FilterRight]={variants:[{id:l.ev.FilterLeft,angles:[-180,180]},{id:l.ev.FilterRight,angles:[0]}],name:"Filter",description:"Filters out element based on the filter settings. The filtered element goes through while the rest will get transported as usual."},a[l.ev.FilterLeft]={},a[l.ev.SlidingFoundation]={shape:u["sliding-foundation"],variants:[{id:l.ev.SlidingFoundation,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[l.ev.VelocitySoaker]={shape:u["velocity-soaker"],variants:[{id:l.ev.VelocitySoaker,angles:[-180,0,180]}],name:"Kinetic Slag Press",description:"Drop Burnt Slag on a soaker from a great height to refine it into Gold and Spores."},a[l.ev.Grower]={variants:[{id:l.ev.Grower,angles:[-180,0,180]}],name:"Planter Box",description:"Drop Wet Spores on a planter box to start growing flowers that you can destroy to get Gold and Petals."},a[l.ev.SoundBox]={variants:[{id:l.ev.SoundBox,angles:[-180,0,180]}]},a[l.ev.Pipe]={variants:[{id:l.ev.Pipe,angles:[-180,-90,0,90,180]}],name:"Pipe",description:"Pipes are used to transport liquids."},a[l.ev.Pump]={variants:[{id:l.ev.Pump,angles:[0]}],singleBuild:!0,name:"Pump",description:"Draws in liquid and runs it through the connected pipes."},a[l.ev.LiquidVent]={variants:[{id:l.ev.LiquidVent,angles:[0]}],singleBuild:!0,name:"Liquid Vent",description:"Releases liquids from the connected pipe."},a[l.ev.Light]={variants:[{id:l.ev.Light,angles:[0]}],singleBuild:!0,name:"Light",description:"A light that illuminates the area."},a[l.ev.GloomEmitter]={variants:[{id:l.ev.GloomEmitter,angles:[0]}],singleBuild:!0,name:"Flux Emanator",description:"Converts Voidbloom into Fluxite."},a),x=function(e,t){var r=S[e];if(void 0===t)return d(d({structureType:e},void 0!==r.shape?{shape:r.shape}:{}),void 0!==r.singleBuild?{singleBuild:r.singleBuild}:{});for(var n=0,a=r.variants;n<a.length;n++){var o=a[n];if(o.angles.includes(t))return x(o.id)}return console.error("Invalid angle ".concat(t," for structure type ").concat(e)),d({structureType:e},{})},A=function(e,t,r,n,a){var i=n.x+o.A.snapGridCellSize,l=n.y+o.A.snapGridCellSize;return n.x<=r.x&&i>t.x&&n.y<=r.y&&l>t.y&&(a&&a(e,n),!0)}},1505:(e,t,r)=>{r.d(t,{I:()=>n});var n=function(e){e.shouldUpdate=e.shouldUpdateNextFrame,e.shouldUpdateNextFrame=!1}},9241:(e,t,r)=>{r.d(t,{QD:()=>v,TR:()=>h,Tn:()=>u,V6:()=>c});var n=r(7028),a=r(7514),o=(r(1985),r(8288)),i=r(3734),l=(r(8792),r(5468),r(6921)),s=(r(7815),r(1872)),d=r(6744),u=function(e,t){e.store.structures.push(t),a.A.set(e.session,"structures",t.x,t.y,t),n.A.useMultithreading&&e.environment.context===i.bF.Worker&&(l.CC.includes(t.type)&&o.A.set(e,"conveyorBeltsGroupedByX",{structure:t}),t.type===i.ev.Collector&&((0,s.jB)(e,t.x)||t.type===i.ev.Collector&&(0,d.fO)(e,t)))},c=function(e,t){var r=e.store.structures.findIndex((function(e){return e.x===t.x&&e.y===t.y}));-1===r&&console.error("No structure",t),e.store.structures[r]=t,a.A.set(e.session,"structures",t.x,t.y,t),e.environment.context===i.bF.Worker&&[i.ev.ConveyorLeft,i.ev.ConveyorRight].includes(t.type)&&(o.A.remove(e,"conveyorBeltsGroupedByX",{structure:t}),o.A.set(e,"conveyorBeltsGroupedByX",{structure:t}))},v=function(e,t){a.A.delete(e.session,"structures",t.x,t.y),n.A.useMultithreading&&e.environment.context===i.bF.Worker&&l.CC.includes(t.type)&&o.A.remove(e,"conveyorBeltsGroupedByX",{structure:t})},h=function(e,t,r){var a=Math.floor(t/n.A.cellSize)*n.A.cellSize,o=Math.floor(r/n.A.cellSize)*n.A.cellSize;return e.session.cache.structures[o]&&e.session.cache.structures[o][a]||null}},5676:(e,t,r)=>{r.d(t,{Fy:()=>b,KZ:()=>k,MZ:()=>R,cJ:()=>x,m5:()=>T,n:()=>S,qL:()=>M,r8:()=>C});var n,a,o=r(7028),i=r(3734),l=r(5194),s=r(9909),d=r(3639),u=r(6185),c=r(9280),v=r(1872),h=r(7514),p=r(5462),f=r(2127),y=r(5161),g=r(5053),m=function(){return m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},m.apply(this,arguments)},S=function(e,t,r,n){var a,l,s=T[e],d=w[s.matterType],c=function(e,t){switch(e){case i.RJ.Flame:case i.RJ.Fire:return u.A.getRandomFloatBetween(t.duration-.25,t.duration+1.25);default:return t.duration}}(e,s),v={type:e,cellType:i.vZ.Element,x:t,y:r,velocity:{x:Math.random()>=.5?1:-1,y:o.A.gravity/60},minVelocity:{x:0,y:o.A.gravity/60},threshold:{x:0,y:0},hasBeenUpdated:!1,isFreeFalling:!0,density:s.density,variantIndex:u.A.getRandomIntBetween(0,3),duration:c?{max:c,left:c}:{max:-1}};return m(m(m({},v),null===(a=s.getExtraProps)||void 0===a?void 0:a.call(s)),null===(l=d.getExtraProps)||void 0===l?void 0:l.call(d,n,v))},x=function(e,t,r){var n=w[T[t.type].matterType];A(e,t,r,n)||n.update&&!t.skipPhysics&&n.update(e,t,r)},A=function(e,t,r,n){return!(-1===t.duration.max||(t.duration.left-=r,t.duration.left>0?((0,v.Y$)(e,t.x,t.y),1):!(0,p.sB)(e,t)&&(t.type===i.RJ.Seed?((0,f.u)(e,t)||(t.duration.left=t.duration.max,(0,v.Y$)(e,t.x,t.y)),0):((0,v.Nz)(e,t),0))))},b=function(e,t){t.hasBeenUpdated=!0,e.world.updatedCellPositions.push({x:t.x,y:t.y})},M=function(e,t){return e.type==t},C=function(e,t){return T[e].matterType==t},R=function(e,t){return t.includes(T[e.type].matterType)},k=function(e,t,r){if(t.type===r.type)return!1;var n=h.A.get(e.session,"structures",Math.floor(t.x/o.A.snapGridCellSize)*o.A.snapGridCellSize,Math.floor(t.y/o.A.snapGridCellSize)*o.A.snapGridCellSize+o.A.snapGridCellSize);if(n&&n.filter&&n.filter.elementType){if("allow"===n.filter.mode&&n.filter.elementType===t.type)return!0;if("block"===n.filter.mode&&n.filter.elementType!==t.type)return!0}return t.density>r.density},T=((n={})[i.RJ.Sand]={name:"Sand",interactions:["💧"],density:150,matterType:i.es.Solid},n[i.RJ.WetSand]={name:"Wet Sand",interactions:["↔️"],density:150,matterType:i.es.Slushy},n[i.RJ.Slag]={name:"Slag",interactions:["🔥"],density:50,matterType:i.es.Slushy},n[i.RJ.Gold]={name:"Gold",interactions:["💰"],density:300,matterType:i.es.Solid},n[i.RJ.Water]={name:"Water",interactions:["🔥","❄️"],density:100,matterType:i.es.Liquid},n[i.RJ.Particle]={matterType:i.es.Particle},n[i.RJ.Steam]={name:"Steam",density:25,matterType:i.es.Gas},n[i.RJ.Spore]={name:"Spore",interactions:["💧"],density:150,matterType:i.es.Solid},n[i.RJ.Petalium]={name:"Amethelis",interactions:["🌄 (Redsand)"],density:40,matterType:i.es.Wisp},n[i.RJ.WetSpore]={name:"Wet Spore",interactions:["🪴"],density:100,matterType:i.es.Slushy},n[i.RJ.Seed]={name:"Seed",density:100,matterType:i.es.Static,getExtraProps:function(){var e=u.A.getRandomFloatBetween(.1,.5);return{data:{seedlings:1,grows:u.A.getRandomIntBetween(5,20),runway:20},duration:{max:e,left:e}}}},n[i.RJ.BurntSlag]={name:"Burnt Slag",interactions:["⬇️"],density:50,matterType:i.es.Solid},n[i.RJ.Fire]={name:"Fire",density:25,matterType:i.es.Gas,duration:1.28},n[i.RJ.FreezingIce]={name:"Snow",interactions:["🔥"],density:150,matterType:i.es.Solid},n[i.RJ.Flame]={name:"Flame",density:50,matterType:i.es.Solid,duration:.28},n[i.RJ.Lava]={name:"Lava",interactions:["❄️"],density:75,matterType:i.es.Liquid,duration:.28},n[i.RJ.Sandium]={name:"Redsand",interactions:["🌸 (Amethelis)"],density:160,matterType:i.es.Solid},n[i.RJ.Gloom]={name:"Voidbloom",interactions:["🔮 (Flux Emanator)"],density:30,matterType:i.es.Slushy},n[i.RJ.Basalt]={name:"Cinder",density:50,matterType:i.es.Solid},n),w=((a={})[i.es.Solid]={update:l.h},a[i.es.Liquid]={update:s.A,getExtraProps:function(e){return{movesOnSameYAxis:{y:0,count:0},lastSideCheckedPosition:null}}},a[i.es.Particle]={update:d.s,getExtraProps:function(e){return{element:e.element,velocity:e.velocity,density:e.element.density}}},a[i.es.Gas]={update:c.R,getExtraProps:function(e,t){return{movesOnSameYAxis:{y:0,count:0},lastSideCheckedPosition:null,velocity:{x:Math.random()>=.5?1:-1,y:o.A.upflow/60},minVelocity:{x:0,y:o.A.upflow/60}}}},a[i.es.Static]={update:!1},a[i.es.Slushy]={update:y.w},a[i.es.Wisp]={update:g.z},a)},6208:(e,t,r)=>{r.d(t,{Al:()=>f,Mv:()=>h,zT:()=>y});var n=r(6185),a=r(3734),o=r(5676),i=r(3812),l=r(9025),s=r(1872),d=r(7028),u=r(2370),c=r(2380),v=r(1823),h=(r(3844),r(4249),r(2587),r(446),function(e,t,r,n,o,i){void 0===i&&(i={fromRocketExplosion:!1});var d=(0,s.tT)(e.store,t,r);if((0,s.Br)(d)){if(Number.isInteger(d)){if(d===a.vZ.Crackstone&&!i.fromRocketExplosion)return;var u=d,c=l.l2[u],v=c.hp-o;if(v<=0)return void p(e,c,u,t,r,n);var h={cellType:u,hp:v};return void(0,s.Jx)(e,t,r,h)}var f=d.hp-o;f>0?(d.hp=f,(0,s.Jx)(e,t,r,d)):p(e,l.l2[d.cellType],d.cellType,t,r,n)}}),p=function(e,t,r,l,d,u){if(t.fog)(0,c.a)(e,l,d);else if(r===a.vZ.Fluxite)e.environment.postMessage([a.dD.IncrementFluxite,l,d]),e.environment.postMessage([a.dD.SpawnFluxiteParticles,l,d]),(0,s.Jx)(e,l,d,a.vZ.Empty);else if(t.output&&Math.random()<t.output.chance){var v=(0,o.n)(t.output.elementType,l,d);(0,i.J)(e,v,{x:n.A.getRandomFloatBetween(.5*-u.x,-u.x),y:-Math.abs(u.y)*n.A.getRandomFloatBetween(1,1.3)})}else(0,s.Jx)(e,l,d,a.vZ.Empty)},f=function(e,t,r,a,o,i){for(var l=0;l<a.length;l++)for(var s=0;s<a[l].length;s++)if(0!==a[l][s]){var u=Math.floor(a.length/2),c=t+s-u,v=r+l-u;if(!(v<5)){if(d.A.useMultithreading){var p=e.environment;if(n.A.getThreadIndexFromCellX(c,p.threadMeta.threadCount)!==p.threadMeta.startingIndex)continue}h(e,c,v,o,i)}}y(e,t,r,a.length)},y=function(e,t,r,a){for(var o=-a;o<=a;o+=1)for(var i=-a;i<=a;i+=1){if(d.A.useMultithreading){var l=e.environment;if(n.A.getThreadIndexFromCellX(t+i,l.threadMeta.threadCount)!==l.threadMeta.startingIndex)continue}var c=t+i,h=r+o,p=(0,s.tT)(e.store,c,h);(0,u.X)(e,c,h,p);var f=c+h*e.shared.mapData.width;e.shared.mapData.data[f]=(0,v.J)(e,p,c,h)}}},5462:(e,t,r)=>{r.d(t,{LD:()=>x,Mo:()=>m,n4:()=>y,sB:()=>g});var n,a,o=r(7028),i=r(3734),l=r(6185),s=r(5676),d=r(6208),u=r(9692),c=r(1872),v=r(5502),h=r(2380),p=((n={})[i.RJ.Slag]=function(){return{output:{elementType:i.RJ.BurntSlag,chance:.25}}},n),f=!1,y=function(e,t,r,n){if(!(t<0||r<0||t>=e.store.world.size.width||r>=e.store.world.size.height)){var a=(0,c.tT)(e.store,t,r);if((0,c.Ol)(a))return(d=(0,s.n)(i.RJ.Fire,t,r)).duration.left=d.duration.max=d.duration.left*Math.max(.25,1-n/.64),void(0,c.Jx)(e,t,r,d);if((0,c.W)(a,i.vZ.Ice))(0,u.jE)(e,t,r);else{if((0,c.af)(a,i.RJ.Water)){var d=(0,s.n)(i.RJ.Steam,t,r);return(0,c.Jx)(e,t,r,d),f||(e.environment.postMessage([i.dD.ForceCompleteObjective,"vaporize_water"]),f=!0),void e.environment.postMessage([i.dD.PlaySound,[{id:"vaporize",opts:{volume:.1,fadeOut:l.A.getRandomFloatBetween(.1,.5),playbackRate:l.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:d.x*o.A.cellSize,y:d.y*o.A.cellSize}}]])}if((0,c.af)(a,i.RJ.Slag))return(d=(0,s.n)(i.RJ.Flame,t,r)).data=p[i.RJ.Slag](),d.duration.left=d.duration.max=d.duration.left-n,void(0,c.Jx)(e,t,r,d);x(e,t,r,a)||((0,c.af)(a,i.RJ.FreezingIce)?(0,c.Jx)(e,t,r,i.vZ.Empty):(0,c.af)(a,i.RJ.Basalt)&&(0,c.Jx)(e,t,r,(0,s.n)(i.RJ.Lava,t,r)))}}},g=function(e,t){var r;if(![i.RJ.Flame,i.RJ.Lava].includes(t.type))return!1;if(t.type===i.RJ.Flame&&((0,v.$T)(e,t.x*o.A.cellSize,t.y*o.A.cellSize,v.c6.Fire),e.environment.postMessage([i.dD.AddLight,t.x*o.A.cellSize,t.y*o.A.cellSize,{brightness:1,duration:100,useLightZones:!0}])),[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}].forEach((function(r){var n=r.x,a=r.y,o={cX:t.x+n,cY:t.y+a},s=o.cX,d=o.cY,u=e.environment,c=l.A.getThreadIndexFromCellX(s,u.threadMeta.threadCount);c===u.threadMeta.startingIndex?m(e,s,d,t):e.environment.threadMeta.ports[c].postMessage([i.dD.Burn,s,d])})),t.type===i.RJ.Lava)return t.duration.left=t.duration.max*l.A.getRandomFloatBetween(.5,1.5),t.variantIndex=l.A.getRandomIntBetween(0,3),(0,c.Jx)(e,t.x,t.y,t),!0;var n=null===(r=t.data)||void 0===r?void 0:r.output;return n?!1===n.elementType||n.chance&&Math.random()>=n.chance?((0,c.Jx)(e,t.x,t.y,(0,s.n)(i.RJ.Fire,t.x,t.y)),!0):((0,c.Jx)(e,t.x,t.y,(0,s.n)(n.elementType,t.x,t.y)),!0):((0,c.Jx)(e,t.x,t.y,(0,s.n)(i.RJ.Fire,t.x,t.y)),!0)},m=function(e,t,r,n){var a=(0,c.tT)(e.store,t,r);if((0,c.Ol)(a)){var l=(null==n?void 0:n.type)===i.RJ.Lava?.01:.25;if(Math.random()<l)return(null==n?void 0:n.type)===i.RJ.Lava&&e.environment.postMessage([i.dD.AddLight,n.x*o.A.cellSize,n.y*o.A.cellSize,{brightness:1,size:r*o.A.cellSize<e.store.world.horizon[Math.floor(t)]*o.A.cellSize+10*o.A.cellSize?100:1e3,duration:5e3,useLightZones:!0}]),void(0,c.Jx)(e,t,r,(0,s.n)(i.RJ.Fire,t,r))}if((0,c.af)(a,i.RJ.Slag)){var d=(0,s.n)(i.RJ.Flame,t,r);return d.data=p[i.RJ.Slag](),void(0,c.Jx)(e,t,r,d)}(0,h.x)(e,a,t,r),x(e,t,r,a)},S=((a={})[i.vZ.Moss]=!1,a[i.vZ.Divider]=!1,a[i.vZ.GoldSoil]=i.RJ.Gold,a[i.vZ.Petal]=i.RJ.Petalium,a),x=function(e,t,r,n){if(n=null!=n?n:(0,c.tT)(e.store,t,r),(0,c.ez)(n)){if((0,c.kw)(n,[i.vZ.Moss,i.vZ.Divider,i.vZ.GoldSoil,i.vZ.Petal])){var a=(0,s.n)(i.RJ.Flame,t,r);return a.skipPhysics=!0,a.data={output:{elementType:S[n]}},(0,c.Jx)(e,t,r,a),!0}(0,d.zT)(e,t,r,4)}return!1}},3957:(e,t,r)=>{r.d(t,{E:()=>d,h:()=>s});var n=r(7028),a=r(3734),o=r(6185),i=r(6208),l=r(1872),s=function(e,t,r){return s=void 0,d=void 0,c=function(){var s,d,u,c,v,h,p,f,y,g,m;return function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(S){switch(S.label){case 0:s=[[t,r]],d=new Set,S.label=1;case 1:return s.length>0?s.length>20?[2]:(u=Math.random())<.01?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:S.sent(),S.label=3;case 3:return u<.2&&s.sort((function(){return Math.random()-.5})),c=s.shift(),v=c[0],h=c[1],n.A.useMultithreading&&(p=e.environment,(f=o.A.getThreadIndexFromCellX(v,p.threadMeta.threadCount))!==p.threadMeta.startingIndex)?(e.environment.threadMeta.ports[f].postMessage([a.dD.StartWaterFreeze,v,h]),[3,1]):d.has("".concat(v,",").concat(h))?[3,1]:(d.add("".concat(v,",").concat(h)),y=(0,l.tT)(e.store,v,h),(0,l.af)(y,a.RJ.Water)?(g={x:v*n.A.cellSize,y:h*n.A.cellSize,width:n.A.cellSize,height:n.A.cellSize},m={x:e.shared.playerPos[0],y:e.shared.playerPos[1],width:n.A.playerSize.width,height:n.A.playerSize.height},o.A.doRectanglesOverlap(g,m)||((0,l.Jx)(e,v,h,a.vZ.Ice),(0,i.zT)(e,v,h,4)),s.push([v+1,h]),s.push([v-1,h]),s.push([v,h+1]),s.push([v,h-1]),[3,1]):[3,1]);case 4:return[2]}}))},new((u=void 0)||(u=Promise))((function(e,t){function r(e){try{a(c.next(e))}catch(e){t(e)}}function n(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof u?a:new u((function(e){e(a)}))).then(r,n)}a((c=c.apply(s,d||[])).next())}));var s,d,u,c},d=function(e,t,r){if(t.type!==a.RJ.FreezingIce)return!1;if(r.type!==a.RJ.Water)return!1;(0,l.Jx)(e,t.x,t.y,a.vZ.Empty);var i=r.x,d=r.y,u=function(t,r){var n=(0,l.QC)(e,t,r),o=(0,l.BQ)(e,t,r);return n===a.RJ.Water||o===a.vZ.Ice},c=u(i-1,d),v=u(i+1,d),h=u(i,d-1),p=u(i,d+1);return!(!c&&!v||!h&&!p||(s(e,r.x,r.y),e.environment.postMessage([a.dD.PlaySound,[{id:"freeze",opts:{volume:.2,fadeOut:o.A.getRandomFloatBetween(.1,2),playbackRate:o.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:r.x*n.A.cellSize,y:r.y*n.A.cellSize}}]]),0))}},5468:(e,t,r)=>{r.d(t,{tS:()=>n}),r(7028),r(7815),r(4249),r(6185),r(9241);var n=function(e,t,r,n,a,o){void 0===o&&(o={}),e.session.effects.push({x:t,y:r,time:e.store.meta.time,sprite:n,duration:a,opts:o})}},3452:(e,t,r)=>{r.d(t,{N:()=>d,Q:()=>s});var n=r(7028),a=r(3734),o=r(6185),i=r(6208),l=r(1872),s=function(e,t,r){return s=void 0,d=void 0,c=function(){var s,d,u,c,v,h,p,f,y,g,m;return function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(S){switch(S.label){case 0:s=[[t,r]],d=new Set,S.label=1;case 1:return s.length>0?s.length>20?[2]:(u=Math.random())<.01?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:S.sent(),S.label=3;case 3:return u<.2&&s.sort((function(){return Math.random()-.5})),c=s.shift(),v=c[0],h=c[1],n.A.useMultithreading&&(p=e.environment,(f=o.A.getThreadIndexFromCellX(v,p.threadMeta.threadCount))!==p.threadMeta.startingIndex)?(e.environment.threadMeta.ports[f].postMessage([a.dD.StartLavaFreeze,v,h]),[3,1]):d.has("".concat(v,",").concat(h))?[3,1]:(d.add("".concat(v,",").concat(h)),y=(0,l.tT)(e.store,v,h),(0,l.af)(y,a.RJ.Lava)?(g={x:v*n.A.cellSize,y:h*n.A.cellSize,width:n.A.cellSize,height:n.A.cellSize},m={x:e.shared.playerPos[0],y:e.shared.playerPos[1],width:n.A.playerSize.width,height:n.A.playerSize.height},o.A.doRectanglesOverlap(g,m)||((0,l.Jx)(e,v,h,a.vZ.Obsidian),(0,i.zT)(e,v,h,4)),s.push([v+1,h]),s.push([v-1,h]),s.push([v,h+1]),s.push([v,h-1]),[3,1]):[3,1]);case 4:return[2]}}))},new((u=void 0)||(u=Promise))((function(e,t){function r(e){try{a(c.next(e))}catch(e){t(e)}}function n(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof u?a:new u((function(e){e(a)}))).then(r,n)}a((c=c.apply(s,d||[])).next())}));var s,d,u,c},d=function(e,t,r){if(t.type!==a.RJ.FreezingIce)return!1;if(r.type!==a.RJ.Lava)return!1;(0,l.Jx)(e,t.x,t.y,a.vZ.Empty);var i=r.x,d=r.y,u=function(t,r){var n=(0,l.QC)(e,t,r),o=(0,l.BQ)(e,t,r);return n===a.RJ.Lava||o===a.vZ.Obsidian},c=u(i-1,d),v=u(i+1,d),h=u(i,d-1),p=u(i,d+1);return!(!c&&!v||!h&&!p||(s(e,r.x,r.y),e.environment.postMessage([a.dD.PlaySound,[{id:"freeze",opts:{volume:.2,fadeOut:o.A.getRandomFloatBetween(.1,2),playbackRate:o.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:r.x*n.A.cellSize,y:r.y*n.A.cellSize}}]]),0))}},9379:(e,t,r)=>{r.d(t,{iP:()=>a});var n=r(7028),a=function(e,t){var r,a,i=(r=t.x,a=t.y,{x:r*n.A.cellSize+n.A.cellSize*n.A.snapGridCellSize/2,y:a*n.A.cellSize+n.A.cellSize*n.A.snapGridCellSize/2});o(e,i.x,i.y)},o=function(e,t,r){e.store.world.lights=e.store.world.lights.filter((function(e){return e.x!==t||e.y!==r}))}},9692:(e,t,r)=>{r.d(t,{P$:()=>c,jE:()=>h,kH:()=>v});var n=r(7028),a=r(3734),o=r(6185),i=r(5676),l=r(6208),s=r(2380),d=r(1872),u=!1,c=function(e,t,r,c){return v=void 0,h=void 0,f=function(){var v,h,p,f,y,g,m,S,x,A;return function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(b){switch(b.label){case 0:v=[[t,r]],h=new Set,p=c===a.vZ.Ice?40:10,b.label=1;case 1:return v.length>0?v.length>p?[2]:(f=Math.random())<.99?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:b.sent(),b.label=3;case 3:return f<.2&&v.sort((function(){return Math.random()-.5})),y=v.shift(),g=y[0],m=y[1],n.A.useMultithreading&&(S=e.environment,(x=o.A.getThreadIndexFromCellX(g,S.threadMeta.threadCount))!==S.threadMeta.startingIndex)?(e.environment.threadMeta.ports[x].postMessage([a.dD.StartMelt,g,m,c]),[3,1]):h.has("".concat(g,",").concat(m))?[3,1]:(h.add("".concat(g,",").concat(m)),A=(0,d.tT)(e.store,g,m),(0,d.W)(A,a.vZ.Ice)||A===a.vZ.FreezingIceSoil?(A===a.vZ.FreezingIceSoil?(0,l.Mv)(e,g,m,{x:0,y:0},3):((0,d.Jx)(e,g,m,(0,i.n)(a.RJ.Water,g,m)),u||(e.environment.postMessage([a.dD.ForceCompleteObjective,"melt_ice"]),u=!0)),(0,l.zT)(e,g,m,4),v.push([g+1,m]),v.push([g-1,m]),v.push([g,m+1]),v.push([g,m-1]),[3,1]):((0,s.x)(e,A,g,m),[3,1]));case 4:return[2]}}))},new((p=void 0)||(p=Promise))((function(e,t){function r(e){try{a(f.next(e))}catch(e){t(e)}}function n(e){try{a(f.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof p?a:new p((function(e){e(a)}))).then(r,n)}a((f=f.apply(v,h||[])).next())}));var v,h,p,f},v=function(e,t,r){(Math.random()>=.99||[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}].every((function(n){return(0,d.lV)(e,t+n.x,r+n.y)||(0,d.QC)(e,t+n.x,r+n.y)===a.RJ.Fire})))&&h(e,t,r)},h=function(e,t,r){var n=(0,d.tT)(e.store,t,r);((0,d.W)(n,a.vZ.Ice)||n===a.vZ.FreezingIceSoil)&&c(e,t,r,n)}},3812:(e,t,r)=>{r.d(t,{J:()=>i});var n=r(3734),a=r(1872),o=r(5676),i=function(e,t,r){var i=(0,o.n)(n.RJ.Particle,t.x,t.y,{element:t,velocity:r});return(0,a.Jx)(e,t.x,t.y,i),i}},7733:(e,t,r)=>{r.d(t,{w6:()=>l});var n=r(7514),a=r(3734),o=r(7028),i=(r(5676),r(1872),r(3174),r(6185),function(e,t,r){var o=n.A.get(e.session,"pipes",t,r);return void 0!==o&&o.type===a.ev.Pipe}),l=function(e,t){if([a.ev.Pipe,a.ev.Pump,a.ev.LiquidVent].includes(t.type))if(![a.ev.Pump,a.ev.LiquidVent].includes(t.type)||i(e,t.x,t.y)){var r=new Set,l=[],s=[],d=function(t,u){var c="".concat(t,",").concat(u);if(!r.has(c)){r.add(c);var v=n.A.get(e.session,"structures",t,u);(null==v?void 0:v.type)===a.ev.Pump?l.push(v):(null==v?void 0:v.type)===a.ev.LiquidVent&&s.push(v);for(var h=0,p=[{x:t,y:u-o.A.snapGridCellSize},{x:t+o.A.snapGridCellSize,y:u},{x:t,y:u+o.A.snapGridCellSize},{x:t-o.A.snapGridCellSize,y:u}];h<p.length;h++){var f=p[h];i(e,f.x,f.y)&&d(f.x,f.y)}}};d(t.x,t.y);for(var u=0,c=l;u<c.length;u++){var v=c[u];v.data=v.data||{},v.data.connectedVents=s.map((function(e){return{x:e.x,y:e.y}}))}}else t.type===a.ev.Pump&&(t.data=t.data||{},t.data.connectedVents=[])}},1985:(e,t,r)=>{r.d(t,{vr:()=>i}),r(7028),r(3734),r(1872),r(9241);var n=r(6185),a=(r(5468),r(5051),r(6208)),o=[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,0,0,0,0]],i=function(e,t,r,i){var l=n.A.getVelocityFromAngle(t.initialAngle);l.x*=60,l.y*=60,(0,a.Al)(e,r,i,o,l,1)}},6744:(e,t,r)=>{r.d(t,{N4:()=>g,fO:()=>h,gY:()=>p,oM:()=>v,yQ:()=>u});var n=r(7028),a=r(3734),o=(r(3844),r(6185)),i=r(9241),l=r(1872),s=function(e){return null!==e&&e.type===a.ev.Collector},d=function(e,t){return!!(0,l.af)(t,a.RJ.Gold)||!(!(0,l.af)(t,a.RJ.Particle)||t.element.type!==a.RJ.Gold)},u=function(e,t,r,n){if(d(0,t)){var a=(0,i.TR)(e,r.x,r.y),o=(0,i.TR)(e,n.x,n.y),l=s(a),u=s(o);l&&c(e,a,1),u&&c(e,o,-1),l&&!u?f(e,r):!l&&u&&y(e,r)}},c=function(e,t,r,n){void 0===n&&(n=!1),t.data||(t.data={gold:0}),n?t.data.gold=r:t.data.gold+=r;var o=t.data.gold>0;t.data.hasGold!==o&&(t.data.hasGold=o,e.environment.context===a.bF.Main?e.environment.multithreading.simulation.postAll(e,[a.dD.UpdateStructure,t]):e.environment.postMessage([a.dD.UpdateStructure,t]))},v=function(e,t,r,o,l){if(d(0,t)){var s=(0,i.TR)(e,r,o);s&&s.type===a.ev.Collector&&("add"===l?(c(e,s,1),f(e,{x:s.x*n.A.cellSize,y:s.y*n.A.cellSize})):(c(e,s,-1),y(e,{x:s.x*n.A.cellSize,y:s.y*n.A.cellSize})))}},h=function(e,t){for(var r=t.x;r<t.x+n.A.snapGridCellSize;r++)for(var a=t.y;a<t.y+n.A.snapGridCellSize;a++){var o=(0,l.tT)(e.store,r,a);d(0,o)&&(c(e,t,1),f(e,{x:t.x*n.A.cellSize,y:t.y*n.A.cellSize}))}},p=function(e,t){for(var r=t.x;r<t.x+n.A.snapGridCellSize;r++)for(var a=t.y;a<t.y+n.A.snapGridCellSize;a++){var o=(0,l.tT)(e.store,r,a);d(0,o)&&y(e,{x:t.x*n.A.cellSize,y:t.y*n.A.cellSize})}},f=function(e,t){e.environment.postMessage([a.dD.Collector,1,t])},y=function(e,t){e.environment.postMessage([a.dD.Collector,-1,t])},g=function(e){if(n.A.useMultithreading){var t=e.store.structures.filter((function(t){var r=e.environment;return o.A.getThreadIndexFromCellX(t.x,r.threadMeta.threadCount)===r.threadMeta.startingIndex})).reduce((function(t,r){if(r.type!==a.ev.Collector)return t;for(var o=n.A.startingResources,i=r.y;i<r.y+n.A.snapGridCellSize;i++)for(var s=r.x;s<r.x+n.A.snapGridCellSize;s++){var d=(0,l.tT)(e.store,s,i);(0,l.af)(d,a.RJ.Gold)&&o++}return c(e,r,o,!0),t+o}),0);0!==t&&e.environment.postMessage([a.dD.Collector,t])}}},1558:(e,t,r)=>{r.d(t,{c:()=>c,n:()=>v});var n=r(7028),a=r(3734),o=r(1872),i=r(5676),l=r(4571),s=r(6185),d=r(6921),u=r(4693),c=function(e,t,r,v,y){void 0===y&&(y=1);var g=f(v);if(g||(g=p(r)),n.A.useMultithreading,g){var m=Math.sign(g.x),S=Math.sign(g.y),x=Math.ceil(Math.abs(g.x))*m,A=Math.ceil(Math.abs(g.y))*S;if(1===y&&[a.ev.ShakerLeft,a.ev.ShakerRight].includes(v)&&t.type===a.RJ.WetSand)(0,l.h)(e,t);else{var b={x:t.x+x,y:t.y+A},M=s.A.iterateToAndGetLastPosFulfillingCondition(t,b,(function(r,a){if(!(0,u.xR)(e,t,r,a,(0,u.ib)(e,t)))return!1;if(n.A.useMultithreading){var i=e.shared.imageData,l=4*(r+a*i.width);if(0!==e.shared.obstacleImageData.data[l+3])return!1;if(0===i.data[l+3])return!0;var s=e.session.colors.elementByColor[i.data[l]][i.data[l+1]][i.data[l+2]];return d.ji.includes(s)}var c=(0,o.tT)(e.store,r,a);return(0,o.sT)(c,d.ji)}));if(M.x!==t.x||M.y!==t.y){var C=(0,o.tT)(e.store,t.x,t.y-1);if((0,o.Bp)(C)&&(0,i.MZ)(C,[a.es.Solid,a.es.Slushy,a.es.Wisp])&&(y>100?console.log("more than 100 distanceToConveyor",t.x,t.y):c(e,C,r,v,y+1)),h(e,t,y,M)&&(t.isFreeFalling=!0),n.A.useMultithreading){var R=e.shared.imageData,k=4*(M.x+M.y*R.width),T=0!==R.data[k+3]?e.session.colors.elementByColor[R.data[k]][R.data[k+1]][R.data[k+2]]:null;null!==T&&d.ji.includes(T)?(0,o.Hs)(e,t,M.x,M.y,{eager:T}):(0,o.L3)(e,t,M.x,M.y)}else{var w=(0,o.tT)(e.store,M.x,M.y);(0,o.af)(w,d.ji)?(0,o.Hc)(e,t,w):(0,o.L3)(e,t,M.x,M.y)}}else(0,o.Y$)(e,t.x,t.y)}}else console.log("No beltVelocity",v,r)},v=function(e,t,r,n){var a=e.store,l=(0,o.tT)(a,t,r);if((0,o.Bp)(l)&&!(0,o.af)(l,d.ji)){var s=(0,o.tT)(a,t,r+1);l.isFreeFalling=!1,c(e,l,s,n),l.velocity.y=l.minVelocity.y,l.velocity.x=0,(0,i.Fy)(a,l),(0,o.Y$)(e,l.x,l.y,{defer:!0})}},h=function(e,t,r,a){if(1!==r)return!1;if(n.A.useMultithreading){var i=e.environment;if(!s.A.isCellXInThread(a.x,i.threadMeta.startingIndex,i.threadMeta.threadCount)){var l=e.shared.imageData,d=4*(a.x+(a.y+1)*l.width);if(l.data[d+3]>0)return!1;if(e.shared.obstacleImageData.data[d+3]>0)return!1}}var u=(0,o.tT)(e.store,a.x,a.y+1);return!!(0,o.Ol)(u)},p=function(e){var t=n.A.conveyorDefaultSpeed;switch(e){case a.vZ.ConveyorLeft:return{x:-t,y:0};case a.vZ.ConveyorRight:return{x:t,y:0}}},f=function(e){switch(e){case a.ev.ShakerLeft:case a.ev.FilterLeft:return{x:-.005,y:0};case a.ev.ShakerRight:case a.ev.FilterRight:return{x:.005,y:0}}return!1}},2127:(e,t,r)=>{r.d(t,{$:()=>d,u:()=>u});var n=r(3734),a=r(6185),o=r(9241),i=r(5676),l=r(6208),s=r(1872),d=function(e,t){if(t.type!==n.RJ.WetSpore)return!1;var r=(0,o.TR)(e,t.x,t.y+1);return!(!r||r.type!==n.ev.Grower||((0,s.Jx)(e,t.x,t.y,(0,i.n)(n.RJ.Seed,t.x,t.y)),0))},u=function(e,t){var r=Math.random()>.25?[{x:0,y:-1}]:[{x:1,y:0},{x:-1,y:0}];a.A.shuffleArray(r);var d={x:t.x,y:t.y};c(e,t);var u=r.find((function(r){var a=r.x,i=r.y,l=t.x+a,u=t.y+i;if(u<5)return!1;if((0,s.lV)(e,l,u)&&!(0,o.TR)(e,l,u))return(0,s.L3)(e,t,l,u),(0,s.Jx)(e,d.x,d.y,n.vZ.Moss),!0;var c=(0,s.QC)(e,l,u);if([n.RJ.WetSpore,n.RJ.Seed].includes(c)){if(c===n.RJ.Seed){if((0,s.jB)(e,l))return!1;var v=(0,s.tT)(e.store,l,u);t.data.seedlings+=v.data.seedlings}else t.data.seedlings++;var h={x:t.x,y:t.y};return(0,s.L3)(e,t,l,u),(0,s.Jx)(e,h.x,h.y,n.vZ.Moss),!0}return!1}));if(u&&((0,l.zT)(e,d.x,d.y,4),t.data.grows--,t.data.grows<=0&&1===t.data.seedlings)){var v={x:-u.x,y:-u.y};return[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}].every((function(r){var n=r.x,a=r.y;if(n===v.x&&a===v.y)return!0;var i=t.x+n,l=t.y+a;return(0,s.lV)(e,i,l)&&!(0,o.TR)(e,i,l)}))?([{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}].forEach((function(r){var a=r.x,o=r.y,i=t.x+a,l=t.y+o;(0,s.Q1)(e,i,l,n.vZ.Petal)})),(0,s.Jx)(e,t.x,t.y,n.vZ.GoldSoil),!0):(1===t.data.seedlings&&t.data.runway--,0===t.data.runway?(0,s.Jx)(e,t.x,t.y,(0,i.n)(n.RJ.WetSpore,t.x,t.y)):t.data.grows=1,!1)}return!1},c=function(e,t){if(!(t.data.seedlings<=1)){var r=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];a.A.shuffleArray(r),r.some((function(r){var a=r.x,l=r.y,d=t.x+a,u=t.y+l;if((0,s.lV)(e,d,u)&&!(0,o.TR)(e,d,u))return(0,s.Q1)(e,d,u,(0,i.n)(n.RJ.Seed,d,u)),t.data.seedlings--,!0}))}}},6119:(e,t,r)=>{r.d(t,{t:()=>i});var n=r(7028),a=r(3734),o=r(9241),i=function(e,t,r,i){var l=(0,o.TR)(e,r.x,r.y);if(l&&l.type===a.ev.SoundBox&&!function(e,t){var r=(0,o.TR)(e,t.x,t.y);return!!r&&r.type===a.ev.SoundBox}(e,i)){var s=l.data.note.tone;e.environment.postMessage([a.dD.PlaySound,[{id:"piano_".concat(s),opts:{playbackRate:[.5,1,2][l.data.note.octave],volume:1,filters:[{type:"lowpass",frequency:2e3*Math.random()+100}]},modulateDistance:{x:l.x*n.A.cellSize,y:l.y*n.A.cellSize}}]])}}},3174:(e,t,r)=>{r.d(t,{Cj:()=>f});var n=r(7028),a=r(3734),o=r(1872),i=r(9241),l=r(6622),s=r(5468),d=r(4249),u=r(9750),c=r(6185),v=r(6744),h=r(7733),p=(r(7514),r(9379)),f=function(e,t,r,f){if(void 0===f&&(f={}),e.environment.context===a.bF.Main&&(e.environment.multithreading.simulation.postAll(e,[a.dD.RemoveStructuresBetween,t,r]),f.playSound)){var y=(0,u.A0)({x:r.x*n.A.cellSize,y:r.y*n.A.cellSize},{x:e.store.player.x,y:e.store.player.y}),g=y.pan;y.volMod,(0,d.Ak)(e.session.soundEngine,"build",{volume:.1,restart:!0,playbackRate:.5,pan:g}),(0,d.Ak)(e.session.soundEngine,"build4",{volume:.3,restart:!0,playbackRate:.5,pan:g})}var m=0;e.store.structures=e.store.structures.filter((function(d,u){return!(0,l.x7)(e,t,r,d,(function(e,t){var r;if((0,i.QD)(e,t),e.environment.context===a.bF.Main)t.type===a.ev.LiquidVent&&(0,h.w6)(e,t),t.type===a.ev.Pump&&(e.store.pumpsCache=e.store.pumpsCache.filter((function(e){return!(e.type===t.type&&e.x===t.x&&e.y===t.y)}))),t.type===a.ev.GloomEmitter&&(e.store.gloom.emitterPositions=e.store.gloom.emitterPositions.filter((function(e){return!(e.x===t.x&&e.y===t.y)}))),t.type===a.ev.Light&&(0,p.iP)(e,t),(0,s.tS)(e,t.x*n.A.cellSize-2*n.A.cellSize,t.y*n.A.cellSize-2*n.A.cellSize,"build_flash3",200,{fadeOut:!0,animationDelay:5*m}),m++;else if(c.A.isCellXInThread(t.x,e.environment.threadMeta.startingIndex,e.environment.threadMeta.threadCount)){for(var d=t.x;d<t.x+n.A.snapGridCellSize;d++){var u=(0,o.tT)(e.store,d,t.y-1);(0,o.Bp)(u)&&(u.isFreeFalling=!0)}(0,o.Y$)(e,t.x,t.y),t.type===a.ev.Collector&&(0,v.gY)(e,t)}if(f.removeCells){if(t.queued)return;var y=(0,l.Ic)(t.type),g=y.shape;if(!g)return;for(var S=0;S<g.length;S++)for(d=0;d<g[S].length;d++)if(0!==g[S][d]){var x=null!==(r=y.offset)&&void 0!==r?r:{x:0,y:0},A=t.x+d+x.x,b=t.y+S+x.y;(0,o.Jx)(e,A,b,a.vZ.Empty)}}}))}))}},2234:(e,t,r)=>{r.d(t,{rO:()=>o}),r(7028),r(3734),r(9241),r(1872),r(5676),r(6185),r(5468),r(4249);var n=r(6208),a=(r(9529),r(8135),r(2539),r(3844),r(4693),[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,0,0,0,0]]),o=function(e,t,r,o,i){(0,n.Al)(e,r,o,a,i,8)}},1872:(e,t,r)=>{r.d(t,{BQ:()=>E,Bp:()=>w,Br:()=>k,Do:()=>C,Hc:()=>A,Hs:()=>L,ID:()=>g,Jx:()=>S,L3:()=>x,MH:()=>N,NK:()=>M,Nz:()=>b,OA:()=>I,Ol:()=>J,Q1:()=>U,QC:()=>Z,W:()=>z,Y$:()=>R,af:()=>B,eH:()=>O,ez:()=>T,jB:()=>W,kw:()=>D,lV:()=>G,sT:()=>P,tT:()=>m});var n=r(7028),a=r(6185),o=r(3734),i=r(6921),l=r(1505),s=r(5676),d=r(2370),u=r(6744),c=r(9025),v=r(4832),h=r(8498),p=r(6119),f=r(1823),y=function(e,t,r){for(var o=e.store.world.chunks,i=o.length-1;i>=0;i-=1)for(var l=1===e.store.world.matrixTraverseDirection,d=l?0:o.length-1,u=l?o.length:-1,c=l?1:-1,v=d;v!==u;v+=c){if(n.A.useMultithreading){var h=e.environment;if(!a.A.isChunkIndexInThread(v,h.threadMeta.startingIndex,h.threadMeta.threadCount))continue;if(v%2==0!==t)continue}if(o[i][v].shouldUpdate)for(var p=i*n.A.chunkSize+n.A.chunkSize-1;p>=i*n.A.chunkSize;p-=1)for(var f=l?v*n.A.chunkSize:v*n.A.chunkSize+n.A.chunkSize-1,y=l?v*n.A.chunkSize+n.A.chunkSize:v*n.A.chunkSize-1,g=l?1:-1,S=f;S!==y;S+=g){var x=m(e.store,S,p);!n.A.debug.stopOnDebugCellUpdate||0===e.shared.debug.cellPos[0]&&0===e.shared.debug.cellPos[1]||S===e.shared.debug.cellPos[0]&&e.shared.debug.cellPos[1],w(x)&&(0,s.cJ)(e,x,r)}}},g=function(e,t,r){var i=e.store,s=i.world.chunks;if(t===o.yT.Even||t===o.yT.Both)for(var d=s.length-1;d>=0;d-=1)for(var u=s.length-1;u>=0;u-=1){if(n.A.useMultithreading){var c=e.environment;if(!a.A.isChunkIndexInThread(u,c.threadMeta.startingIndex,c.threadMeta.threadCount))continue}if((0,l.I)(s[d][u]),n.A.useMultithreading&&n.A.debug.drawChunks){var v=u+d*(e.store.world.size.width/n.A.chunkSize);if(s[d][u].shouldUpdate)e.shared.activeChunks[v]=n.A.debug.drawChunkFade;else{var h=e.shared.activeChunks[v]-1;h<0&&(h=0),e.shared.activeChunks[v]=h}}}if(t===o.yT.Both){var p=1===i.world.matrixTraverseDirection;y(e,p,r),y(e,!p,r)}else y(e,t===o.yT.Even,r);t!==o.yT.Even&&(i.world.matrixTraverseDirection=-i.world.matrixTraverseDirection,i.world.updatedCellPositions.forEach((function(e){var t=m(i,e.x,e.y);w(t)&&(t.hasBeenUpdated=!1)})),i.world.updatedCellPositions=[],i.world.deferredChunkReports.forEach((function(t){return R(e,t.x,t.y)})),i.world.deferredChunkReports=[])},m=(o.vZ.SandSoil,o.vZ.SandSoil,o.vZ.Grass,o.vZ.SandSoil,o.vZ.Moss,o.vZ.Bedrock,o.vZ.Divider,o.vZ.SporeSoil,o.vZ.FreezingIceSoil,o.vZ.SandSoil,o.vZ.FreezingIceSoil,o.vZ.Fog,o.vZ.FogJetpackBlock,o.vZ.FogJetpackBlock,o.vZ.FogWater,o.vZ.Bedrock,o.vZ.Fog,o.vZ.SandSoil,o.vZ.FogWater,o.vZ.SandSoil,o.vZ.FogLava,o.vZ.Fluxite,o.vZ.SandiumSoil,o.vZ.Crackstone,c.$4[2],c.$4[2],o.vZ.Fog,o.vZ.SandSoil,function(e,t,r){return e.world.matrix[r][t]}),S=function(e,t,r,i){if(n.A.useMultithreading&&e.environment.context===o.bF.Main){var l=e.environment;l.multithreading.simulation.post(e,a.A.getThreadIndexFromCellX(t,l.multithreading.simulation.threads.length),[o.dD.SetCell,[t,r,i]])}else{var s=e.environment,u=a.A.getThreadIndexFromCellX(t,s.threadMeta.threadCount);if(u===s.threadMeta.startingIndex){var c=t+r*e.shared.mapData.width;e.shared.mapData.data[c]=(0,f.J)(e,i,t,r),(0,d.X)(e,t,r,i,m(e.store,t,r)),e.store.world.matrix[r][t]=i,R(e,t,r),i===o.vZ.Empty&&(0,h.x)(e,t,r)}else s.threadMeta.ports[u].postMessage([o.dD.SetCell,[t,r,i]])}},x=function(e,t,r,i){if((0,p.t)(e,t,{x:r,y:i},{x:t.x,y:t.y}),(0,u.yQ)(e,t,{x:r,y:i},{x:t.x,y:t.y}),S(e,t.x,t.y,o.vZ.Empty),n.A.useMultithreading&&(0,v.D)(e,t.x,t.y),t.x=r,t.y=i,n.A.useMultithreading){var l=e.environment,d=a.A.getThreadIndexFromCellX(r,l.threadMeta.threadCount);if(d!==l.threadMeta.startingIndex)return void e.environment.threadMeta.ports[d].postMessage([o.dD.SetCell,[r,i,t]])}S(e,r,i,t),(0,s.Fy)(e.store,t)},A=function(e,t,r){var n=t.x,a=t.y;t.x=r.x,t.y=r.y,r.x=n,r.y=a,S(e,t.x,t.y,t),S(e,r.x,r.y,r),(0,s.Fy)(e.store,t),(0,s.Fy)(e.store,r)},b=function(e,t){S(e,t.x,t.y,o.vZ.Empty)},M=function(e,t,r){var a=Math.floor(r/n.A.chunkSize),o=Math.floor(t/n.A.chunkSize);return e.world.chunks[a][o]},C=function(e,t,r){return M(e,t,r).shouldUpdate},R=function(e,t,r,i){if(void 0===i&&(i={}),i.defer)e.store.world.deferredChunkReports.push({x:t,y:r});else{var l=e.store.world.chunks.length-1,s=e.store.world.chunks[0].length-1,d=Math.floor(r/n.A.chunkSize),u=Math.floor(t/n.A.chunkSize);if(!(u<0||u>s||d<0||d>l)){if(t%n.A.chunkSize==0&&u>0)if(n.A.useMultithreading&&a.A.isCellXAtThreadSeam(t)){var c=e.environment,v=a.A.getThreadIndexFromCellX(t-1,c.threadMeta.threadCount);e.environment.threadMeta.ports[v].postMessage([o.dD.SetChunkActive,[t-1,r]])}else M(e.store,t-1,r).shouldUpdateNextFrame=!0;t%n.A.chunkSize==n.A.chunkSize-1&&u<s&&(n.A.useMultithreading&&a.A.isCellXAtThreadSeam(t)?(c=e.environment,v=a.A.getThreadIndexFromCellX(t+1,c.threadMeta.threadCount),e.environment.threadMeta.ports[v].postMessage([o.dD.SetChunkActive,[t+1,r]])):M(e.store,t+1,r).shouldUpdateNextFrame=!0),r%n.A.chunkSize==0&&d>0&&(M(e.store,t,r-1).shouldUpdateNextFrame=!0),r%n.A.chunkSize==n.A.chunkSize-1&&d<l&&(M(e.store,t,r+1).shouldUpdateNextFrame=!0),M(e.store,t,r).shouldUpdateNextFrame=!0}}},k=function(e){return Number.isInteger(e)?i.gB.includes(e):i.gB.includes(e.cellType)},T=function(e){return Number.isInteger(e)?!i.iE.includes(e):!i.iE.includes(e.cellType)},w=function(e){return!Number.isInteger(e)&&e.cellType===o.vZ.Element},F=function(e,t){return Array.isArray(t)?t.includes(e.type):e.type===t},B=function(e,t){return w(e)&&F(e,t)},z=function(e,t){return Number.isInteger(e)?e===t:e.cellType===t},D=function(e,t){return Number.isInteger(e)?t.includes(e):t.includes(e.cellType)},J=function(e){return Number.isInteger(e)&&e===o.vZ.Empty},P=function(e,t){return Number.isInteger(e)?e===o.vZ.Empty:e.cellType===o.vZ.Element&&F(e,t)},I=function(e){return D(e,i.TF)},G=function(e,t,r){if(n.A.useMultithreading){var a=e.shared.obstacleImageData,o=4*(t+r*a.width),i=a.data[o+3],l=e.shared.imageData.data[o+3];return 0===i&&0===l}var s=m(e.store,t,r);return J(s)},L=function(e,t,r,i,l){var d;if(void 0===l&&(l={eager:!1}),(0,u.yQ)(e,t,{x:r,y:i},{x:t.x,y:t.y}),t.velocity.y=Math.min(t.velocity.y,60),n.A.useMultithreading){var c=e.environment,v=a.A.getThreadIndexFromCellX(r,c.threadMeta.threadCount);if(v!==c.threadMeta.startingIndex){if(l.eager){var h={x:t.x,y:t.y};x(e,t,r,i),S(e,h.x,h.y,(0,s.n)(l.eager,h.x,h.y))}else e.environment.threadMeta.ports[v].postMessage([o.dD.SwapElement,[r,i,t]]);return}}var p=null!==(d=l.elementToSwapWith)&&void 0!==d?d:m(e.store,r,i);A(e,t,p)},Z=function(e,t,r){if(n.A.useMultithreading){var a=e.shared.imageData,o=4*(t+r*a.width),i=a.data[o],l=a.data[o+1],s=a.data[o+2];return 0===a.data[o+3]?null:e.session.colors.elementByColor[i][l][s]}var d=m(e.store,t,r);return J(d)?null:d.type},E=function(e,t,r){var a=t+r*e.shared.mapData.width,i=e.shared.mapData.data[a];return 0===i||i===o.b1.Darkness||i===o.b1.Misc||i<n.A.obstacleBreakpoint?null:e.session.colors.cellTypeOrElementTypeByColorId[i]},O=function(e){return e>=n.A.obstacleBreakpoint},U=function(e,t,r,n){var i=e.environment,l=a.A.getThreadIndexFromCellX(t,i.threadMeta.threadCount);l===i.threadMeta.startingIndex?S(e,t,r,n):e.environment.threadMeta.ports[l].postMessage([o.dD.SetCell,[t,r,n]])},W=function(e,t){var r=e.environment;return a.A.getThreadIndexFromCellX(t,r.threadMeta.threadCount)!==r.threadMeta.startingIndex},N=function(e,t,r,n,a){var o=m(e.store,t,r),i=J(o);a&&(i=B(o,a)),i?S(e,t,r,n):e.store.workarounds.queueSetCell.push({x:t,y:r,val:n,requireElementType:a})}},4832:(e,t,r)=>{r.d(t,{C:()=>o,D:()=>i});var n=r(3734),a=(r(5676),r(1872)),o=function(e,t,r,o){if(o===n.vZ.Empty)return!1;var i=(0,a.tT)(e.store,t,r);return!(0,a.Ol)(i)&&o.type!==n.RJ.Particle&&!![n.RJ.Water,n.RJ.Steam].includes(o.type)&&((0,a.MH)(e,t,r,o),!0)},i=function(e,t,r){}},1924:(e,t,r)=>{var n=r(7514),a=r(7028),o=r(6185),i=r(3734),l=r(2370),s=r(9241),d=r(1985),u=r(1872),c=r(5676),v=r(9529),h=r(6921),p=r(4693),f=r(6744),y=r(3844),g=function(e,t){e.session.ui.tooltip.activeTick=e.store.meta.tick,e.session.ui.tooltip.data=t,(0,y.Aq)(e,i.JU.Tooltip)},m=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},S=25,x=Math.sqrt(S),A=Array.from({length:x},(function(){return Array.from({length:x},(function(){return 1}))})),b=Math.floor(A.length/2),M=function(e,t){0===(a.A.useMultithreading?e.shared.grabber[1]:t.amount)&&(a.A.useMultithreading?e.shared.grabber[0]=0:t.targetElementType=0)},C=r(1558),R=r(8288),k=r(2234),T=r(3812),w=[[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,0]],F=function(e,t,r,n){for(var l=0;l<w.length;l++)for(var s=0;s<w[l].length;s++)if(0!==w[l][s]){var d=Math.floor(w.length/2),v=r.x+s-d,h=r.y+l-d;if(a.A.useMultithreading){var p=e.environment;if(o.A.getThreadIndexFromCellX(v,p.threadMeta.threadCount)!==p.threadMeta.startingIndex)continue}var f=(0,u.tT)(e.store,v,h);(0,u.Bp)(f)&&((0,c.qL)(f,i.RJ.Particle)||(0,c.qL)(f,i.RJ.Water)||(f.hasBeenUpdated=!1,(0,T.J)(e,f,n)))}},B=r(2380),z=r(9692),D=r(3957),J=r(3174),P=r(4832),I=r(8498),G=r(5462),L=r(6208),Z=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},E=function(e,t,r,n){var a=n?27:17,o=a+4,l={};(0,L.Mv)(e,t,r,{x:0,y:0},100,{fromRocketExplosion:!0});for(var s=-a;s<=a;s++)for(var d=-a;d<=a;d++){var u=Math.sqrt(d*d+s*s);if(u>=a-2&&u<=a+1)for(var c=O(e,{x:t,y:r},{x:t+d,y:r+s},!0,o,n),v=0,h=Object.entries(c);v<h.length;v++){var p=h[v],f=p[0],y=p[1];l[f]||(l[f]=[]),l[f]=Z(Z([],l[f],!0),y,!0)}}for(var g=0,m=Object.entries(l);g<m.length;g++){var S=m[g];f=S[0],y=S[1],e.environment.threadMeta.ports[f].postMessage([i.dD.TriggerShockwaves,y])}(0,L.zT)(e,t,r,o)},O=function(e,t,r,n,a,l,s){var d=l?.8:.2,v=l?.95:.99,h={};return U(e,null!=s?s:t,r,(function(e,r,a){var s=o.A.getDistance(t,{x:r,y:a}),h=(0,u.tT)(e.store,r,a);if(s<10&&(0,L.Mv)(e,r,a,{x:0,y:0},100,{fromRocketExplosion:!0}),s>15&&Math.random()>=d&&(n=!1),n){var p=n?100:1;if(Number.isInteger(h)&&(0,L.Mv)(e,r,a,{x:0,y:0},p,{fromRocketExplosion:!0}),(0,u.Ol)(h)&&(Math.random()>=v||l&&s>=16&&s<=17)){var f=(0,c.n)(i.RJ.Flame,r,a);if(l){f.duration.left+=o.A.getRandomFloatBetween(-.5,.5);var y={x:r-t.x,y:a-t.y},g=Math.sqrt(y.x*y.x+y.y*y.y),m={x:y.x/g,y:y.y/g},S={x:m.x*o.A.getRandomFloatBetween(50,120),y:m.y*o.A.getRandomFloatBetween(50,120)},x=(0,c.n)(i.RJ.Particle,r,a,{element:f,velocity:S});(0,u.Jx)(e,r,a,x)}else(0,u.Jx)(e,r,a,f)}}}),(function(i,s,d,c){var v=o.A.getThreadIndexFromCellX(i,e.environment.threadMeta.threadCount);if(v!==e.environment.threadMeta.startingIndex)return h[v]||(h[v]=[]),h[v].push({start:t,current:{x:d,y:c},end:r,spawnFire:n,radiusWithPadding:a,napalm:l}),!1;var p=(0,u.tT)(e.store,i,s);return(0,u.Ol)(p)||(0,u.Br)(p)||(0,u.Bp)(p)})),h},U=function(e,t,r,n,a){for(var o,i=t.x,l=t.y,s=i-r.x,d=l-r.y,u=Math.abs(s)>Math.abs(d),c=s<0?1:-1,v=d<0?1:-1,h=Math.max(Math.abs(s),Math.abs(d)),p=Math.min(Math.abs(s),Math.abs(d)),f=0==p||0==h?0:p/h,y=t.x,g=t.y,m=1;m<=h;m++){o=Math.round(m*f);var S=void 0,x=void 0;u?(x=m,S=o):(S=m,x=o);var A=l+S*v,b=i+x*c;if(!a(b,A,y,g))return;n(e,b,A),y=b,g=A}},W=r(3452);const N=function(){function e(){this.cache={}}return e.prototype.set=function(e,t,r){this.cache[e]||(this.cache[e]={}),this.cache[e][t]=r},e.prototype.get=function(e,t){var r;return null===(r=this.cache[e])||void 0===r?void 0:r[t]},e.prototype.has=function(e,t){var r;return void 0!==(null===(r=this.cache[e])||void 0===r?void 0:r[t])},e}();var q,X=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};self.onmessage=function(e){switch(e.data[0]){case i.dD.Init:(q={environment:{context:i.bF.Worker,postMessage:self.postMessage.bind(self),threadMeta:e.data[4],otherWorkers:new Array(e.data[4].threadCount).fill(!1)},store:e.data[1],session:e.data[2],shared:{obstacleImageData:{data:new Uint8ClampedArray(e.data[3].obstacleImageData.sab),width:e.data[3].obstacleImageData.width,height:e.data[3].obstacleImageData.height},imageData:{data:new Uint8ClampedArray(e.data[3].imageData.sab),width:e.data[3].imageData.width,height:e.data[3].imageData.height},mapData:{data:new Uint8Array(e.data[3].mapData.sab),width:e.data[3].mapData.width,height:e.data[3].mapData.height},wallData:{data:new Uint8Array(e.data[3].wallData.sab),width:e.data[3].wallData.width,height:e.data[3].wallData.height},authorization:{data:new Uint8Array(e.data[3].authorization.sab),width:e.data[3].authorization.width,height:e.data[3].authorization.height},mouse:{worldPosition:new Uint16Array(e.data[3].mouseWorldPosSab)},actionState:new Uint8Array(e.data[3].actionStateSab),grabber:new Uint8Array(e.data[3].grabberSab),debug:{cellPos:new Uint16Array(e.data[3].debugCellPosSab)},reservoir:new Uint16Array(e.data[3].reservoirSab),naturalAmbience:new Float32Array(e.data[3].naturalAmbienceSab),playerPos:new Float32Array(e.data[3].playerPosSab),conveyorBeltsAnimationIndex:new Uint8Array(e.data[3].conveyorBeltsAnimationIndexSab)}}).session.mainSensorCache=new N,q.store.world.sensors.forEach((function(e){q.session.mainSensorCache.set(e.x,e.y,e.type)})),a.A.debug.drawChunks&&(q.shared.activeChunks=new Uint8Array(e.data[3].activeChunksSab)),q.environment.threadMeta.ports.forEach((function(e){return e.onmessage=function(e){return self.onmessage(e)}})),q.environment.threadMeta.managerPort.onmessage=function(e){return self.onmessage(e)},n.A.init(q.store,q.session),a.A.useMultithreading&&R.A.init(q);for(var t=0;t<2;t++)for(var r=0;r<q.store.world.matrix.length;r++)for(var y=0;y<q.store.world.matrix[r].length;y++){var x=q.store.world.matrix[r][y];o.A.isCellXInThread(y,q.environment.threadMeta.startingIndex,q.environment.threadMeta.threadCount)&&(0,l.X)(q,y,r,x)}q.environment.postMessage([i.dD.InitFinished]);break;case i.dD.RunUpdate:var T=e.data[2],w=e.data[3];T===i.yT.Even&&(q.store.meta.tick=e.data[4],q.store.machineryEngine.runLaunchers=e.data[5],function(e){var t=e.store;e.store.machineryEngine.runLaunchers&&t.structures.filter((function(e){return[i.ev.LauncherUp,i.ev.LauncherLeft,i.ev.LauncherRight].includes(e.type)})).forEach((function(t){if(a.A.useMultithreading){var r=e.environment;if(!o.A.isCellXInThread(t.x,r.threadMeta.startingIndex,r.threadMeta.threadCount))return}t.lastLaunch=Date.now(),t.x<=0||t.y<=0||t.x>=e.store.world.size.width-1||t.y>=e.store.world.size.height-1||(0,u.Y$)(e,t.x,t.y)}))}(q)),(0,u.ID)(q,T,w),(0,I.f)(q),function(e){if(0!==e.store.workarounds.queueSetCell.length){for(var t=[],r=0,n=e.store.workarounds.queueSetCell;r<n.length;r++){var a=n[r],o=a.x,i=a.y,l=a.val,s=a.requireElementType,d=(0,u.tT)(e.store,o,i),c=(0,u.Ol)(d);s&&(c=(0,u.af)(d,s)),c?(0,u.Jx)(e,o,i,l):t.push(a)}e.store.workarounds.queueSetCell=t}}(q),q.environment.threadMeta.managerPort.postMessage([i.dD.UpdateFinished,q.store.meta.tick,e.data[1]]);break;case i.dD.SetCell:var Z=e.data[1];if(!(Q=e.data[1][3])&&(0,P.C)(q,Z[0],Z[1],Z[2]))break;u.Jx.apply(void 0,X([q],Z,!1)),Z[2].hasBeenUpdated&&(0,c.Fy)(q.store,Z[2]);break;case i.dD.Blast:Z=e.data[1],d.vr.apply(void 0,X([q],Z,!1));break;case i.dD.Dig:Z=e.data[1],k.rO.apply(void 0,X([q],Z,!1));break;case i.dD.Vacuum:Z=e.data[1],F.apply(void 0,X([q],Z,!1));break;case i.dD.FireProjectileHit:Z=e.data[1],z.jE.apply(void 0,X([q],Z,!1)),(0,G.LD)(q,Z[0],Z[1]);break;case i.dD.AddStructure:(0,s.Tn)(q,e.data[1]);break;case i.dD.UpdateStructure:(0,s.V6)(q,e.data[1]);break;case i.dD.RemoveStructuresBetween:var U=e.data[1],H=e.data[2];(0,J.Cj)(q,U,H);break;case i.dD.HandleGrabber:!function(e,t,r){void 0===r&&(r={});var n=e.session;if(e.environment.context===i.bF.Main){if(0===e.shared.grabber[1]&&!n.action.state[i.qy.Active]){if(!Object.values(n.windows).some((function(e){return e.open}))){var l=n.input.mouse.cellPosition.x,d=n.input.mouse.cellPosition.y;if(l>=0&&l<e.store.world.size.width&&d>=0&&d<e.store.world.size.height){var y=(0,u.QC)(e,l,d);if(y)return void g(e,{type:"grabber",elementType:y});var x=(0,u.BQ)(e,l,d);if(x)return void g(e,{type:"grabber",groundCellType:x});var C=(0,s.TR)(e,l,d);if(C&&(C.type===i.ev.FilterLeft||C.type===i.ev.FilterRight))return void g(e,{type:"grabber",structure:C})}}return}for(var R=A.length-1;R>=0;R-=1)for(var k=A[R].length-1;k>=0;k-=1){var T=n.input.mouse.cellPosition.x+k-b,w=n.input.mouse.cellPosition.y+R-b;if(!(0,p.NH)(e,T,w))return}return(0,v.O)(e,i.vJ.PickUpSand,{tool:t}),void e.environment.multithreading.simulation.postAll(e,[i.dD.HandleGrabber,n.input.mouse.cellPosition.x,n.input.mouse.cellPosition.y,n.action.state,n.input.mouse.shaken])}var F=r.mouseShaken,B=e.store,z=r.cellPosition?r.cellPosition.x:n.input.mouse.cellPosition.x,D=r.cellPosition?r.cellPosition.y:n.input.mouse.cellPosition.y;if(F&&e.store.tutorial.active&&e.store.tutorial.currentStep<i.vJ.RefineGoldWithShaker)!function(e,t,r,n){var l=a.A.useMultithreading?e.shared.grabber[1]:t.data[1],s=a.A.useMultithreading?e.shared.grabber[0]:t.data[0];if(s&&0!==l&&s===i.RJ.WetSand)for(var d=(a.A.useMultithreading?e.shared.grabber:t.data).slice(2),h=3,p=A.length-1;p>=0;p-=1)for(var f=A[p].length-1;f>=0;f-=1){var y=r+f-b,g=n+p-b,m=e.environment;if(o.A.getThreadIndexFromCellX(y,m.threadMeta.threadCount)===m.threadMeta.startingIndex){var x=f+p*Math.sqrt(S);if(d[x]===s){var C=(0,u.tT)(e.store,y,g);if(!(0,u.Ol)(C))return;if(3===h){var R={x:y*a.A.cellSize,y:g*a.A.cellSize};e.environment.postMessage([i.dD.PlaySound,[{id:"shake",opts:{volume:.05},modulateDistance:R},{id:"beads",opts:{volume:.15},modulateDistance:R}]])}var k=e.store.tutorial.active&&e.store.tutorial.currentStep===i.vJ.RefineWetSand?.5:.25;if(Math.random()<k?a.A.useMultithreading?(e.store.tutorial.active&&e.environment.postMessage([i.dD.TutorialStep,i.vJ.RefineWetSand]),e.shared.grabber[x+2]=i.RJ.Gold):((0,v.O)(e,i.vJ.RefineWetSand),t.data[x+2]=i.RJ.Gold):(a.A.useMultithreading?(e.shared.grabber[x+2]=0,e.shared.grabber[1]-=1):(t.data[x+2]=0,t.data[1]-=1),M(e,t)),(0,u.Jx)(e,y,g,(0,c.n)(i.RJ.Slag,y,g)),0==--h)return}}}}(e,t,z,D);else{var J=r.actionState,P=e.shared.grabber[1],I=e.shared.grabber[0],G=e.shared.grabber.slice(2);if(J[i.qy.Start]&&function(e,t,r){if(a.A.useMultithreading&&0!==t){for(var n=0,o=0;o<Math.sqrt(S);o++)for(var i=0;i<Math.sqrt(S);i++)0!==r[i+o*Math.sqrt(S)]&&n++;0===n&&e.shared.grabber.fill(0)}}(e,P,G),J[i.qy.Active])for(var L=0,Z=function(e){var t=[],r=Math.floor(e/2);t.push([r,r]);for(var n=1;n<=r;n++)for(var a=-n;a<=n;a++)for(var o=-n;o<=n;o++)Math.max(Math.abs(o),Math.abs(a))===n&&t.push([r+o,r+a]);return t}(A.length);L<Z.length;L++){var E=Z[L],O=(k=E[0],R=E[1],T=z+k-b,w=D+R-b,e.environment);if(o.A.getThreadIndexFromCellX(T,O.threadMeta.threadCount)===O.threadMeta.startingIndex){var U=(0,u.tT)(B,T,w);(0,u.Bp)(U)&&!(0,u.af)(U,m(m([],h.ji,!0),[i.RJ.Particle],!1))&&0===G[W=k+R*Math.sqrt(S)]&&(I&&U.type!==I||((0,u.Jx)(e,T,w,i.vZ.Empty),(0,f.oM)(e,U,T,w,"deduct"),a.A.useMultithreading?(I||(I=U.type,e.shared.grabber[0]=U.type),e.shared.grabber[W+2]=U.type,e.shared.grabber[1]++):(I||(I=U.type,t.data[0]=U.type),t.data[W+2]=U.type,t.data[1]++)))}}else if(0!==P)for(R=A.length-1;R>=0;R-=1)for(k=A[R].length-1;k>=0;k-=1){var W,N=G[W=k+R*Math.sqrt(S)];if(0!==N&&(T=z+k-b,w=D+R-b,O=e.environment,o.A.getThreadIndexFromCellX(T,O.threadMeta.threadCount)===O.threadMeta.startingIndex&&(U=(0,u.tT)(B,T,w),(0,u.Ol)(U)))){a.A.useMultithreading?(e.shared.grabber[W+2]=0,e.shared.grabber[1]-=1):(t.data[W+2]=0,t.data[1]-=1);var q=(0,c.n)(N,T,w);(0,u.Jx)(e,T,w,q),(0,f.oM)(e,q,T,w,"add"),M(e,t)}}}}(q,null,{cellPosition:{x:e.data[1],y:e.data[2]},actionState:e.data[3],mouseShaken:e.data[4]});break;case i.dD.Save:e.data[1],q.store.meta.tick;var j=o.A.getAllChunkIndexesInThread(q,q.environment.threadMeta.startingIndex,q.environment.threadMeta.threadCount).reduce((function(e,t){if(!q.store.world.chunks[t])return console.log("no chunk when saving",t,q.environment.threadMeta.startingIndex),e;for(var r=t*a.A.chunkSize,n=r+a.A.chunkSize,o=0;o<q.store.world.matrix.length;o++){var i=q.store.world.matrix[o].slice(r,n);e.push({y:o,startX:r,columns:i})}return e}),[]);q.environment.postMessage([i.dD.Save,j]);break;case i.dD.SwapElement:Z=e.data[1];var V=o.A.getThreadIndexFromCellX(Z[2].x,q.environment.threadMeta.threadCount);if(x=(0,u.tT)(q.store,Z[0],Z[1]),(0,u.Bp)(x)){x.x=Z[2].x,x.y=Z[2].y;var Q=!0;q.environment.threadMeta.ports[V].postMessage([i.dD.SetCell,[Z[2].x,Z[2].y,x,Q]]),Z[2].x=Z[0],Z[2].y=Z[1],u.Jx.apply(void 0,X([q],Z,!1)),Z[2].hasBeenUpdated&&(0,c.Fy)(q.store,Z[2])}break;case i.dD.RunConveyorBelts:q.store;var $=e.data[2]*o.A.getThreadColumnSize(),Y=$+o.A.getThreadColumnSize();if(e.data[1]===i.ev.ConveyorLeft||e.data[1]===i.ev.ShakerLeft)for(y=$;y<Y;y+=a.A.snapGridCellSize)(e.data[1]===i.ev.ShakerLeft?q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][e.data[1]]:X(X([],q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][e.data[1]],!0),q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][i.ev.FilterLeft],!0)).forEach((function(e){if(!e.queued)for(var t=0;t<a.A.snapGridCellSize;t++)(0,C.n)(q,e.x+t,e.y-1,e.type)}));else for(y=Y-a.A.snapGridCellSize;y>=$;y-=a.A.snapGridCellSize)(e.data[1]===i.ev.ShakerRight?q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][e.data[1]]:X(X([],q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][e.data[1]],!0),q.session.lookup.conveyorBeltsGroupedByX[y/a.A.snapGridCellSize][i.ev.FilterRight],!0)).forEach((function(e){if(!e.queued)for(var t=a.A.snapGridCellSize-1;t>=0;t--)(0,C.n)(q,e.x+t,e.y-1,e.type)}));q.environment.threadMeta.managerPort.postMessage([i.dD.RunConveyorBelts,e.data[1]]);break;case i.dD.SetChunkActive:Z=e.data[1],(0,u.NK)(q.store,Z[0],Z[1]).shouldUpdateNextFrame=!0;break;case i.dD.Tally:(0,f.N4)(q);break;case i.dD.Ignite:var _=e.data[1],K=(y=_[0],r=_[1],_[2]);(0,G.n4)(q,y,r,K);break;case i.dD.StartFogReveal:(0,B.a)(q,e.data[1],e.data[2]);break;case i.dD.StartWaterFreeze:(0,D.h)(q,e.data[1],e.data[2]);break;case i.dD.StartMelt:(0,z.P$)(q,e.data[1],e.data[2],e.data[3]);break;case i.dD.SetTutorialStep:q.store.tutorial.currentStep=e.data[1],e.data[1]===i.vJ.TutorialEnd&&(q.store.tutorial.active=!1);break;case i.dD.Burn:(0,G.Mo)(q,e.data[1],e.data[2]);break;case i.dD.Explode:Z=e.data[1],E.apply(void 0,X([q],Z,!1));break;case i.dD.TriggerShockwaves:e.data[1].forEach((function(e){var t=e.start,r=e.current,n=e.end,a=e.spawnFire,o=e.radiusWithPadding,i=e.napalm;O(q,t,n,a,o,i,r)})),(0,L.zT)(q,e.data[1][0].start.x,e.data[1][0].start.y,e.data[1][0].radiusWithPadding);break;case i.dD.RedrawSurroundingCells:Z=e.data[1],(0,L.zT)(q,Z[0],Z[1],4);break;case i.dD.DebugCell:Z=e.data[1],x=(0,u.tT)(q.store,Z[0],Z[1]),console.log("debug cell",x);break;case i.dD.StartLavaFreeze:(0,W.Q)(q,e.data[1],e.data[2]);break;case i.dD.PingChunk:(0,u.Y$)(q,e.data[1],e.data[2]);break;case i.dD.QueueSetCell:Z=e.data[1],(0,u.MH)(q,Z[0],Z[1],Z[2],Z[3])}}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,loaded:!1,exports:{}};return a[e].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=a,i.x=()=>{var e=i.O(void 0,[153,515],(()=>i(1924)));return i.O(e)},e=[],i.O=(t,r,n,a)=>{if(!r){var o=1/0;for(u=0;u<e.length;u++){for(var[r,n,a]=e[u],l=!0,s=0;s<r.length;s++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](r[s])))?r.splice(s--,1):(l=!1,a<o&&(o=a));if(l){e.splice(u--,1);var d=n();void 0!==d&&(t=d)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,n,a]},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,r({}),r([]),r(r)];for(var l=2&n&&e;"object"==typeof l&&!~t.indexOf(l);l=r(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>e+".bundle.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={924:1};i.f.i=(t,r)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunksand_v1=self.webpackChunksand_v1||[],r=t.push.bind(t);t.push=t=>{var[n,a,o]=t;for(var l in a)i.o(a,l)&&(i.m[l]=a[l]);for(o&&o(i);n.length;)e[n.pop()]=1;r(t)}})(),n=i.x,i.x=()=>Promise.all([i.e(153),i.e(515)]).then(n),i.x()})();