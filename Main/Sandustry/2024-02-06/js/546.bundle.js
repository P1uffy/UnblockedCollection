(()=>{"use strict";var e,t,n,r,a={3734:(e,t,n)=>{var r,a,i,o,l,s,u,c,d,h,v,p,f,g,m,y,S,x,b,R,k,w,F,M,T,A,C,B,L,P,Z,D,I;n.d(t,{$U:()=>P,JU:()=>A,KW:()=>I,Np:()=>u,RJ:()=>a,Z5:()=>x,b1:()=>B,bF:()=>f,dD:()=>p,eX:()=>w,es:()=>h,ev:()=>v,s0:()=>L,vJ:()=>b,vZ:()=>r,xQ:()=>R,yT:()=>g}),function(e){e[e.Empty=0]="Empty",e[e.Element=1]="Element",e[e.SandSoil=2]="SandSoil",e[e.SporeSoil=3]="SporeSoil",e[e.Fog=4]="Fog",e[e.FogJetpackBlock=5]="FogJetpackBlock",e[e.FogWater=6]="FogWater",e[e.FreezingIceSoil=7]="FreezingIceSoil",e[e.Divider=8]="Divider",e[e.Grass=9]="Grass",e[e.Moss=10]="Moss",e[e.GoldSoil=11]="GoldSoil",e[e.Petal=12]="Petal",e[e.FogLava=13]="FogLava",e[e.Fluxite=14]="Fluxite",e[e.Block=15]="Block",e[e.SlidingBlock=16]="SlidingBlock",e[e.SlidingBlockLeft=17]="SlidingBlockLeft",e[e.SlidingBlockRight=18]="SlidingBlockRight",e[e.ConveyorLeft=19]="ConveyorLeft",e[e.ConveyorRight=20]="ConveyorRight",e[e.ShakerLeft=21]="ShakerLeft",e[e.ShakerRight=22]="ShakerRight",e[e.Bedrock=23]="Bedrock",e[e.VelocitySoaker=24]="VelocitySoaker",e[e.Ice=25]="Ice",e[e.Grower=26]="Grower",e[e.NascentWater=27]="NascentWater",e[e.SandiumSoil=28]="SandiumSoil",e[e.Obsidian=29]="Obsidian",e[e.Crackstone=30]="Crackstone"}(r||(r={})),function(e){e[e.Sand=1]="Sand",e[e.Particle=2]="Particle",e[e.Water=3]="Water",e[e.WetSand=4]="WetSand",e[e.Sandium=5]="Sandium",e[e.Slag=6]="Slag",e[e.Gold=7]="Gold",e[e.Gloom=8]="Gloom",e[e.Shake=9]="Shake",e[e.Steam=10]="Steam",e[e.Fire=11]="Fire",e[e.FreezingIce=12]="FreezingIce",e[e.Flame=13]="Flame",e[e.BurntSlag=14]="BurntSlag",e[e.Spore=15]="Spore",e[e.WetSpore=16]="WetSpore",e[e.Seed=17]="Seed",e[e.Petalium=18]="Petalium",e[e.Lava=19]="Lava",e[e.Basalt=20]="Basalt"}(a||(a={})),function(e){e[e.Clip=1]="Clip",e[e.Single=2]="Single",e[e.OverTime=3]="OverTime"}(i||(i={})),function(e){e[e.Bullet=1]="Bullet",e[e.Rocket=2]="Rocket",e[e.GrapplingHook=3]="GrapplingHook",e[e.Fire=4]="Fire",e[e.Bouncer=5]="Bouncer"}(o||(o={})),function(e){e[e.Weapon=1]="Weapon",e[e.Building=2]="Building",e[e.Tool=3]="Tool"}(l||(l={})),function(e){e[e.Weapon=1]="Weapon",e[e.Tool=2]="Tool",e[e.Consumable=3]="Consumable"}(s||(s={})),function(e){e[e.Shovel=1]="Shovel",e[e.Grabber=2]="Grabber",e[e.Demolisher=3]="Demolisher",e[e.GrapplingHook=4]="GrapplingHook",e[e.Vacuum=5]="Vacuum",e[e.Gun=6]="Gun",e[e.Copier=7]="Copier",e[e.RocketLauncher=8]="RocketLauncher",e[e.Bouncer=9]="Bouncer",e[e.Shotgun=10]="Shotgun",e[e.Teleporter=11]="Teleporter",e[e.Flamethrower=12]="Flamethrower",e[e.PipeRemover=13]="PipeRemover",e[e.Hauler=14]="Hauler",e[e.Cryoblaster=15]="Cryoblaster"}(u||(u={})),function(e){e[e.Start=1]="Start",e[e.Active=2]="Active",e[e.End=3]="End"}(c||(c={})),function(e){e[e.Dig=1]="Dig",e[e.Shoot=2]="Shoot",e[e.Spray=3]="Spray",e[e.Laser=4]="Laser"}(d||(d={})),function(e){e[e.Solid=1]="Solid",e[e.Liquid=2]="Liquid",e[e.Particle=3]="Particle",e[e.Gas=4]="Gas",e[e.Static=5]="Static",e[e.Slushy=6]="Slushy",e[e.Wisp=7]="Wisp"}(h||(h={})),function(e){e[e.ConveyorLeft=1]="ConveyorLeft",e[e.ConveyorRight=2]="ConveyorRight",e[e.ShakerLeft=3]="ShakerLeft",e[e.ShakerRight=4]="ShakerRight",e[e.LauncherUp=5]="LauncherUp",e[e.LauncherLeft=6]="LauncherLeft",e[e.LauncherRight=7]="LauncherRight",e[e.SplitterLeft=8]="SplitterLeft",e[e.SplitterRight=9]="SplitterRight",e[e.Dropper=10]="Dropper",e[e.Foundation=11]="Foundation",e[e.FoundationAngledLeft=12]="FoundationAngledLeft",e[e.FoundationTriangleLeftDel=13]="FoundationTriangleLeftDel",e[e.FoundationAngledRight=14]="FoundationAngledRight",e[e.FoundationTriangleRightDel=15]="FoundationTriangleRightDel",e[e.Collector=16]="Collector",e[e.FilterLeft=17]="FilterLeft",e[e.FilterRight=18]="FilterRight",e[e.SlidingFoundation=19]="SlidingFoundation",e[e.VelocitySoaker=20]="VelocitySoaker",e[e.Grower=21]="Grower",e[e.SoundBox=22]="SoundBox",e[e.Pipe=23]="Pipe",e[e.Pump=24]="Pump",e[e.LiquidVent=25]="LiquidVent",e[e.Light=26]="Light",e[e.GloomEmitter=27]="GloomEmitter"}(v||(v={})),function(e){e[e.Init=1]="Init",e[e.RunUpdate=2]="RunUpdate",e[e.SetCell=3]="SetCell",e[e.Blast=4]="Blast",e[e.Dig=5]="Dig",e[e.Vacuum=6]="Vacuum",e[e.AddStructure=7]="AddStructure",e[e.RemoveStructuresBetween=8]="RemoveStructuresBetween",e[e.HandleGrabber=9]="HandleGrabber",e[e.SwapElement=10]="SwapElement",e[e.SetChunkActive=11]="SetChunkActive",e[e.Tally=12]="Tally",e[e.Ignite=13]="Ignite",e[e.StartFogReveal=14]="StartFogReveal",e[e.SetTutorialStep=15]="SetTutorialStep",e[e.FireProjectileHit=16]="FireProjectileHit",e[e.StartWaterFreeze=17]="StartWaterFreeze",e[e.StartMelt=18]="StartMelt",e[e.Burn=19]="Burn",e[e.Explode=20]="Explode",e[e.TriggerShockwaves=21]="TriggerShockwaves",e[e.RedrawSurroundingCells=22]="RedrawSurroundingCells",e[e.IncrementFluxite=23]="IncrementFluxite",e[e.SpawnFluxiteParticles=24]="SpawnFluxiteParticles",e[e.DebugCell=25]="DebugCell",e[e.StartLavaFreeze=26]="StartLavaFreeze",e[e.PingChunk=27]="PingChunk",e[e.QueueSetCell=28]="QueueSetCell",e[e.InitFinished=29]="InitFinished",e[e.UpdateFinished=30]="UpdateFinished",e[e.SetPixel=31]="SetPixel",e[e.Collector=32]="Collector",e[e.TutorialStep=33]="TutorialStep",e[e.PlaySound=34]="PlaySound",e[e.AddLight=35]="AddLight",e[e.MoveCamera=36]="MoveCamera",e[e.SpawnWorldItem=37]="SpawnWorldItem",e[e.ForceCompleteObjective=38]="ForceCompleteObjective",e[e.Save=39]="Save",e[e.RunConveyorBelts=40]="RunConveyorBelts",e[e.UpdateStructure=41]="UpdateStructure",e[e.SetPaused=42]="SetPaused"}(p||(p={})),function(e){e[e.Main=1]="Main",e[e.Worker=2]="Worker",e[e.Manager=3]="Manager"}(f||(f={})),function(e){e[e.Even=1]="Even",e[e.Odd=2]="Odd",e[e.Both=3]="Both"}(g||(g={})),function(e){e.OpenBuildMenu="OpenBuildMenu",e.GrapplingHook="GrapplingHook",e.Escape="Escape",e.OpenTechTree="OpenTechTree",e.OpenInventory="OpenInventory",e.ReverseBuildDirection="ReverseBuildDirection",e.Marquee="Marquee",e.Pause="Pause",e.Copy="Copy",e.Delete="Delete",e.PauseCamera="PauseCamera",e.OpenUpgrades="OpenUpgrades",e.BuildMode="BuildMode",e.Demolish="Demolish",e.Jump="Jump",e.Ruler="Ruler",e.Left="Left",e.Right="Right",e.Boost="Boost",e.Descend="Descend"}(m||(m={})),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Pressed=3]="Pressed",e[e.Released=4]="Released",e[e.All=5]="All"}(y||(y={})),function(e){e[e.Building=1]="Building",e[e.Hotbar=2]="Hotbar",e[e.MainMenu=3]="MainMenu",e[e.TechTree=4]="TechTree",e[e.Research=5]="Research",e[e.InventoryItem=6]="InventoryItem",e[e.SubNavigation=7]="SubNavigation",e[e.FilterConfig=8]="FilterConfig"}(S||(S={})),function(e){e[e.MainMenu=1]="MainMenu",e[e.Intro=2]="Intro",e[e.Game=3]="Game"}(x||(x={})),function(e){e[e.Move=1]="Move",e[e.Dig=2]="Dig",e[e.Hotbar=3]="Hotbar",e[e.PickUpSand=4]="PickUpSand",e[e.WetSand=5]="WetSand",e[e.RefineWetSand=6]="RefineWetSand",e[e.SellGold=7]="SellGold",e[e.OpenTechTree=8]="OpenTechTree",e[e.UnlockRefining=9]="UnlockRefining",e[e.OpenBuildMenu=10]="OpenBuildMenu",e[e.BuildShaker=11]="BuildShaker",e[e.RefineGoldWithShaker=12]="RefineGoldWithShaker",e[e.UnlockLogistics=13]="UnlockLogistics",e[e.TutorialEnd=14]="TutorialEnd"}(b||(b={})),function(e){e[e.Refining1=1]="Refining1",e[e.Logistics1=2]="Logistics1",e[e.Guns1=3]="Guns1",e[e.Filters1=4]="Filters1",e[e.Tools1=5]="Tools1",e[e.Tools2=6]="Tools2",e[e.Refining2=7]="Refining2",e[e.Guns2=8]="Guns2",e[e.Drones1=9]="Drones1",e[e.Upgrading2=10]="Upgrading2",e[e.Filters2=11]="Filters2",e[e.Upgrading3=12]="Upgrading3",e[e.Upgrading4=13]="Upgrading4",e[e.Upgrading5=14]="Upgrading5",e[e.Upgrading6=15]="Upgrading6",e[e.Upgrading7=16]="Upgrading7",e[e.Upgrading8=17]="Upgrading8",e[e.Upgrading9=18]="Upgrading9",e[e.Upgrading10=19]="Upgrading10",e[e.Refining3=20]="Refining3",e[e.Refining4=21]="Refining4",e[e.Tools3=22]="Tools3",e[e.Pipes1=23]="Pipes1",e[e.Lights1=24]="Lights1",e[e.Drones2=25]="Drones2",e[e.Refining5=26]="Refining5",e[e.Tools4=27]="Tools4",e[e.Guns3=28]="Guns3"}(R||(R={})),function(e){e[e.Available=0]="Available",e[e.Visible=1]="Visible",e[e.Researched=2]="Researched",e[e.Unknown=3]="Unknown",e[e.Hidden=4]="Hidden"}(k||(k={})),function(e){e[e.ConveyorBelts=1]="ConveyorBelts",e[e.Shakers=2]="Shakers",e[e.UpdateMachinery=3]="UpdateMachinery",e[e.SpawnMainMenuElements=4]="SpawnMainMenuElements",e[e.Autosave=5]="Autosave",e[e.Pump=6]="Pump",e[e.EmitGloom=7]="EmitGloom",e[e.PingPumpChunksFIX=8]="PingPumpChunksFIX"}(w||(w={})),function(e){e[e.Linear=1]="Linear",e[e.Rectangular=2]="Rectangular"}(F||(F={})),function(e){e[e.Above=1]="Above",e[e.TransitioningAbove=2]="TransitioningAbove",e[e.TransitioningBelow=3]="TransitioningBelow",e[e.Below=4]="Below"}(M||(M={})),function(e){e[e.Available=1]="Available",e[e.FullyBlocked=2]="FullyBlocked",e[e.PartiallyBlocked=3]="PartiallyBlocked"}(T||(T={})),function(e){e[e.Hotbar=1]="Hotbar",e[e.SoundBoxConfig=2]="SoundBoxConfig",e[e.Debug=3]="Debug",e[e.Root=4]="Root",e[e.Menu=5]="Menu",e[e.Management=6]="Management",e[e.FilterConfig=7]="FilterConfig",e[e.Resources=8]="Resources",e[e.TechTree=9]="TechTree",e[e.Tutorial=10]="Tutorial",e[e.Loader=11]="Loader",e[e.Options=12]="Options",e[e.ShortcutHelper=13]="ShortcutHelper",e[e.Upgrades=14]="Upgrades",e[e.Tooltip=15]="Tooltip",e[e.Notifications=16]="Notifications",e[e.Objectives=17]="Objectives"}(A||(A={})),function(e){e[e.Unselected=0]="Unselected",e[e.Selected=1]="Selected",e[e.Copying=2]="Copying",e[e.Moving=3]="Moving"}(C||(C={})),function(e){e[e.None=0]="None",e[e.ObstacleStart=252]="ObstacleStart",e[e.Misc=253]="Misc",e[e.Darkness=254]="Darkness"}(B||(B={})),function(e){e[e.NoJetpack=1]="NoJetpack",e[e.NoGrab=2]="NoGrab",e[e.NoBuild=3]="NoBuild",e[e.NoFlamethrower=4]="NoFlamethrower"}(L||(L={})),function(e){e[e.Artifact1=1]="Artifact1",e[e.Artifact2=2]="Artifact2"}(P||(P={})),function(e){e[e.Boss1=1]="Boss1"}(Z||(Z={})),function(e){e[e.Digger=1]="Digger",e[e.Hauler=2]="Hauler"}(D||(D={})),function(e){e[e.Artifact=1]="Artifact"}(I||(I={}))},8288:(e,t,n)=>{n(7028),n(6921),n(6185)},3103:(e,t,n)=>{n.d(t,{Ls:()=>d,Y8:()=>o,in:()=>u,pp:()=>c});var r=n(7028),a=n(3734),i=n(9025),o=function(e,t){return 1e6*Math.sin(437057.545323*(112.01716*e+718.233*t))&255},l=function(e,t,n){n/=100;var r=function(t){return(t+e/30)%12},a=(t/=100)*Math.min(n,1-n),i=function(e){return n-a*Math.max(-1,Math.min(r(e)-3,Math.min(9-r(e),1)))};return[Math.round(255*i(0)),Math.round(255*i(8)),Math.round(255*i(4)),255]},s=r.A.debug.defaultBaseHue,u=(l(s,60,40),l(s,60,37),function(e,t,n,r){return e.session.colors.damagedSoilByColor?!!e.session.colors.damagedSoilByColor[t]&&!!e.session.colors.damagedSoilByColor[t][n]&&!!e.session.colors.damagedSoilByColor[t][n][r]:(console.log("NO ISDAMAMS",e.session.colors.damagedSoilByColor),!1)}),c=function(e,t,n,s){var c,d,h;if(s===a.vZ.Empty)return[0,0,0,0];if([a.vZ.SandSoil,a.vZ.SporeSoil,a.vZ.Bedrock,a.vZ.Fog,a.vZ.FogJetpackBlock,a.vZ.FogWater,a.vZ.FogLava,a.vZ.FreezingIceSoil,a.vZ.Ice,a.vZ.Divider,a.vZ.Grass,a.vZ.Moss,a.vZ.GoldSoil,a.vZ.Petal,a.vZ.Fluxite,a.vZ.SandiumSoil,a.vZ.Obsidian,a.vZ.Crackstone].includes(s)){for(var v=!1,p=t-5;p<t+5;p++)for(var f=n-5;f<n+5;f++)if(!(p<0||f<0||p>=e.store.world.matrix.length||f>=e.store.world.matrix[0].length)){var g=p-t,m=f-n,y=Math.sqrt(g*g+m*m);if(!(y>=5))if(r.A.useMultithreading){var S=e.shared.obstacleImageData,x=4*(p+f*S.width),b=S.data[x],R=S.data[x+1],k=S.data[x+2];(0===S.data[x+3]||u(e,b,R,k))&&(!1===v||v>y)&&(v=y)}else e.store.world.matrix[f][p]!==a.vZ.SandSoil&&(!1===v||v>y)&&(v=y)}if(!1===v)return[0,0,0,255];var w=null!==(d=((c={})[a.vZ.Bedrock]={H:0,S:0,L:66},c[a.vZ.Ice]={H:199,S:99,L:90},c[a.vZ.Divider]={H:30,S:100,L:50},c[a.vZ.GoldSoil]={H:60,S:100,L:50},c)[s])&&void 0!==d?d:{H:e.session.colors.scheme.soil[s][0][0],S:e.session.colors.scheme.soil[s][0][1],L:e.session.colors.scheme.soil[s][0][2]},F=w.H,M=w.S,T=w.L,A=T-T/4*(v-1);return s===a.vZ.Fog?[0,0,0,Math.max(1,10*v)]:l(F,M,A)}if([a.vZ.Block,a.vZ.ConveyorLeft,a.vZ.ConveyorRight,a.vZ.ShakerLeft,a.vZ.ShakerRight,a.vZ.SlidingBlock,a.vZ.SlidingBlockLeft,a.vZ.SlidingBlockRight,a.vZ.VelocitySoaker,a.vZ.Grower].includes(s))return[255,255,255,255];if([a.vZ.SandSoil,a.vZ.SporeSoil,a.vZ.FreezingIceSoil,a.vZ.Grass,a.vZ.Moss,a.vZ.GoldSoil,a.vZ.Petal].includes(s.cellType)){var C=(null===(h=i.l2[s.cellType])||void 0===h?void 0:h.hp)||4;return o(t,n)>s.hp/C*200?e.session.colors.scheme.soil[s.cellType][1]:e.session.colors.scheme.soil[s.cellType][2]}if(s.type===a.RJ.Sand)return(B=e.session.colors.scheme.element[a.RJ.Sand])[s.variantIndex];if(s.type===a.RJ.Particle){var B=e.session.colors.scheme.element[s.element.type];return s.element.type!==a.RJ.Sand?B[0]:B[s.element.variantIndex]}if(s.type===a.RJ.Water)return e.session.colors.scheme.element[a.RJ.Water][0];if(s.type===a.RJ.WetSand)return(B=e.session.colors.scheme.element[a.RJ.WetSand])[s.variantIndex];if(s.type===a.RJ.Slag)return(B=e.session.colors.scheme.element[a.RJ.Slag])[s.variantIndex];if(s.type===a.RJ.Gold)return(B=e.session.colors.scheme.element[a.RJ.Gold])[s.variantIndex];if(s.type===a.RJ.Steam)return e.session.colors.scheme.element[a.RJ.Steam][0];if(s.type===a.RJ.Spore)return(B=e.session.colors.scheme.element[a.RJ.Spore])[s.variantIndex];if(s.type===a.RJ.Petalium)return(B=e.session.colors.scheme.element[a.RJ.Petalium])[s.variantIndex];if(s.type===a.RJ.Seed)return(B=e.session.colors.scheme.element[a.RJ.Seed])[0];if(s.type===a.RJ.WetSpore)return(B=e.session.colors.scheme.element[a.RJ.WetSpore])[s.variantIndex];if(s.type===a.RJ.BurntSlag)return(B=e.session.colors.scheme.element[a.RJ.BurntSlag])[s.variantIndex];if(s.type===a.RJ.FreezingIce)return e.session.colors.scheme.element[a.RJ.FreezingIce][0];if(s.type===a.RJ.Flame)return(B=e.session.colors.scheme.element[a.RJ.Flame])[s.variantIndex];if(s.type===a.RJ.Fire){var L=s.duration.max-s.duration.left;return x=Math.floor(L/s.duration.max*4),e.session.colors.scheme.element[a.RJ.Fire][x]}return s.type===a.RJ.Lava?(B=e.session.colors.scheme.element[a.RJ.Lava])[s.variantIndex]:s.type===a.RJ.Sandium?(B=e.session.colors.scheme.element[a.RJ.Sandium])[s.variantIndex]:s.type===a.RJ.Gloom?e.session.colors.scheme.element[a.RJ.Gloom][0]:s.type===a.RJ.Basalt?(B=e.session.colors.scheme.element[a.RJ.Basalt])[s.variantIndex]:[255,0,0,255]},d=[.9,.7,.65,.45,.4,.32,.2,.05]},1823:(e,t,n)=>{n.d(t,{J:()=>u});var r=n(6921),a=n(3734),i=n(9025),o=n(1872),l=n(3103),s=l.Ls.length,u=function(e,t,n,u,c){return void 0===c&&(c=!1),t===a.vZ.Empty?a.b1.None:(0,o.Bp)(t)?function(e,t){var n=t.type,r=t.variantIndex;if(t.type===a.RJ.Particle&&(n=t.element.type,r=t.element.variantIndex),t.type===a.RJ.Fire){var i=t.duration.max-t.duration.left;r=Math.floor(i/t.duration.max*4)}return e.session.colors.colorIdByElementType[n][r]||e.session.colors.colorIdByElementType[n][0]}(e,t):(0,o.ez)(t)?function(e,t,n,u,c){var d;if(Number.isInteger(t))return function(e,t,n,i,u){if(r.b6.includes(t))return a.b1.Darkness;var c=e.session.colors.colorIdByGroundCellType[t];if(void 0===c)return a.b1.Misc;for(var d=!1,h=n-5;h<n+5;h++)for(var v=i-5;v<i+5;v++)if(!(u||h<0||v<0||h>=e.store.world.matrix.length||v>=e.store.world.matrix[0].length)){var p=h-n,f=v-i,g=Math.sqrt(p*p+f*f);if(!(g>=5)){var m=e.shared.mapData,y=h+v*m.width,S=m.data[y],x=e.session.colors.colorByColorId[S];(!(0,o.eH)(S)||x&&(0,l.in)(e,x[0],x[1],x[2]))&&(!1===d||d>g)&&(d=g)}}return!1===d?a.b1.Darkness:c[0===d?0:Math.round((d-1)/5*(s+3))]}(e,t,n,u,c);var h=t.cellType,v=e.session.colors.colorIdByGroundCellType[h];if(void 0===v)return a.b1.Misc;var p=(null===(d=i.l2[t.cellType])||void 0===d?void 0:d.hp)||4,f=t.hp/p*200;return v[(0,l.Y8)(n,u)>f?s+1:s+2]}(e,t,n,u,c):(console.log("This should never happen!"),a.b1.Misc)}},2370:(e,t,n)=>{n.d(t,{X:()=>s});var r=n(7028),a=n(3734),i=n(1872),o=n(3103),l=function(e,t){return r.A.useMultithreading&&e.environment.context===a.bF.Worker?(0,i.ez)(t)?e.shared.obstacleImageData:e.shared.imageData:(0,i.ez)(t)?e.session.rendering.obstacleImageData:e.session.rendering.imageData},s=function(e,t,n,r,i){var s=(0,o.pp)(e,t,n,r);if(!s)return console.log("No rgba for cell"),void u(l(e,r),t,n,0,105,108,255);if(i){var c=r===a.vZ.Empty?l(e,i):l(e,r);if(u(c,t,n,s[0],s[1],s[2],s[3]),r!==a.vZ.Empty){var d=l(e,i);d!==c&&u(d,t,n,0,0,0,0)}}else u(l(e,r),t,n,s[0],s[1],s[2],s[3])},u=function(e,t,n,r,a,i,o){var l=4*(t+n*e.width);e.data[l+0]=r,e.data[l+1]=a,e.data[l+2]=i,e.data[l+3]=o}},4249:(e,t,n)=>{},9750:(e,t,n)=>{n(7028);var r=n(3734);n(4249),n(6185),n(5502),r.ev.ConveyorLeft,r.ev.ConveyorRight,r.ev.LauncherLeft,r.ev.LauncherRight,r.ev.LauncherUp,r.ev.ShakerLeft,r.ev.ShakerRight},4693:(e,t,n)=>{n.d(t,{ib:()=>l,uQ:()=>s,xR:()=>o});var r=n(7514),a=n(7028),i=n(3734),o=(i.s0.NoJetpack,i.s0.NoGrab,i.s0.NoBuild,i.s0.NoFlamethrower,i.s0.NoBuild,i.s0.NoGrab,i.s0.NoFlamethrower,i.s0.NoBuild,function(e,t,n,r,a,i){return void 0===i&&(i={}),s(e,t,n,r,a,i).authorized}),l=function(e,t){var n=r.A.get(e.session,"structures",Math.floor(t.x/a.A.snapGridCellSize)*a.A.snapGridCellSize,Math.floor(t.y/a.A.snapGridCellSize)*a.A.snapGridCellSize);return!!n&&(n.filter||n.queued)},s=function(e,t,n,o,l,s){void 0===s&&(s={});var u=r.A.get(e.session,"structures",Math.floor(n/a.A.snapGridCellSize)*a.A.snapGridCellSize,Math.floor(o/a.A.snapGridCellSize)*a.A.snapGridCellSize);if(!u)return{authorized:!0};if(u.type===i.ev.Collector&&t.type!==i.RJ.Gold)return{authorized:!1,isFilter:!1};var c=!1;if(u.filter){if(c=!0,s.isDiagonalCheck)return{authorized:!1,isFilter:c};var d="allow"===u.filter.mode,h=!0;return u.filter.density&&t.density<u.filter.density&&(h=!1),u.filter.elementType&&((Array.isArray(u.filter.elementType)?u.filter.elementType:[u.filter.elementType]).includes(t.type)||(h=!1)),{authorized:d?h:!h,isFilter:c}}return l?{authorized:!0,isFilter:c}:u.queued?{authorized:!1,isFilter:c}:{authorized:!0,isFilter:c}}},8498:(e,t,n)=>{n.d(t,{x:()=>a}),n(6622);var r=n(9241),a=function(e,t,n){var a=(0,r.TR)(e,t,n);if(a&&a.queued){var o=e.store.postProcessing.buildCheck.locations;i(o,t,n)||(o[n]||(o[n]=[]),o[n][t]=!0,e.store.postProcessing.buildCheck.cellPositionsToTry.push({x:t,y:n}))}},i=function(e,t,n){return!!e[n]&&e[n][t]}},6622:(e,t,n)=>{n(7028);for(var r,a,i=n(1656),o=n(3734),l=(n(6185),n(1872),n(9241),n(9529),n(5468),n(4249),n(9750),n(4693),n(7509),n(3844),n(7733),n(9379),n(2539),{}),s=0,u=Object.entries(r||(r=n.t(i,2)));s<u.length;s++){var c=u[s],d=c[0],h=c[1];h.map&&(l[d]=h.map((function(e){return e.map((function(e){return{0:o.vZ.Empty,3:o.vZ.Block,4:o.vZ.ConveyorLeft,5:o.vZ.ConveyorRight,6:o.vZ.ShakerLeft,7:o.vZ.ShakerRight,8:o.vZ.SlidingBlock,9:o.vZ.SlidingBlockLeft,10:o.vZ.SlidingBlockRight,11:o.vZ.VelocitySoaker,12:o.vZ.Grower}[e]}))})))}(a={})[o.ev.ConveyorRight]={shape:l["conveyor-belt-right"],variants:[{id:o.ev.ConveyorLeft,angles:[-180,180]},{id:o.ev.ConveyorRight,angles:[0]}],name:"Conveyor Belt",description:"Transports sand and other solid elements. Hold Shift to reverse direction when building."},a[o.ev.ConveyorLeft]={shape:l["conveyor-belt-left"]},a[o.ev.ShakerRight]={variants:[{id:o.ev.ShakerLeft,angles:[-45,135]},{id:o.ev.ShakerRight,angles:[45,-135]}],name:"Shaker",description:"Place Wet Sand on the shaker to refine it automatically to Gold (↓) and Slag. Should be built diagonally to allow natural throughput."},a[o.ev.ShakerLeft]={},a[o.ev.LauncherUp]={shape:l["launcher-up"],variants:[{id:o.ev.LauncherLeft,angles:[-135]},{id:o.ev.LauncherUp,angles:[-90,90]},{id:o.ev.LauncherRight,angles:[-45]}],name:"Launcher",description:"Will launch elements upward (straight or to the sides). You can build a column of launchers to create a vertical conveyor lift."},a[o.ev.LauncherLeft]={shape:l["launcher-left"]},a[o.ev.LauncherRight]={shape:l["launcher-right"]},a[o.ev.SplitterLeft]={shape:l["splitter-left"],variants:[{id:o.ev.SplitterLeft,angles:[180]},{id:o.ev.SplitterRight,angles:[0]}]},a[o.ev.SplitterRight]={shape:l["splitter-right"]},a[o.ev.Dropper]={shape:l.dropper,variants:[{id:o.ev.Dropper,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[o.ev.Foundation]={shape:l.foundation,variants:[{id:o.ev.FoundationAngledLeft,angles:[135]},{id:o.ev.FoundationTriangleRightDel,angles:[-45]},{id:o.ev.FoundationAngledRight,angles:[45]},{id:o.ev.FoundationTriangleLeftDel,angles:[-135]},{id:o.ev.Foundation,angles:[-180,-90,0,90,180]}],name:"Block",description:"A basic block foundation. Hold Shift to reverse the direction of angled blocks."},a[o.ev.FoundationAngledLeft]={shape:l["foundation-triangle-left"]},a[o.ev.FoundationAngledRight]={shape:l["foundation-triangle-right"]},a[o.ev.Collector]={variants:[{id:o.ev.Collector,angles:[-180,-90,0,90,180,-135,-45,45,135]}],name:"Collector",description:"A collector tile that you can put gold in, giving you credits ($). Gold needs to stay inside the collector for it to be available (i.e. it needs to have a solid foundation below it). When used it will be removed automatically."},a[o.ev.FoundationTriangleRightDel]={shape:l["foundation-triangle-right-del"],variants:[{id:o.ev.FoundationTriangleRightDel,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[o.ev.FoundationTriangleLeftDel]={shape:l["foundation-triangle-left-del"]},a[o.ev.FilterRight]={variants:[{id:o.ev.FilterLeft,angles:[-180,180]},{id:o.ev.FilterRight,angles:[0]}],name:"Filter",description:"Filters out element based on the filter settings. The filtered element goes through while the rest will get transported as usual."},a[o.ev.FilterLeft]={},a[o.ev.SlidingFoundation]={shape:l["sliding-foundation"],variants:[{id:o.ev.SlidingFoundation,angles:[-180,-90,0,90,180,-135,-45,45,135]}]},a[o.ev.VelocitySoaker]={shape:l["velocity-soaker"],variants:[{id:o.ev.VelocitySoaker,angles:[-180,0,180]}],name:"Kinetic Slag Press",description:"Drop Burnt Slag on a soaker from a great height to refine it into Gold and Spores."},a[o.ev.Grower]={variants:[{id:o.ev.Grower,angles:[-180,0,180]}],name:"Planter Box",description:"Drop Wet Spores on a planter box to start growing flowers that you can destroy to get Gold and Petals."},a[o.ev.SoundBox]={variants:[{id:o.ev.SoundBox,angles:[-180,0,180]}]},a[o.ev.Pipe]={variants:[{id:o.ev.Pipe,angles:[-180,-90,0,90,180]}],name:"Pipe",description:"Pipes are used to transport liquids."},a[o.ev.Pump]={variants:[{id:o.ev.Pump,angles:[0]}],singleBuild:!0,name:"Pump",description:"Draws in liquid and runs it through the connected pipes."},a[o.ev.LiquidVent]={variants:[{id:o.ev.LiquidVent,angles:[0]}],singleBuild:!0,name:"Liquid Vent",description:"Releases liquids from the connected pipe."},a[o.ev.Light]={variants:[{id:o.ev.Light,angles:[0]}],singleBuild:!0,name:"Light",description:"A light that illuminates the area."},a[o.ev.GloomEmitter]={variants:[{id:o.ev.GloomEmitter,angles:[0]}],singleBuild:!0,name:"Flux Emanator",description:"Converts Voidbloom into Fluxite."}},9241:(e,t,n)=>{n.d(t,{TR:()=>a});var r=n(7028),a=(n(7514),n(1985),n(8288),n(3734),n(8792),n(5468),n(6921),n(7815),n(1872),n(6744),function(e,t,n){var a=Math.floor(t/r.A.cellSize)*r.A.cellSize,i=Math.floor(n/r.A.cellSize)*r.A.cellSize;return e.session.cache.structures[i]&&e.session.cache.structures[i][a]||null})},5676:(e,t,n)=>{n.d(t,{Fy:()=>m,KZ:()=>b,MZ:()=>x,m5:()=>R,n:()=>g,qL:()=>y,r8:()=>S});var r,a,i=n(7028),o=n(3734),l=n(5194),s=n(9909),u=n(3639),c=n(6185),d=n(9280),h=(n(1872),n(7514)),v=(n(5462),n(2127),n(5161)),p=n(5053),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},f.apply(this,arguments)},g=function(e,t,n,r){var a,l,s=R[e],u=k[s.matterType],d=function(e,t){switch(e){case o.RJ.Flame:case o.RJ.Fire:return c.A.getRandomFloatBetween(t.duration-.25,t.duration+1.25);default:return t.duration}}(e,s),h={type:e,cellType:o.vZ.Element,x:t,y:n,velocity:{x:Math.random()>=.5?1:-1,y:i.A.gravity/60},minVelocity:{x:0,y:i.A.gravity/60},threshold:{x:0,y:0},hasBeenUpdated:!1,isFreeFalling:!0,density:s.density,variantIndex:c.A.getRandomIntBetween(0,3),duration:d?{max:d,left:d}:{max:-1}};return f(f(f({},h),null===(a=s.getExtraProps)||void 0===a?void 0:a.call(s)),null===(l=u.getExtraProps)||void 0===l?void 0:l.call(u,r,h))},m=function(e,t){t.hasBeenUpdated=!0,e.world.updatedCellPositions.push({x:t.x,y:t.y})},y=function(e,t){return e.type==t},S=function(e,t){return R[e].matterType==t},x=function(e,t){return t.includes(R[e.type].matterType)},b=function(e,t,n){if(t.type===n.type)return!1;var r=h.A.get(e.session,"structures",Math.floor(t.x/i.A.snapGridCellSize)*i.A.snapGridCellSize,Math.floor(t.y/i.A.snapGridCellSize)*i.A.snapGridCellSize+i.A.snapGridCellSize);if(r&&r.filter&&r.filter.elementType){if("allow"===r.filter.mode&&r.filter.elementType===t.type)return!0;if("block"===r.filter.mode&&r.filter.elementType!==t.type)return!0}return t.density>n.density},R=((r={})[o.RJ.Sand]={name:"Sand",interactions:["💧"],density:150,matterType:o.es.Solid},r[o.RJ.WetSand]={name:"Wet Sand",interactions:["↔️"],density:150,matterType:o.es.Slushy},r[o.RJ.Slag]={name:"Slag",interactions:["🔥"],density:50,matterType:o.es.Slushy},r[o.RJ.Gold]={name:"Gold",interactions:["💰"],density:300,matterType:o.es.Solid},r[o.RJ.Water]={name:"Water",interactions:["🔥","❄️"],density:100,matterType:o.es.Liquid},r[o.RJ.Particle]={matterType:o.es.Particle},r[o.RJ.Steam]={name:"Steam",density:25,matterType:o.es.Gas},r[o.RJ.Spore]={name:"Spore",interactions:["💧"],density:150,matterType:o.es.Solid},r[o.RJ.Petalium]={name:"Amethelis",interactions:["🌄 (Redsand)"],density:40,matterType:o.es.Wisp},r[o.RJ.WetSpore]={name:"Wet Spore",interactions:["🪴"],density:100,matterType:o.es.Slushy},r[o.RJ.Seed]={name:"Seed",density:100,matterType:o.es.Static,getExtraProps:function(){var e=c.A.getRandomFloatBetween(.1,.5);return{data:{seedlings:1,grows:c.A.getRandomIntBetween(5,20),runway:20},duration:{max:e,left:e}}}},r[o.RJ.BurntSlag]={name:"Burnt Slag",interactions:["⬇️"],density:50,matterType:o.es.Solid},r[o.RJ.Fire]={name:"Fire",density:25,matterType:o.es.Gas,duration:1.28},r[o.RJ.FreezingIce]={name:"Snow",interactions:["🔥"],density:150,matterType:o.es.Solid},r[o.RJ.Flame]={name:"Flame",density:50,matterType:o.es.Solid,duration:.28},r[o.RJ.Lava]={name:"Lava",interactions:["❄️"],density:75,matterType:o.es.Liquid,duration:.28},r[o.RJ.Sandium]={name:"Redsand",interactions:["🌸 (Amethelis)"],density:160,matterType:o.es.Solid},r[o.RJ.Gloom]={name:"Voidbloom",interactions:["🔮 (Flux Emanator)"],density:30,matterType:o.es.Slushy},r[o.RJ.Basalt]={name:"Cinder",density:50,matterType:o.es.Solid},r),k=((a={})[o.es.Solid]={update:l.h},a[o.es.Liquid]={update:s.A,getExtraProps:function(e){return{movesOnSameYAxis:{y:0,count:0},lastSideCheckedPosition:null}}},a[o.es.Particle]={update:u.s,getExtraProps:function(e){return{element:e.element,velocity:e.velocity,density:e.element.density}}},a[o.es.Gas]={update:d.R,getExtraProps:function(e,t){return{movesOnSameYAxis:{y:0,count:0},lastSideCheckedPosition:null,velocity:{x:Math.random()>=.5?1:-1,y:i.A.upflow/60},minVelocity:{x:0,y:i.A.upflow/60}}}},a[o.es.Static]={update:!1},a[o.es.Slushy]={update:v.w},a[o.es.Wisp]={update:p.z},a)},6208:(e,t,n)=>{n.d(t,{Mv:()=>v,zT:()=>f});var r=n(6185),a=n(3734),i=n(5676),o=n(3812),l=n(9025),s=n(1872),u=n(7028),c=n(2370),d=n(2380),h=n(1823),v=(n(3844),n(4249),n(2587),n(446),function(e,t,n,r,i,o){void 0===o&&(o={fromRocketExplosion:!1});var u=(0,s.tT)(e.store,t,n);if((0,s.Br)(u)){if(Number.isInteger(u)){if(u===a.vZ.Crackstone&&!o.fromRocketExplosion)return;var c=u,d=l.l2[c],h=d.hp-i;if(h<=0)return void p(e,d,c,t,n,r);var v={cellType:c,hp:h};return void(0,s.Jx)(e,t,n,v)}var f=u.hp-i;f>0?(u.hp=f,(0,s.Jx)(e,t,n,u)):p(e,l.l2[u.cellType],u.cellType,t,n,r)}}),p=function(e,t,n,l,u,c){if(t.fog)(0,d.a)(e,l,u);else if(n===a.vZ.Fluxite)e.environment.postMessage([a.dD.IncrementFluxite,l,u]),e.environment.postMessage([a.dD.SpawnFluxiteParticles,l,u]),(0,s.Jx)(e,l,u,a.vZ.Empty);else if(t.output&&Math.random()<t.output.chance){var h=(0,i.n)(t.output.elementType,l,u);(0,o.J)(e,h,{x:r.A.getRandomFloatBetween(.5*-c.x,-c.x),y:-Math.abs(c.y)*r.A.getRandomFloatBetween(1,1.3)})}else(0,s.Jx)(e,l,u,a.vZ.Empty)},f=function(e,t,n,a){for(var i=-a;i<=a;i+=1)for(var o=-a;o<=a;o+=1){if(u.A.useMultithreading){var l=e.environment;if(r.A.getThreadIndexFromCellX(t+o,l.threadMeta.threadCount)!==l.threadMeta.startingIndex)continue}var d=t+o,v=n+i,p=(0,s.tT)(e.store,d,v);(0,c.X)(e,d,v,p);var f=d+v*e.shared.mapData.width;e.shared.mapData.data[f]=(0,h.J)(e,p,d,v)}}},5462:(e,t,n)=>{n(7028);var r,a=n(3734);n(6185),n(5676),n(6208),n(9692),n(1872),n(5502),n(2380),{}[a.RJ.Slag]=function(){return{output:{elementType:a.RJ.BurntSlag,chance:.25}}},(r={})[a.vZ.Moss]=!1,r[a.vZ.Divider]=!1,r[a.vZ.GoldSoil]=a.RJ.Gold,r[a.vZ.Petal]=a.RJ.Petalium},3957:(e,t,n)=>{n.d(t,{E:()=>s});var r=n(7028),a=n(3734),i=n(6185),o=n(6208),l=n(1872),s=function(e,t,n){if(t.type!==a.RJ.FreezingIce)return!1;if(n.type!==a.RJ.Water)return!1;(0,l.Jx)(e,t.x,t.y,a.vZ.Empty);var s=n.x,u=n.y,c=function(t,n){var r=(0,l.QC)(e,t,n),i=(0,l.BQ)(e,t,n);return r===a.RJ.Water||i===a.vZ.Ice},d=c(s-1,u),h=c(s+1,u),v=c(s,u-1),p=c(s,u+1);return!(!d&&!h||!v&&!p||(function(e,t,n){var s,u,c,d;s=void 0,u=void 0,d=function(){var s,u,c,d,h,v,p,f,g,m,y;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(S){switch(S.label){case 0:s=[[t,n]],u=new Set,S.label=1;case 1:return s.length>0?s.length>20?[2]:(c=Math.random())<.01?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:S.sent(),S.label=3;case 3:return c<.2&&s.sort((function(){return Math.random()-.5})),d=s.shift(),h=d[0],v=d[1],r.A.useMultithreading&&(p=e.environment,(f=i.A.getThreadIndexFromCellX(h,p.threadMeta.threadCount))!==p.threadMeta.startingIndex)?(e.environment.threadMeta.ports[f].postMessage([a.dD.StartWaterFreeze,h,v]),[3,1]):u.has("".concat(h,",").concat(v))?[3,1]:(u.add("".concat(h,",").concat(v)),g=(0,l.tT)(e.store,h,v),(0,l.af)(g,a.RJ.Water)?(m={x:h*r.A.cellSize,y:v*r.A.cellSize,width:r.A.cellSize,height:r.A.cellSize},y={x:e.shared.playerPos[0],y:e.shared.playerPos[1],width:r.A.playerSize.width,height:r.A.playerSize.height},i.A.doRectanglesOverlap(m,y)||((0,l.Jx)(e,h,v,a.vZ.Ice),(0,o.zT)(e,h,v,4)),s.push([h+1,v]),s.push([h-1,v]),s.push([h,v+1]),s.push([h,v-1]),[3,1]):[3,1]);case 4:return[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{a(d.next(e))}catch(e){t(e)}}function r(e){try{a(d.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof c?a:new c((function(e){e(a)}))).then(n,r)}a((d=d.apply(s,u||[])).next())}))}(e,n.x,n.y),e.environment.postMessage([a.dD.PlaySound,[{id:"freeze",opts:{volume:.2,fadeOut:i.A.getRandomFloatBetween(.1,2),playbackRate:i.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:n.x*r.A.cellSize,y:n.y*r.A.cellSize}}]]),0))}},5468:(e,t,n)=>{n(7028),n(7815),n(4249),n(6185),n(9241)},3452:(e,t,n)=>{n.d(t,{N:()=>s});var r=n(7028),a=n(3734),i=n(6185),o=n(6208),l=n(1872),s=function(e,t,n){if(t.type!==a.RJ.FreezingIce)return!1;if(n.type!==a.RJ.Lava)return!1;(0,l.Jx)(e,t.x,t.y,a.vZ.Empty);var s=n.x,u=n.y,c=function(t,n){var r=(0,l.QC)(e,t,n),i=(0,l.BQ)(e,t,n);return r===a.RJ.Lava||i===a.vZ.Obsidian},d=c(s-1,u),h=c(s+1,u),v=c(s,u-1),p=c(s,u+1);return!(!d&&!h||!v&&!p||(function(e,t,n){var s,u,c,d;s=void 0,u=void 0,d=function(){var s,u,c,d,h,v,p,f,g,m,y;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(S){switch(S.label){case 0:s=[[t,n]],u=new Set,S.label=1;case 1:return s.length>0?s.length>20?[2]:(c=Math.random())<.01?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:S.sent(),S.label=3;case 3:return c<.2&&s.sort((function(){return Math.random()-.5})),d=s.shift(),h=d[0],v=d[1],r.A.useMultithreading&&(p=e.environment,(f=i.A.getThreadIndexFromCellX(h,p.threadMeta.threadCount))!==p.threadMeta.startingIndex)?(e.environment.threadMeta.ports[f].postMessage([a.dD.StartLavaFreeze,h,v]),[3,1]):u.has("".concat(h,",").concat(v))?[3,1]:(u.add("".concat(h,",").concat(v)),g=(0,l.tT)(e.store,h,v),(0,l.af)(g,a.RJ.Lava)?(m={x:h*r.A.cellSize,y:v*r.A.cellSize,width:r.A.cellSize,height:r.A.cellSize},y={x:e.shared.playerPos[0],y:e.shared.playerPos[1],width:r.A.playerSize.width,height:r.A.playerSize.height},i.A.doRectanglesOverlap(m,y)||((0,l.Jx)(e,h,v,a.vZ.Obsidian),(0,o.zT)(e,h,v,4)),s.push([h+1,v]),s.push([h-1,v]),s.push([h,v+1]),s.push([h,v-1]),[3,1]):[3,1]);case 4:return[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{a(d.next(e))}catch(e){t(e)}}function r(e){try{a(d.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof c?a:new c((function(e){e(a)}))).then(n,r)}a((d=d.apply(s,u||[])).next())}))}(e,n.x,n.y),e.environment.postMessage([a.dD.PlaySound,[{id:"freeze",opts:{volume:.2,fadeOut:i.A.getRandomFloatBetween(.1,2),playbackRate:i.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:n.x*r.A.cellSize,y:n.y*r.A.cellSize}}]]),0))}},9379:(e,t,n)=>{n(7028)},9692:(e,t,n)=>{n.d(t,{P$:()=>d,kH:()=>h});var r=n(7028),a=n(3734),i=n(6185),o=n(5676),l=n(6208),s=n(2380),u=n(1872),c=!1,d=function(e,t,n,d){return h=void 0,v=void 0,f=function(){var h,v,p,f,g,m,y,S,x,b;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(R){switch(R.label){case 0:h=[[t,n]],v=new Set,p=d===a.vZ.Ice?40:10,R.label=1;case 1:return h.length>0?h.length>p?[2]:(f=Math.random())<.99?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:R.sent(),R.label=3;case 3:return f<.2&&h.sort((function(){return Math.random()-.5})),g=h.shift(),m=g[0],y=g[1],r.A.useMultithreading&&(S=e.environment,(x=i.A.getThreadIndexFromCellX(m,S.threadMeta.threadCount))!==S.threadMeta.startingIndex)?(e.environment.threadMeta.ports[x].postMessage([a.dD.StartMelt,m,y,d]),[3,1]):v.has("".concat(m,",").concat(y))?[3,1]:(v.add("".concat(m,",").concat(y)),b=(0,u.tT)(e.store,m,y),(0,u.W)(b,a.vZ.Ice)||b===a.vZ.FreezingIceSoil?(b===a.vZ.FreezingIceSoil?(0,l.Mv)(e,m,y,{x:0,y:0},3):((0,u.Jx)(e,m,y,(0,o.n)(a.RJ.Water,m,y)),c||(e.environment.postMessage([a.dD.ForceCompleteObjective,"melt_ice"]),c=!0)),(0,l.zT)(e,m,y,4),h.push([m+1,y]),h.push([m-1,y]),h.push([m,y+1]),h.push([m,y-1]),[3,1]):((0,s.x)(e,b,m,y),[3,1]));case 4:return[2]}}))},new((p=void 0)||(p=Promise))((function(e,t){function n(e){try{a(f.next(e))}catch(e){t(e)}}function r(e){try{a(f.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof p?a:new p((function(e){e(a)}))).then(n,r)}a((f=f.apply(h,v||[])).next())}));var h,v,p,f},h=function(e,t,n){(Math.random()>=.99||[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}].every((function(r){return(0,u.lV)(e,t+r.x,n+r.y)||(0,u.QC)(e,t+r.x,n+r.y)===a.RJ.Fire})))&&v(e,t,n)},v=function(e,t,n){var r=(0,u.tT)(e.store,t,n);((0,u.W)(r,a.vZ.Ice)||r===a.vZ.FreezingIceSoil)&&d(e,t,n,r)}},3812:(e,t,n)=>{n.d(t,{J:()=>o});var r=n(3734),a=n(1872),i=n(5676),o=function(e,t,n){var o=(0,i.n)(r.RJ.Particle,t.x,t.y,{element:t,velocity:n});return(0,a.Jx)(e,t.x,t.y,o),o}},7733:(e,t,n)=>{n(7514),n(3734),n(7028),n(5676),n(1872),n(3174),n(6185)},1985:(e,t,n)=>{n(7028),n(3734),n(1872),n(9241),n(6185),n(5468),n(5051),n(6208)},6744:(e,t,n)=>{n.d(t,{yQ:()=>l}),n(7028);var r=n(3734),a=(n(3844),n(6185),n(9241)),i=n(1872),o=function(e){return null!==e&&e.type===r.ev.Collector},l=function(e,t,n,l){if(function(e,t){return!!(0,i.af)(t,r.RJ.Gold)||!(!(0,i.af)(t,r.RJ.Particle)||t.element.type!==r.RJ.Gold)}(0,t)){var d=(0,a.TR)(e,n.x,n.y),h=(0,a.TR)(e,l.x,l.y),v=o(d),p=o(h);v&&s(e,d,1),p&&s(e,h,-1),v&&!p?u(e,n):!v&&p&&c(e,n)}},s=function(e,t,n,a){void 0===a&&(a=!1),t.data||(t.data={gold:0}),a?t.data.gold=n:t.data.gold+=n;var i=t.data.gold>0;t.data.hasGold!==i&&(t.data.hasGold=i,e.environment.context===r.bF.Main?e.environment.multithreading.simulation.postAll(e,[r.dD.UpdateStructure,t]):e.environment.postMessage([r.dD.UpdateStructure,t]))},u=function(e,t){e.environment.postMessage([r.dD.Collector,1,t])},c=function(e,t){e.environment.postMessage([r.dD.Collector,-1,t])}},1558:(e,t,n)=>{n.d(t,{c:()=>d});var r=n(7028),a=n(3734),i=n(1872),o=n(5676),l=n(4571),s=n(6185),u=n(6921),c=n(4693),d=function(e,t,n,f,g){void 0===g&&(g=1);var m=p(f);if(m||(m=v(n)),r.A.useMultithreading,m){var y=Math.sign(m.x),S=Math.sign(m.y),x=Math.ceil(Math.abs(m.x))*y,b=Math.ceil(Math.abs(m.y))*S;if(1===g&&[a.ev.ShakerLeft,a.ev.ShakerRight].includes(f)&&t.type===a.RJ.WetSand)(0,l.h)(e,t);else{var R={x:t.x+x,y:t.y+b},k=s.A.iterateToAndGetLastPosFulfillingCondition(t,R,(function(n,a){if(!(0,c.xR)(e,t,n,a,(0,c.ib)(e,t)))return!1;if(r.A.useMultithreading){var o=e.shared.imageData,l=4*(n+a*o.width);if(0!==e.shared.obstacleImageData.data[l+3])return!1;if(0===o.data[l+3])return!0;var s=e.session.colors.elementByColor[o.data[l]][o.data[l+1]][o.data[l+2]];return u.ji.includes(s)}var d=(0,i.tT)(e.store,n,a);return(0,i.sT)(d,u.ji)}));if(k.x!==t.x||k.y!==t.y){var w=(0,i.tT)(e.store,t.x,t.y-1);if((0,i.Bp)(w)&&(0,o.MZ)(w,[a.es.Solid,a.es.Slushy,a.es.Wisp])&&(g>100?console.log("more than 100 distanceToConveyor",t.x,t.y):d(e,w,n,f,g+1)),h(e,t,g,k)&&(t.isFreeFalling=!0),r.A.useMultithreading){var F=e.shared.imageData,M=4*(k.x+k.y*F.width),T=0!==F.data[M+3]?e.session.colors.elementByColor[F.data[M]][F.data[M+1]][F.data[M+2]]:null;null!==T&&u.ji.includes(T)?(0,i.Hs)(e,t,k.x,k.y,{eager:T}):(0,i.L3)(e,t,k.x,k.y)}else{var A=(0,i.tT)(e.store,k.x,k.y);(0,i.af)(A,u.ji)?(0,i.Hc)(e,t,A):(0,i.L3)(e,t,k.x,k.y)}}else(0,i.Y$)(e,t.x,t.y)}}else console.log("No beltVelocity",f,n)},h=function(e,t,n,a){if(1!==n)return!1;if(r.A.useMultithreading){var o=e.environment;if(!s.A.isCellXInThread(a.x,o.threadMeta.startingIndex,o.threadMeta.threadCount)){var l=e.shared.imageData,u=4*(a.x+(a.y+1)*l.width);if(l.data[u+3]>0)return!1;if(e.shared.obstacleImageData.data[u+3]>0)return!1}}var c=(0,i.tT)(e.store,a.x,a.y+1);return!!(0,i.Ol)(c)},v=function(e){var t=r.A.conveyorDefaultSpeed;switch(e){case a.vZ.ConveyorLeft:return{x:-t,y:0};case a.vZ.ConveyorRight:return{x:t,y:0}}},p=function(e){switch(e){case a.ev.ShakerLeft:case a.ev.FilterLeft:return{x:-.005,y:0};case a.ev.ShakerRight:case a.ev.FilterRight:return{x:.005,y:0}}return!1}},2127:(e,t,n)=>{n.d(t,{$:()=>l});var r=n(3734),a=(n(6185),n(9241)),i=n(5676),o=(n(6208),n(1872)),l=function(e,t){if(t.type!==r.RJ.WetSpore)return!1;var n=(0,a.TR)(e,t.x,t.y+1);return!(!n||n.type!==r.ev.Grower||((0,o.Jx)(e,t.x,t.y,(0,i.n)(r.RJ.Seed,t.x,t.y)),0))}},6119:(e,t,n)=>{n.d(t,{t:()=>o});var r=n(7028),a=n(3734),i=n(9241),o=function(e,t,n,o){var l=(0,i.TR)(e,n.x,n.y);if(l&&l.type===a.ev.SoundBox&&!function(e,t){var n=(0,i.TR)(e,t.x,t.y);return!!n&&n.type===a.ev.SoundBox}(e,o)){var s=l.data.note.tone;e.environment.postMessage([a.dD.PlaySound,[{id:"piano_".concat(s),opts:{playbackRate:[.5,1,2][l.data.note.octave],volume:1,filters:[{type:"lowpass",frequency:2e3*Math.random()+100}]},modulateDistance:{x:l.x*r.A.cellSize,y:l.y*r.A.cellSize}}]])}}},3174:(e,t,n)=>{n(7028),n(3734),n(1872),n(9241),n(6622),n(5468),n(4249),n(9750),n(6185),n(6744),n(7733),n(7514),n(9379)},2234:(e,t,n)=>{n(7028),n(3734),n(9241),n(1872),n(5676),n(6185),n(5468),n(4249),n(6208),n(9529),n(8135),n(2539),n(3844),n(4693)},1872:(e,t,n)=>{n.d(t,{BQ:()=>I,Bp:()=>F,Br:()=>k,Do:()=>b,Hc:()=>y,Hs:()=>Z,Jx:()=>g,L3:()=>m,Nz:()=>S,OA:()=>L,Ol:()=>C,QC:()=>D,W:()=>A,Y$:()=>R,af:()=>T,eH:()=>J,ez:()=>w,lV:()=>P,sT:()=>B,tT:()=>f});var r=n(7028),a=n(6185),i=n(3734),o=n(6921),l=n(5676),s=n(2370),u=n(6744),c=n(9025),d=n(4832),h=n(8498),v=n(6119),p=n(1823),f=(i.vZ.SandSoil,i.vZ.SandSoil,i.vZ.Grass,i.vZ.SandSoil,i.vZ.Moss,i.vZ.Bedrock,i.vZ.Divider,i.vZ.SporeSoil,i.vZ.FreezingIceSoil,i.vZ.SandSoil,i.vZ.FreezingIceSoil,i.vZ.Fog,i.vZ.FogJetpackBlock,i.vZ.FogJetpackBlock,i.vZ.FogWater,i.vZ.Bedrock,i.vZ.Fog,i.vZ.SandSoil,i.vZ.FogWater,i.vZ.SandSoil,i.vZ.FogLava,i.vZ.Fluxite,i.vZ.SandiumSoil,i.vZ.Crackstone,c.$4[2],c.$4[2],i.vZ.Fog,i.vZ.SandSoil,function(e,t,n){return e.world.matrix[n][t]}),g=function(e,t,n,o){if(r.A.useMultithreading&&e.environment.context===i.bF.Main){var l=e.environment;l.multithreading.simulation.post(e,a.A.getThreadIndexFromCellX(t,l.multithreading.simulation.threads.length),[i.dD.SetCell,[t,n,o]])}else{var u=e.environment,c=a.A.getThreadIndexFromCellX(t,u.threadMeta.threadCount);if(c===u.threadMeta.startingIndex){var d=t+n*e.shared.mapData.width;e.shared.mapData.data[d]=(0,p.J)(e,o,t,n),(0,s.X)(e,t,n,o,f(e.store,t,n)),e.store.world.matrix[n][t]=o,R(e,t,n),o===i.vZ.Empty&&(0,h.x)(e,t,n)}else u.threadMeta.ports[c].postMessage([i.dD.SetCell,[t,n,o]])}},m=function(e,t,n,o){if((0,v.t)(e,t,{x:n,y:o},{x:t.x,y:t.y}),(0,u.yQ)(e,t,{x:n,y:o},{x:t.x,y:t.y}),g(e,t.x,t.y,i.vZ.Empty),r.A.useMultithreading&&(0,d.D)(e,t.x,t.y),t.x=n,t.y=o,r.A.useMultithreading){var s=e.environment,c=a.A.getThreadIndexFromCellX(n,s.threadMeta.threadCount);if(c!==s.threadMeta.startingIndex)return void e.environment.threadMeta.ports[c].postMessage([i.dD.SetCell,[n,o,t]])}g(e,n,o,t),(0,l.Fy)(e.store,t)},y=function(e,t,n){var r=t.x,a=t.y;t.x=n.x,t.y=n.y,n.x=r,n.y=a,g(e,t.x,t.y,t),g(e,n.x,n.y,n),(0,l.Fy)(e.store,t),(0,l.Fy)(e.store,n)},S=function(e,t){g(e,t.x,t.y,i.vZ.Empty)},x=function(e,t,n){var a=Math.floor(n/r.A.chunkSize),i=Math.floor(t/r.A.chunkSize);return e.world.chunks[a][i]},b=function(e,t,n){return x(e,t,n).shouldUpdate},R=function(e,t,n,o){if(void 0===o&&(o={}),o.defer)e.store.world.deferredChunkReports.push({x:t,y:n});else{var l=e.store.world.chunks.length-1,s=e.store.world.chunks[0].length-1,u=Math.floor(n/r.A.chunkSize),c=Math.floor(t/r.A.chunkSize);if(!(c<0||c>s||u<0||u>l)){if(t%r.A.chunkSize==0&&c>0)if(r.A.useMultithreading&&a.A.isCellXAtThreadSeam(t)){var d=e.environment,h=a.A.getThreadIndexFromCellX(t-1,d.threadMeta.threadCount);e.environment.threadMeta.ports[h].postMessage([i.dD.SetChunkActive,[t-1,n]])}else x(e.store,t-1,n).shouldUpdateNextFrame=!0;t%r.A.chunkSize==r.A.chunkSize-1&&c<s&&(r.A.useMultithreading&&a.A.isCellXAtThreadSeam(t)?(d=e.environment,h=a.A.getThreadIndexFromCellX(t+1,d.threadMeta.threadCount),e.environment.threadMeta.ports[h].postMessage([i.dD.SetChunkActive,[t+1,n]])):x(e.store,t+1,n).shouldUpdateNextFrame=!0),n%r.A.chunkSize==0&&u>0&&(x(e.store,t,n-1).shouldUpdateNextFrame=!0),n%r.A.chunkSize==r.A.chunkSize-1&&u<l&&(x(e.store,t,n+1).shouldUpdateNextFrame=!0),x(e.store,t,n).shouldUpdateNextFrame=!0}}},k=function(e){return Number.isInteger(e)?o.gB.includes(e):o.gB.includes(e.cellType)},w=function(e){return Number.isInteger(e)?!o.iE.includes(e):!o.iE.includes(e.cellType)},F=function(e){return!Number.isInteger(e)&&e.cellType===i.vZ.Element},M=function(e,t){return Array.isArray(t)?t.includes(e.type):e.type===t},T=function(e,t){return F(e)&&M(e,t)},A=function(e,t){return Number.isInteger(e)?e===t:e.cellType===t},C=function(e){return Number.isInteger(e)&&e===i.vZ.Empty},B=function(e,t){return Number.isInteger(e)?e===i.vZ.Empty:e.cellType===i.vZ.Element&&M(e,t)},L=function(e){return function(e,t){return Number.isInteger(e)?t.includes(e):t.includes(e.cellType)}(e,o.TF)},P=function(e,t,n){if(r.A.useMultithreading){var a=e.shared.obstacleImageData,i=4*(t+n*a.width),o=a.data[i+3],l=e.shared.imageData.data[i+3];return 0===o&&0===l}var s=f(e.store,t,n);return C(s)},Z=function(e,t,n,o,s){var c;if(void 0===s&&(s={eager:!1}),(0,u.yQ)(e,t,{x:n,y:o},{x:t.x,y:t.y}),t.velocity.y=Math.min(t.velocity.y,60),r.A.useMultithreading){var d=e.environment,h=a.A.getThreadIndexFromCellX(n,d.threadMeta.threadCount);if(h!==d.threadMeta.startingIndex){if(s.eager){var v={x:t.x,y:t.y};m(e,t,n,o),g(e,v.x,v.y,(0,l.n)(s.eager,v.x,v.y))}else e.environment.threadMeta.ports[h].postMessage([i.dD.SwapElement,[n,o,t]]);return}}var p=null!==(c=s.elementToSwapWith)&&void 0!==c?c:f(e.store,n,o);y(e,t,p)},D=function(e,t,n){if(r.A.useMultithreading){var a=e.shared.imageData,i=4*(t+n*a.width),o=a.data[i],l=a.data[i+1],s=a.data[i+2];return 0===a.data[i+3]?null:e.session.colors.elementByColor[o][l][s]}var u=f(e.store,t,n);return C(u)?null:u.type},I=function(e,t,n){var a=t+n*e.shared.mapData.width,o=e.shared.mapData.data[a];return 0===o||o===i.b1.Darkness||o===i.b1.Misc||o<r.A.obstacleBreakpoint?null:e.session.colors.cellTypeOrElementTypeByColorId[o]},J=function(e){return e>=r.A.obstacleBreakpoint}},4832:(e,t,n)=>{n.d(t,{D:()=>r}),n(3734),n(5676),n(1872);var r=function(e,t,n){}},9691:(e,t,n)=>{n.d(t,{P:()=>x});var r,a,i=n(3734),o=n(7028),l=(n(1872),n(6185)),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},u=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}s((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},d=((r={})[i.eX.ConveyorBelts]={interval:333,sequentialRuns:2,multithreading:!0,callback:function(e,t,n){return u(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return 1!==t.runCount?[3,2]:(e.shared.conveyorBeltsAnimationIndex[1]++,e.shared.conveyorBeltsAnimationIndex[1]>3&&(e.shared.conveyorBeltsAnimationIndex[1]=0),[4,x(e,[i.dD.RunConveyorBelts,i.ev.ConveyorRight],!0)]);case 1:return n.sent(),[3,4];case 2:return e.shared.conveyorBeltsAnimationIndex[0]++,e.shared.conveyorBeltsAnimationIndex[0]>3&&(e.shared.conveyorBeltsAnimationIndex[0]=0),[4,x(e,[i.dD.RunConveyorBelts,i.ev.ConveyorLeft])];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}},r[i.eX.Shakers]={interval:3333,sequentialRuns:2,multithreading:!0,callback:function(e,t,n){return u(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return 1!==t.runCount?[3,2]:[4,x(e,[i.dD.RunConveyorBelts,i.ev.ShakerRight],!0)];case 1:return n.sent(),[3,4];case 2:return[4,x(e,[i.dD.RunConveyorBelts,i.ev.ShakerLeft])];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}},r[i.eX.UpdateMachinery]={interval:683,multithreading:!1,callback:function(e,t,n){return u(void 0,void 0,void 0,(function(){return c(this,(function(t){return function(e){e.store.machineryEngine.runLaunchers=!0}(e),[2]}))}))}},r),h=function(e,t){return u(void 0,void 0,void 0,(function(){var n,r,a,i;return c(this,(function(l){switch(l.label){case 0:n=0,r=e.session.triggers,l.label=1;case 1:if(!(n<r.length))return[3,8];if(a=r[n],(i=d[a.id]).multithreading&&!o.A.useMultithreading)return[3,7];a.accumulator+=t,l.label=2;case 2:return a.accumulator>=i.interval?i.sequentialRuns?[3,4]:[4,i.callback(e,a,t)]:[3,7];case 3:return l.sent(),a.accumulator-=i.interval,[3,6];case 4:return a.runCount++,[4,i.callback(e,a,t)];case 5:if(l.sent(),a.runCount<i.sequentialRuns)return[3,7];a.runCount=0,a.accumulator-=i.interval,l.label=6;case 6:return[3,2];case 7:return n++,[3,1];case 8:return[2]}}))}))},v=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}s((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},f=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},g=performance.now(),m=1/30;self.onmessage=function(e){switch(e.data[0]){case i.dD.Init:a={environment:{context:i.bF.Manager,postMessage:self.postMessage.bind(self),threadsLength:e.data[1],workerPorts:e.data[2],multithreading:{simulation:{resolvers:{}}}},store:{world:{size:{width:e.data[3],height:e.data[4]}},meta:{tick:0},machineryEngine:{runLaunchers:!1}},shared:{conveyorBeltsAnimationIndex:new Uint8Array(e.data[5].conveyorBeltsAnimationIndexSab)},session:{paused:!1,triggers:Object.entries(d).map((function(e){var t=e[0],n=e[1];return s(s({accumulator:0,id:parseInt(t)},n.sequentialRuns?{runCount:0}:{}),n.extra?{extra:n.extra}:{})}))}},a.environment.workerPorts.forEach((function(e){e.onmessage=function(e){return self.onmessage(e)}}));var t=function(e){return v(void 0,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return n=Math.min((e-g)/1e3,m),g=e,a.session.paused?[3,2]:[4,y(a,n)];case 1:r.sent(),r.label=2;case 2:return requestAnimationFrame(t),[2]}}))}))};t(performance.now());break;case i.dD.UpdateFinished:b(a,e.data[e.data.length-1]);break;case i.dD.RunConveyorBelts:b(a,i.dD.RunConveyorBelts);break;case i.dD.SetPaused:a.session.paused=e.data[1]}};var y=function(e,t){return v(void 0,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,h(e,1e3*t)];case 1:return n.sent(),[4,S(e,[i.dD.RunUpdate,i.yT.Even,t,e.store.meta.tick,e.store.machineryEngine.runLaunchers])];case 2:return n.sent(),[4,S(e,[i.dD.RunUpdate,i.yT.Odd,t])];case 3:return n.sent(),e.store.machineryEngine.runLaunchers=!1,[2]}}))}))},S=function(e,t){return new Promise((function(n,r){var a;if([i.dD.RunUpdate].includes(t[0])){var o=function(){for(var e="",t="0123456789abcdef",n=0;n<32;n++)e+=t[Math.floor(16*Math.random())],7!==n&&11!==n&&15!==n&&19!==n||(e+="-");return e}();t.splice(1,0,o),a=o}else a=t[0];e.environment.workerPorts.forEach((function(e){e.postMessage(t)})),e.environment.multithreading.simulation.resolvers[a]={done:0,resolve:n}}))},x=function(e,t,n){return void 0===n&&(n=!1),new Promise((function(r,a){return v(void 0,void 0,void 0,(function(){var a,i,o,s,u;return p(this,(function(c){switch(c.label){case 0:a=l.A.getNumberOfThreadColumns(e),i=n?-1:a,o=n?-1:1,s=function(n){return p(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r,a){var i=l.A.getThreadIndexFromCellX(n*l.A.getThreadColumnSize(),e.environment.threadsLength);e.environment.workerPorts[i].postMessage(f(f([],t,!0),[n],!1)),e.environment.multithreading.simulation.resolvers[t[0]]={resolve:r}}))];case 1:return r.sent(),[2]}}))},u=n?a-1:0,c.label=1;case 1:return u===i?[3,4]:[5,s(u)];case 2:c.sent(),c.label=3;case 3:return u+=o,[3,1];case 4:return r(),[2]}}))}))}))},b=function(e,t){var n=e.environment.multithreading.simulation.resolvers,r=n[t];void 0!==r.done?(r.done++,r.done===e.environment.threadsLength&&(r.resolve(),delete n[t])):r.resolve()}}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=a,o.x=()=>{var e=o.O(void 0,[153,515],(()=>o(9691)));return o.O(e)},e=[],o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,r,a]=e[c],l=!0,s=0;s<n.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);o.r(a);var i={};t=t||[null,n({}),n([]),n(n)];for(var l=2&r&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,o.d(a,i),a},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>e+".bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={546:1};o.f.i=(t,n)=>{e[t]||importScripts(o.p+o.u(t))};var t=self.webpackChunksand_v1=self.webpackChunksand_v1||[],n=t.push.bind(t);t.push=t=>{var[r,a,i]=t;for(var l in a)o.o(a,l)&&(o.m[l]=a[l]);for(i&&i(o);r.length;)e[r.pop()]=1;n(t)}})(),r=o.x,o.x=()=>Promise.all([o.e(153),o.e(515)]).then(r),o.x()})();