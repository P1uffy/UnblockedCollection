"use strict";(self.webpackChunksand_v1=self.webpackChunksand_v1||[]).push([[515],{7514:(e,t,r)=>{r.d(t,{A:()=>n});var i={init:function(e,t,r){void 0===r&&(r=!1),i.setup(t,"structures",e.structures),r&&i.setup(t,"pipes",e.pipes)},setup:function(e,t,r){r.forEach((function(r){i.set(e,t,r.x,r.y,r)}))},get:function(e,t,r,i){if(!e.cache[t])throw new Error('Cache "'.concat(t,'" not found'));return e.cache[t][i]&&e.cache[t][i][r]||!1},set:function(e,t,r,i,n){if(!e.cache[t])throw new Error('Cache "'.concat(t,'" not found'));e.cache[t][i]||(e.cache[t][i]=[]),e.cache[t][i][r]=n},delete:function(e,t,r,i){if(!e.cache[t])throw new Error('Cache "'.concat(t,'" not found'));if(!e.cache[t][i])throw new Error('Cache "'.concat(t,'" at ').concat(i," not found when deleting"));delete e.cache[t][i][r]}};const n=i},7028:(e,t,r)=>{r.d(t,{A:()=>i});const i={version:"0.0.5",playtest:!0,fps:60,lockFps:!1,chunkSize:40,cellSize:4,minimapSize:1600,gravity:.06*60*60,upflow:60*-.36,snapGridCellSize:4,startingResources:0,debug:{active:!1,showUnderlyingCellsInStructures:!0,drawChunks:!1,drawChunkFade:60,drawRulers:!1,showThreadLoad:!1,controls:!0,defaultBaseHue:35,brushSize:1,doNotDrawStructures:!1,stopOnDebugCellUpdate:!1,overrideLightSize:!1,overrideTerrainShadow:!1,lightSize:700,terrainShadowValue:.995,flashlight:{brightness:2,size:200,duration:100,color:[1,.5,0,1]}},conveyorDefaultSpeed:.05,useMultithreading:!0,useExperimentalRenderer:!1,obstacleBreakpoint:100,playerSize:{width:12,height:30},matrixCompression:{padding:100}}},6921:(e,t,r)=>{r.d(t,{CC:()=>s,TF:()=>l,b6:()=>o,gB:()=>a,iE:()=>n,ji:()=>h});var i=r(3734),n=[i.vZ.Empty,i.vZ.Element],a=(Object.keys(i.vZ).filter((function(e){return!n.includes(i.vZ[e])})).map((function(e){return i.vZ[e]})),[i.vZ.SandSoil,i.vZ.SporeSoil,i.vZ.Fog,i.vZ.FogJetpackBlock,i.vZ.FreezingIceSoil,i.vZ.Divider,i.vZ.Grass,i.vZ.Moss,i.vZ.GoldSoil,i.vZ.Petal,i.vZ.Fluxite,i.vZ.SandiumSoil,i.vZ.Obsidian,i.vZ.Crackstone]),o=[i.vZ.Fog,i.vZ.FogJetpackBlock,i.vZ.FogWater,i.vZ.FogLava],l=[i.vZ.ConveyorLeft,i.vZ.ConveyorRight,i.vZ.ShakerLeft,i.vZ.ShakerRight],s=[i.ev.ConveyorLeft,i.ev.ConveyorRight,i.ev.ShakerLeft,i.ev.ShakerRight,i.ev.FilterLeft,i.ev.FilterRight],h=[i.RJ.Water,i.RJ.Steam,i.RJ.Lava]},7815:(e,t,r)=>{r(9584),r(8737),r(3734),r(7157),r(4890)},8737:(e,t,r)=>{var i=r(7028);r(6185),r(7815),i.A.fps},9108:(e,t,r)=>{"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ/:Â§?,".split("")},7157:(e,t,r)=>{r(9241),r(7815),r(3734),r(7549)},7549:(e,t,r)=>{r(7028),r(6921),r(3734),r(2539),r(6185),r(7157),r(5676),r(1872)},2380:(e,t,r)=>{r.d(t,{a:()=>c,x:()=>u});var i=r(7028),n=r(6921),a=r(3734),o=r(6185),l=r(5676),s=r(6208),h=r(1872),c=function(e,t,r){return c=void 0,u=void 0,d=function(){var c,u,y,d,v,f,x,g,m,p,S,A;return function(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((n=(n=o.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(R){switch(R.label){case 0:c=[[t,r]],u=new Set,R.label=1;case 1:return c.length>0?(y=Math.random())<.01?[4,new Promise((function(e){return setTimeout(e,0)}))]:[3,3]:[3,4];case 2:R.sent(),R.label=3;case 3:return y<.2&&c.sort((function(){return Math.random()-.5})),d=c.shift(),v=d[0],f=d[1],i.A.useMultithreading&&(x=e.environment,(g=o.A.getThreadIndexFromCellX(v,x.threadMeta.threadCount))!==x.threadMeta.startingIndex)?(e.environment.threadMeta.ports[g].postMessage([a.dD.StartFogReveal,v,f]),[3,1]):u.has("".concat(v,",").concat(f))?[3,1]:(u.add("".concat(v,",").concat(f)),m=(0,h.tT)(e.store,v,f),Number.isInteger(m)&&n.b6.includes(m)?((p=e.session.mainSensorCache.get(v,f))&&(S=p===a.$U.Artifact1?"Zorvix-22":"Q7-Arynth",e.environment.postMessage([a.dD.SpawnWorldItem,a.KW.Artifact,v*i.A.cellSize,f*i.A.cellSize,{name:S,sensor:{position:{x:v,y:f}}}])),A=function(e,t,r){return e===a.vZ.FogWater?(0,l.n)(a.RJ.Water,t,r):e===a.vZ.FogLava?(0,l.n)(a.RJ.Lava,t,r):a.vZ.Empty}(m,v,f),(0,h.Jx)(e,v,f,A),c.push([v+1,f]),c.push([v-1,f]),c.push([v,f+1]),c.push([v,f-1]),[3,1]):((0,s.zT)(e,v,f,4),[3,1]));case 4:return[2]}}))},new((y=void 0)||(y=Promise))((function(e,t){function r(e){try{n(d.next(e))}catch(e){t(e)}}function i(e){try{n(d.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof y?n:new y((function(e){e(n)}))).then(r,i)}n((d=d.apply(c,u||[])).next())}));var c,u,y,d},u=function(e,t,r,i){Number.isInteger(t)&&n.b6.includes(t)&&c(e,r,i)}},9280:(e,t,r)=>{r.d(t,{R:()=>u});var i=r(7028),n=r(3734),a=r(5676),o=r(2161),l=r(1872),s=r(6185),h=r(9692),c=!1,u=function(e,t,r){var o=e.store;if(!t.hasBeenUpdated&&(0,l.Do)(o,t.x,t.y))if(t.movesOnSameYAxis.count>1e3)(0,a.qL)(t,n.RJ.Steam)?(0,l.Jx)(e,t.x,t.y,(0,a.n)(n.RJ.Water,t.x,t.y)):(0,l.Nz)(e,t);else if(t.threshold.y+=t.velocity.y*r,t.velocity.y+=i.A.upflow*r,t.threshold.y>-1)t.isFreeFalling?(0,l.Y$)(e,t.x,t.y):v(e,t);else{var s=Math.ceil(t.threshold.y);t.threshold.y=t.threshold.y%1;var h={x:t.x,y:t.y-1};if(!(h.y<0)){var u=(0,l.tT)(o,h.x,h.y);if((0,l.Ol)(u)){var f=t.y-1;if(s>1)for(var x=t.y-s,g=t.y-2;g<=x;g-=1){var m=(0,l.tT)(o,t.x,g);if(!(0,l.Ol)(m))break;f--}if(t.isFreeFalling=!0,t.y<100&&t.type===n.RJ.Steam){if(e.shared.reservoir[0]>0){e.shared.reservoir[0]--;try{(0,l.Jx)(e,t.x,f,(0,a.n)(n.RJ.Water,t.x,f)),(0,l.Jx)(e,t.x,t.y,(0,a.n)(n.RJ.Water,t.x,t.y)),c||(e.environment.postMessage([n.dD.ForceCompleteObjective,"let_it_rain"]),c=!0)}catch(e){console.log("Gas reservoir out of bounds issue happened",t,s,f)}return}return(0,l.L3)(e,t,t.x,f),void(0,l.Jx)(e,t.x,t.y,(0,a.n)(n.RJ.Water,t.x,t.y))}(0,l.L3)(e,t,t.x,f)}else y(e,t,u,h.x,h.y)||(t.isFreeFalling=!1,t.velocity.y*=.9,t.velocity.y>t.minVelocity.y&&(t.velocity.y=t.minVelocity.y),d(e,t)||v(e,t,!0))}}},y=function(e,t,r,i,s){if((0,l.Bp)(r)){if((0,o.I)(e,t,r))return!0;if(!(0,a.qL)(r,n.RJ.Particle)&&!r.isFreeFalling&&t.density>r.density)return(0,l.Hs)(e,t,r.x,r.y,{elementToSwapWith:r}),!0}return t.type===n.RJ.Fire&&r===n.vZ.Ice&&(0,h.kH)(e,i,s),!1},d=function(e,t){var r=t.velocity.x<0?-1:1,i=t.x-r,n=t.y-1;return(0,l.lV)(e,i,n)?((0,l.L3)(e,t,i,n),!0):!!f(e,t,i,n)||(i=t.x+r,(0,l.lV)(e,i,n)?((0,l.L3)(e,t,i,n),!0):!!f(e,t,i,n))},v=function(e,t,r){if(void 0===r&&(r=!1),t.type===n.RJ.Fire)return!1;for(var i,o=s.A.getRandomIntBetween(1,2),h=t.velocity.x<0?-o:o,c=t.x+h,u=t.x;u!==c;){if(u+=h<0?-1:1,!(0,l.lV)(e,u,t.y)){if(r){var y=(0,l.QC)(e,u,t.y);if(null!==y&&(0,a.r8)(y,n.es.Liquid))return f(e,t,u,t.y),!0}break}i=u}return i?(t.movesOnSameYAxis.y!==t.y&&(t.movesOnSameYAxis.y=t.y,t.movesOnSameYAxis.count=0),t.movesOnSameYAxis.count+=1,(0,l.L3)(e,t,i,t.y),!0):(t.lastSideCheckedPosition&&t.x===t.lastSideCheckedPosition||(0,l.Y$)(e,t.x,t.y),t.lastSideCheckedPosition=t.x,t.velocity.x=-t.velocity.x,!1)},f=function(e,t,r,o){if(i.A.useMultithreading){var h=e.environment;if(s.A.getThreadIndexFromCellX(r,h.threadMeta.threadCount)!==h.threadMeta.startingIndex){var c=e.shared.imageData,u=4*(r+o*c.width);if(0!==c.data[u+3]){var d=e.session.colors.elementByColor[c.data[u]][c.data[u+1]][c.data[u+2]],v=a.m5[d];if(!v)return console.log(d,"does not exist in ELEMENT_CONFIG"),!1;if(t.type===n.RJ.Fire&&v.type===n.RJ.Fire)return console.log("is this ever triggered?"),(0,l.Hs)(e,t,r,o),!0;if(t.density>v.density)return(0,l.Hs)(e,t,r,o),!0}return!1}}var f=(0,l.tT)(e.store,r,o);return!!y(e,t,f,r,o)}},9909:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(7028),n=r(3734),a=r(5676),o=r(2161),l=r(1872),s=r(6185),h=r(3957),c=r(9692),u=r(5502),y=r(3452),d=function(e,t,r){var a=e.store;if(!t.hasBeenUpdated&&(0,l.Do)(a,t.x,t.y)){if(t.movesOnSameYAxis.count>1e3)return i.A.useMultithreading&&e.shared.reservoir[0]++,void(0,l.Nz)(e,t);if(t.threshold.y+=t.velocity.y*r,t.velocity.y+=i.A.gravity*r,t.threshold.y<1)if(t.isFreeFalling)try{(0,l.Y$)(e,t.x,t.y)}catch(e){console.log("Error in reportToChunkAtCellPos",e,JSON.stringify(t))}else x(e,t);else{var o=Math.floor(t.threshold.y);t.threshold.y=t.threshold.y%1;var s=(0,l.tT)(a,t.x,t.y+1);if((0,l.Ol)(s)){var h=t.y+1;if(o>1)for(var c=t.y+o,y=t.y+2;y<=c;y+=1){var d=(0,l.tT)(a,t.x,y);if(!(0,l.Ol)(d))break;h++}t.isFreeFalling=!0;try{(0,l.L3)(e,t,t.x,h)}catch(e){}}else t.isFreeFalling&&t.type===n.RJ.Water&&(0,u.$T)(e,t.x*i.A.cellSize,t.y*i.A.cellSize,u.c6.Water),v(e,t,s,t.x,t.y+1)||(t.isFreeFalling=!1,t.velocity.y*=.9,t.velocity.y<t.minVelocity.y&&(t.velocity.y=t.minVelocity.y),f(e,t)||x(e,t,!0))}}},v=function(e,t,r,i,s){if(t.type===n.RJ.Lava&&r===n.vZ.Ice&&(0,c.P$)(e,i,s,r),(0,l.Bp)(r)){if((0,o.I)(e,t,r))return!0;if((0,h.E)(e,r,t))return!0;if((0,y.N)(e,r,t))return!0;if(!(0,a.qL)(r,n.RJ.Particle)&&!r.isFreeFalling&&t.density>r.density)return(0,l.Hs)(e,t,r.x,r.y,{elementToSwapWith:r}),!0}return!1},f=function(e,t){var r=t.velocity.x<0?-1:1,i=t.x-r,n=t.y+1;return(0,l.lV)(e,i,n)?((0,l.L3)(e,t,i,n),!0):!!g(e,t,i,n)||(i=t.x+r,(0,l.lV)(e,i,n)?((0,l.L3)(e,t,i,n),!0):!!g(e,t,i,n))},x=function(e,t,r){void 0===r&&(r=!1);for(var i,o=s.A.getRandomIntBetween(1,2),h=t.velocity.x<0?-o:o,c=t.x+h,u=t.x;u!==c;){if(u+=h<0?-1:1,!(0,l.lV)(e,u,t.y)){if(r){var y=(0,l.QC)(e,u,t.y);if(null!==y&&(0,a.r8)(y,n.es.Gas))return g(e,t,u,t.y),!0}break}i=u}return i?(t.movesOnSameYAxis.y!==t.y&&(t.movesOnSameYAxis.y=t.y,t.movesOnSameYAxis.count=0),t.movesOnSameYAxis.count+=1,(0,l.L3)(e,t,i,t.y),!0):(t.lastSideCheckedPosition&&t.x===t.lastSideCheckedPosition||(0,l.Y$)(e,t.x,t.y),t.lastSideCheckedPosition=t.x,t.velocity.x=-t.velocity.x,!1)},g=function(e,t,r,n){if(i.A.useMultithreading){var o=e.environment;if(s.A.getThreadIndexFromCellX(r,o.threadMeta.threadCount)!==o.threadMeta.startingIndex){var h=e.shared.imageData,c=4*(r+n*h.width);if(0!==h.data[c+3]){var u=e.session.colors.elementByColor[h.data[c]][h.data[c+1]][h.data[c+2]],y=a.m5[u];if(!y)return console.log(u,"does not exist in ELEMENT_CONFIG"),!1;if(t.density>y.density)return(0,l.Hs)(e,t,r,n),!0}return!1}}var d=(0,l.tT)(e.store,r,n);return!!v(e,t,d,r,n)}},3639:(e,t,r)=>{r.d(t,{s:()=>c});var i=r(7028),n=r(6185),a=r(3734),o=r(1872),l=r(5676),s=r(4631),h=r(7514),c=function(e,t,r){var n=e.store;if(!t.hasBeenUpdated&&(0,o.Do)(n,t.x,t.y)){(0,s.v)(e,t),t.threshold.x+=t.velocity.x*r,t.threshold.y+=t.velocity.y*r,u(n,t)&&(t.velocity.y+=i.A.gravity*r);var h=t.threshold.x<0?Math.ceil(t.threshold.x):Math.floor(t.threshold.x),c=t.threshold.y<0?Math.ceil(t.threshold.y):Math.floor(t.threshold.y);if(0!==h||0!==c){0!==h&&(t.threshold.x=t.threshold.x%1),0!==c&&(t.threshold.y=t.threshold.y%1);var v={x:t.x+h,y:t.y+c},f=d(e,t,v);if(f.lastNonEmpty||f.lastEmpty)if(f.lastNonEmpty)if(!i.A.useMultithreading||f.lastNonEmpty.cell&&!f.hitFilter){if((0,o.af)(f.lastNonEmpty.cell,a.RJ.Water)&&!(0,l.qL)(t.element,a.RJ.FreezingIce)){var x=f.lastNonEmpty.cell;return t.velocity.x*=.98,void(0,o.Hs)(e,t,x.x,x.y,{elementToSwapWith:x})}f.lastEmpty&&(0,o.L3)(e,t,f.lastEmpty.x,f.lastEmpty.y),(0,o.af)(f.lastNonEmpty.cell,a.RJ.Particle)?(0,o.Y$)(e,t.x,t.y):y(e,t)}else f.lastEmpty?(0,o.L3)(e,t,f.lastEmpty.x,f.lastEmpty.y):(0,o.QC)(e,f.lastNonEmpty.x,f.lastNonEmpty.y)===a.RJ.Water?(0,o.Hs)(e,t,f.lastNonEmpty.x,f.lastNonEmpty.y):y(e,t);else(0,o.L3)(e,t,f.lastEmpty.x,f.lastEmpty.y);else y(e,t)}else(0,o.Y$)(e,t.x,t.y)}},u=function(e,t){return!0},y=function(e,t){(0,o.Jx)(e,t.x,t.y,t.element),t.element.isFreeFalling=!0,t.element.threshold={x:0,y:0},t.element.velocity={x:t.velocity.x,y:Math.max(t.velocity.y,t.element.minVelocity.y)},t.element.x=t.x,t.element.y=t.y},d=function(e,t,r){for(var a,l=t.x,s=t.y,c=l-r.x,u=s-r.y,y=Math.abs(c)>Math.abs(u),d=c<0?1:-1,v=u<0?1:-1,f=Math.max(Math.abs(c),Math.abs(u)),x=Math.min(Math.abs(c),Math.abs(u)),g=0==x||0==f?0:x/f,m=null,p=1;p<=f;p++){a=Math.round(p*g);var S=void 0,A=void 0;y?(A=p,S=a):(S=p,A=a);var R=s+S*v,M=l+A*d;if(M<0||M>=e.store.world.size.width||R<0||R>=e.store.world.size.height)return{lastNonEmpty:null,lastEmpty:null};var F=h.A.get(e.session,"structures",Math.floor(M/i.A.snapGridCellSize)*i.A.snapGridCellSize,Math.floor(R/i.A.snapGridCellSize)*i.A.snapGridCellSize);if(F&&(F.filter||F.queued)){var k=h.A.get(e.session,"structures",Math.floor(t.x/i.A.snapGridCellSize)*i.A.snapGridCellSize,Math.floor(t.y/i.A.snapGridCellSize)*i.A.snapGridCellSize);if(!k||!k.queued)return{lastNonEmpty:{x:M,y:R},lastEmpty:m,hitFilter:!0}}if(i.A.useMultithreading){var J=e.environment;if(n.A.getThreadIndexFromCellX(M,J.threadMeta.threadCount)!==J.threadMeta.startingIndex){var b=e.shared.obstacleImageData,L=4*(M+R*b.width),C=b.data[L+3],T=e.shared.imageData.data[L+3];if(C>0||T>0)return{lastNonEmpty:{x:M,y:R},lastEmpty:m};if(m={x:M,y:R},M===r.x&&R===r.y)return{lastNonEmpty:null,lastEmpty:m};continue}}var B=(0,o.tT)(e.store,M,R);if(!(0,o.Ol)(B))return{lastNonEmpty:{cell:B,x:M,y:R},lastEmpty:m};if(m={cell:B,x:M,y:R},M===r.x&&R===r.y)return{lastNonEmpty:null,lastEmpty:m}}}},5161:(e,t,r)=>{r.d(t,{w:()=>g});var i,n=r(7028),a=r(3734),o=r(1872),l=r(5676),s=r(4631),h=r(1558),c=r(2161),u=r(4693),y=r(6185),d=r(7514),v=r(421),f=r(3957),x=r(2127);!function(e){e[e.Both=0]="Both",e[e.None=1]="None",e[e.Right=2]="Right",e[e.Left=3]="Left"}(i||(i={}));var g=function(e,t,r){var c=e.store;if(!t.hasBeenUpdated&&(0,o.Do)(c,t.x,t.y)&&!(0,s.v)(e,t)){var y=!1,f=d.A.get(e.session,"structures",Math.floor(t.x/n.A.snapGridCellSize)*n.A.snapGridCellSize,Math.floor(t.y/n.A.snapGridCellSize)*n.A.snapGridCellSize);f&&(y=f.filter||f.queued),y&&f.filter&&(t.velocity.y=t.minVelocity.y);var g=(0,o.tT)(c,t.x,t.y+1),S=(0,o.OA)(g),A=(0,u.uQ)(e,t,t.x,t.y+1,y),R=!A.authorized,M=i.Both,F=(0,o.Ol)(g);if(S||R||(0,o.W)(g,a.vZ.Block))return t.isFreeFalling=!1,t.velocity.y=t.minVelocity.y,t.velocity.x*=.7,(0,l.Fy)(c,t),S&&!n.A.useMultithreading&&((0,h.c)(e,t,g,f.type),(0,o.Y$)(e,t.x,t.y)),void(0,x.$)(e,t);if(A.authorized&&A.isFilter&&(M=i.None),F||((0,o.W)(g,a.vZ.SlidingBlockLeft)?M=i.Left:(0,o.W)(g,a.vZ.SlidingBlockRight)&&(M=i.Right)),t.threshold.y+=t.velocity.y*r,t.velocity.y+=n.A.gravity*r,t.threshold.y<1)return t.isFreeFalling&&(0,o.Y$)(e,t.x,t.y),void(F||M===i.None||(M!==i.Left&&M!==i.Both||(0,o.lV)(e,t.x-1,t.y+1)&&(0,o.Y$)(e,t.x,t.y),M!==i.Right&&M!==i.Both||(0,o.lV)(e,t.x+1,t.y+1)&&(0,o.Y$)(e,t.x,t.y)));var k=Math.floor(t.threshold.y);if(t.threshold.y=t.threshold.y%1,F){var J=!1,b=t.y+1;if(k>1)for(var L=t.y+k,C=t.y+2;C<=L;C+=1){var T=(0,o.tT)(c,t.x,C),B=(0,o.Ol)(T),z=(0,u.uQ)(e,t,t.x,C,y),w=z.authorized;if(!B||!w){B||(R=!w,g=T),J=!0,!w||z.isFilter||!B&&((0,o.OA)(T)||(0,o.W)(T,a.vZ.Block))?M=i.None:B||((0,o.W)(T,a.vZ.SlidingBlockLeft)?M=i.Left:(0,o.W)(g,a.vZ.SlidingBlockRight)&&(M=i.Right));break}b++}if((0,o.L3)(e,t,t.x,b),!J)return void(t.isFreeFalling=!0)}if((!g||R||!p(e,t,g))&&!(0,v.v)(e,t,g))if(R&&(0,x.$)(e,t))console.log("gro second case... necessary to keep this?");else{if(t.isFreeFalling){var Z=Math.abs(t.velocity.y)/5;Z*=.8+.4*Math.random(),0===t.velocity.x&&(t.velocity.x=2*(Math.random()-.5)),t.velocity.x=t.velocity.x<0?-Z:Z}if(t.isFreeFalling=!1,t.velocity.y*=.95,t.velocity.y<t.minVelocity.y&&(t.velocity.y=t.minVelocity.y),t.threshold.x+=t.velocity.x*r,t.velocity.x*=.95,M!==i.None&&m(e,t,M))t.isFreeFalling=!0;else{if(t.velocity.x<6&&t.velocity.x>-6)return t.velocity.x=0,void(t.threshold.x=0);if(t.threshold.x<1&&t.threshold.x>-1)(0,o.Y$)(e,t.x,t.y);else{var E=t.threshold.x<0?Math.ceil(t.threshold.x):Math.floor(t.threshold.x);t.threshold.x=t.threshold.x%1;for(var I,N,G=t.x+E,W=t.x,O=t.y;W!==G&&(W+=E<0?-1:1,(0,o.lV)(e,W,O)&&(0,u.xR)(e,t,W,O,y));)(0,o.lV)(e,W,O+1)&&(0,u.xR)(e,t,W,O+1,y)&&(O+=1),I=W,N=O;I&&(0,o.L3)(e,t,I,N)}}}}},m=function(e,t,r){var n=t.velocity.x<0?-1:1,a=r===i.Right?t.x+1:r===i.Left?t.x-1:t.x-n,l=t.y+1;if((0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(S(e,t,a,l))return!0}if(r!==i.Both)return!1;if(a=t.x+n,(0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(S(e,t,a,l))return!0}return!1},p=function(e,t,r){if((0,o.Bp)(r)){if((0,c.I)(e,t,r))return!0;if((0,f.E)(e,t,r))return!0;if(!(0,l.qL)(r,a.RJ.Particle)&&!r.isFreeFalling&&(0,l.KZ)(e,t,r))return(0,o.Hs)(e,t,r.x,r.y,{elementToSwapWith:r}),!0}return!1},S=function(e,t,r,i){if(n.A.useMultithreading){var a=e.environment;if(y.A.getThreadIndexFromCellX(r,a.threadMeta.threadCount)!==a.threadMeta.startingIndex){var s=e.shared.imageData,h=4*(r+i*s.width);if(0!==s.data[h+3]){var c=e.session.colors.elementByColor[s.data[h]][s.data[h+1]][s.data[h+2]],u=l.m5[c];if(!u)return console.log(c,"does not exist in ELEMENT_CONFIG"),!1;if((0,l.KZ)(e,t,{type:c,density:u.density}))return(0,o.Hs)(e,t,r,i),!0}return!1}}var d=(0,o.tT)(e.store,r,i);return!!p(e,t,d)}},5194:(e,t,r)=>{r.d(t,{h:()=>m});var i,n=r(7028),a=r(3734),o=r(1872),l=r(5676),s=r(4631),h=r(1558),c=r(2161),u=r(4693),y=r(6185),d=r(7514),v=r(421),f=r(3957),x=r(2127),g=r(3452);!function(e){e[e.Both=0]="Both",e[e.None=1]="None",e[e.Right=2]="Right",e[e.Left=3]="Left"}(i||(i={}));var m=function(e,t,r){var c=e.store;if(!t.hasBeenUpdated&&(0,o.Do)(c,t.x,t.y)&&!(0,s.v)(e,t)){var y=!1,f=d.A.get(e.session,"structures",Math.floor(t.x/n.A.snapGridCellSize)*n.A.snapGridCellSize,Math.floor(t.y/n.A.snapGridCellSize)*n.A.snapGridCellSize);f&&(y=f.filter||f.queued),y&&f.filter&&(t.velocity.y=t.minVelocity.y);var g=(0,o.tT)(c,t.x,t.y+1),m=(0,o.OA)(g),A=(0,u.uQ)(e,t,t.x,t.y+1,y),R=!A.authorized,M=i.Both,F=(0,o.Ol)(g);if(m||R||(0,o.W)(g,a.vZ.Block))return t.isFreeFalling=!1,t.velocity.y=t.minVelocity.y,t.velocity.x=0,(0,l.Fy)(c,t),m&&!n.A.useMultithreading&&((0,h.c)(e,t,g,f.type),(0,o.Y$)(e,t.x,t.y)),void(0,x.$)(e,t);if(A.authorized&&A.isFilter&&(M=i.None),F||((0,o.W)(g,a.vZ.SlidingBlockLeft)?M=i.Left:(0,o.W)(g,a.vZ.SlidingBlockRight)&&(M=i.Right)),t.threshold.y+=t.velocity.y*r,t.velocity.y+=n.A.gravity*r,t.threshold.y<1)return t.isFreeFalling&&(0,o.Y$)(e,t.x,t.y),void(F||M===i.None||(M!==i.Left&&M!==i.Both||(0,o.lV)(e,t.x-1,t.y+1)&&(0,o.Y$)(e,t.x,t.y),M!==i.Right&&M!==i.Both||(0,o.lV)(e,t.x+1,t.y+1)&&(0,o.Y$)(e,t.x,t.y)));var k=Math.floor(t.threshold.y);if(t.threshold.y=t.threshold.y%1,F){var J=!1,b=t.y+1;if(k>1)for(var L=t.y+k,C=t.y+2;C<=L;C+=1){var T=(0,o.tT)(c,t.x,C),B=(0,o.Ol)(T),z=(0,u.uQ)(e,t,t.x,C,y),w=z.authorized;if(!B||!w){B||(R=!w,g=T),J=!0,!w||z.isFilter||!B&&((0,o.OA)(T)||(0,o.W)(T,a.vZ.Block))?M=i.None:B||((0,o.W)(T,a.vZ.SlidingBlockLeft)?M=i.Left:(0,o.W)(g,a.vZ.SlidingBlockRight)&&(M=i.Right));break}b++}if((0,o.L3)(e,t,t.x,b),!J)return void(t.isFreeFalling=!0)}if((!g||R||!S(e,t,g))&&!(0,v.v)(e,t,g))if(R&&(0,x.$)(e,t))console.log("gro second case... necessary to keep this?");else{if(t.isFreeFalling){var Z=Math.abs(t.velocity.y)/10;0===t.velocity.x&&(t.velocity.x=Math.random()>=.5?1:-1),t.velocity.x=t.velocity.x<0?-Z:Z}if(t.isFreeFalling=!1,t.velocity.y*=.9,t.velocity.y<t.minVelocity.y&&(t.velocity.y=t.minVelocity.y),t.threshold.x+=t.velocity.x*r,t.velocity.x*=.9,M!==i.None&&p(e,t,M))t.isFreeFalling=!0;else{if(t.velocity.x<6&&t.velocity.x>-6)return t.velocity.x=0,void(t.threshold.x=0);if(t.threshold.x<1&&t.threshold.x>-1)(0,o.Y$)(e,t.x,t.y);else{var E=t.threshold.x<0?Math.ceil(t.threshold.x):Math.floor(t.threshold.x);t.threshold.x=t.threshold.x%1;for(var I,N,G=t.x+E,W=t.x,O=t.y;W!==G&&(W+=E<0?-1:1,(0,o.lV)(e,W,O)&&(0,u.xR)(e,t,W,O,y));)(0,o.lV)(e,W,O+1)&&(0,u.xR)(e,t,W,O+1,y)&&(O+=1),I=W,N=O;I&&(0,o.L3)(e,t,I,N)}}}}},p=function(e,t,r){var n=t.velocity.x<0?-1:1,a=r===i.Right?t.x+1:r===i.Left?t.x-1:t.x-n,l=t.y+1;if((0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(A(e,t,a,l))return!0}if(r!==i.Both)return!1;if(a=t.x+n,(0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(A(e,t,a,l))return!0}return!1},S=function(e,t,r){if((0,o.Bp)(r)){if((0,c.I)(e,t,r))return!0;if((0,f.E)(e,t,r))return!0;if((0,g.N)(e,r,t))return!0;if(!(0,l.qL)(r,a.RJ.Particle)&&!r.isFreeFalling&&(0,l.KZ)(e,t,r))return(0,o.Hs)(e,t,r.x,r.y,{elementToSwapWith:r}),!0}return!1},A=function(e,t,r,i){if(n.A.useMultithreading){var a=e.environment;if(y.A.getThreadIndexFromCellX(r,a.threadMeta.threadCount)!==a.threadMeta.startingIndex){var s=e.shared.imageData,h=4*(r+i*s.width);if(0!==s.data[h+3]){var c=e.session.colors.elementByColor[s.data[h]][s.data[h+1]][s.data[h+2]],u=l.m5[c];if(!u)return console.log(c,"does not exist in ELEMENT_CONFIG"),!1;if((0,l.KZ)(e,t,{type:c,density:u.density}))return(0,o.Hs)(e,t,r,i),!0}return!1}}var d=(0,o.tT)(e.store,r,i);return!!S(e,t,d)}},5053:(e,t,r)=>{r.d(t,{z:()=>g});var i,n=r(7028),a=r(3734),o=r(1872),l=r(5676),s=r(4631),h=r(1558),c=r(2161),u=r(4693),y=r(6185),d=r(7514),v=r(421),f=r(3957),x=r(2127);!function(e){e[e.Both=0]="Both",e[e.None=1]="None",e[e.Right=2]="Right",e[e.Left=3]="Left"}(i||(i={}));var g=function(e,t,r){var c=e.store;if(!t.hasBeenUpdated&&(0,o.Do)(c,t.x,t.y)){if((0,o.Ol)((0,o.tT)(c,t.x,t.y+1))){var y=.5+Math.random();if(t.velocity.y=Math.min(t.velocity.y+1*n.A.gravity*y*r,6),0===t.velocity.x&&(t.velocity.x=Math.random()>.5?8:-8),Math.random()<.1&&(t.velocity.x*=-1,Math.random()<.3&&(t.velocity.y*=.5)),t.threshold.x+=t.velocity.x*r,t.threshold.y+=t.velocity.y*r,Math.abs(t.threshold.x)>=1){var f=t.threshold.x<0?Math.ceil(t.threshold.x):Math.floor(t.threshold.x);t.threshold.x=t.threshold.x%1;var g=t.x+f;if((0,o.lV)(e,g,t.y))return void(0,o.L3)(e,t,g,t.y)}}else t.velocity.x=0,t.velocity.y=t.minVelocity.y;if(!(0,s.v)(e,t)){var S=!1,A=d.A.get(e.session,"structures",Math.floor(t.x/n.A.snapGridCellSize)*n.A.snapGridCellSize,Math.floor(t.y/n.A.snapGridCellSize)*n.A.snapGridCellSize);A&&(S=A.filter||A.queued),S&&A.filter&&(t.velocity.y=t.minVelocity.y);var R=(0,o.tT)(c,t.x,t.y+1),M=(0,o.OA)(R),F=(0,u.uQ)(e,t,t.x,t.y+1,S),k=!F.authorized,J=i.Both,b=(0,o.Ol)(R);if(M||k||(0,o.W)(R,a.vZ.Block))return t.isFreeFalling=!1,t.velocity.y=t.minVelocity.y,t.velocity.x=0,(0,l.Fy)(c,t),M&&!n.A.useMultithreading&&((0,h.c)(e,t,R,A.type),(0,o.Y$)(e,t.x,t.y)),void(0,x.$)(e,t);if(F.authorized&&F.isFilter&&(J=i.None),b||((0,o.W)(R,a.vZ.SlidingBlockLeft)?J=i.Left:(0,o.W)(R,a.vZ.SlidingBlockRight)&&(J=i.Right)),t.threshold.y+=t.velocity.y*r,t.velocity.y+=n.A.gravity*r,t.threshold.y<1)return t.isFreeFalling&&(0,o.Y$)(e,t.x,t.y),void(b||J===i.None||(J!==i.Left&&J!==i.Both||(0,o.lV)(e,t.x-1,t.y+1)&&(0,o.Y$)(e,t.x,t.y),J!==i.Right&&J!==i.Both||(0,o.lV)(e,t.x+1,t.y+1)&&(0,o.Y$)(e,t.x,t.y)));var L=Math.floor(t.threshold.y);if(t.threshold.y=t.threshold.y%1,b){var C=!1,T=t.y+1;if(L>1)for(var B=t.y+L,z=t.y+2;z<=B;z+=1){var w=(0,o.tT)(c,t.x,z),Z=(0,o.Ol)(w),E=(0,u.uQ)(e,t,t.x,z,S),I=E.authorized;if(!Z||!I){Z||(k=!I,R=w),C=!0,!I||E.isFilter||!Z&&((0,o.OA)(w)||(0,o.W)(w,a.vZ.Block))?J=i.None:Z||((0,o.W)(w,a.vZ.SlidingBlockLeft)?J=i.Left:(0,o.W)(R,a.vZ.SlidingBlockRight)&&(J=i.Right));break}T++}if((0,o.L3)(e,t,t.x,T),!C)return void(t.isFreeFalling=!0)}if((!R||k||!p(e,t,R))&&!(0,v.v)(e,t,R))if(k&&(0,x.$)(e,t))console.log("gro second case... necessary to keep this?");else{if(t.isFreeFalling){var N=Math.abs(t.velocity.y)/10;0===t.velocity.x&&(t.velocity.x=Math.random()>=.5?1:-1),t.velocity.x=t.velocity.x<0?-N:N}if(t.isFreeFalling=!1,t.velocity.y*=.9,t.velocity.y<t.minVelocity.y&&(t.velocity.y=t.minVelocity.y),t.threshold.x+=t.velocity.x*r,t.velocity.x*=.9,J!==i.None&&m(e,t,J))t.isFreeFalling=!0;else{if(t.velocity.x<6&&t.velocity.x>-6)return t.velocity.x=0,void(t.threshold.x=0);if(t.threshold.x<1&&t.threshold.x>-1)(0,o.Y$)(e,t.x,t.y);else{var G=t.threshold.x<0?Math.ceil(t.threshold.x):Math.floor(t.threshold.x);t.threshold.x=t.threshold.x%1;for(var W,O,D=t.x+G,V=t.x,P=t.y;V!==D&&(V+=G<0?-1:1,(0,o.lV)(e,V,P)&&(0,u.xR)(e,t,V,P,S));)(0,o.lV)(e,V,P+1)&&(0,u.xR)(e,t,V,P+1,S)&&(P+=1),W=V,O=P;W&&(0,o.L3)(e,t,W,O)}}}}}},m=function(e,t,r){var n=t.velocity.x<0?-1:1,a=r===i.Right?t.x+1:r===i.Left?t.x-1:t.x-n,l=t.y+1;if((0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(S(e,t,a,l))return!0}if(r!==i.Both)return!1;if(a=t.x+n,(0,u.xR)(e,t,a,l,!1,{isDiagonalCheck:!0})){if((0,o.lV)(e,a,l))return(0,o.L3)(e,t,a,l),!0;if(S(e,t,a,l))return!0}return!1},p=function(e,t,r){if((0,o.Bp)(r)){if((0,c.I)(e,t,r))return!0;if((0,f.E)(e,t,r))return!0;if(!(0,l.qL)(r,a.RJ.Particle)&&!r.isFreeFalling&&(0,l.KZ)(e,t,r))return(0,o.Hs)(e,t,r.x,r.y,{elementToSwapWith:r}),!0}return!1},S=function(e,t,r,i){if(n.A.useMultithreading){var a=e.environment;if(y.A.getThreadIndexFromCellX(r,a.threadMeta.threadCount)!==a.threadMeta.startingIndex){var s=e.shared.imageData,h=4*(r+i*s.width);if(0!==s.data[h+3]){var c=e.session.colors.elementByColor[s.data[h]][s.data[h+1]][s.data[h+2]],u=l.m5[c];if(!u)return console.log(c,"does not exist in ELEMENT_CONFIG"),!1;if((0,l.KZ)(e,t,{type:c,density:u.density}))return(0,o.Hs)(e,t,r,i),!0}return!1}}var d=(0,o.tT)(e.store,r,i);return!!p(e,t,d)}},2161:(e,t,r)=>{r.d(t,{I:()=>y});var i,n=r(3734),a=r(1872),o=r(5676),l=r(7028),s=r(9529),h=r(6185),c=((i={})[n.RJ.Water]=[[n.RJ.Sand,n.RJ.WetSand],[n.RJ.Spore,n.RJ.WetSpore],[n.RJ.Lava,n.RJ.Steam],[n.RJ.Flame,n.RJ.Steam]],i[n.RJ.Sand]=[[n.RJ.Water,n.RJ.WetSand]],i[n.RJ.Spore]=[[n.RJ.Water,n.RJ.WetSpore]],i[n.RJ.Lava]=[[n.RJ.Water,n.RJ.Steam]],i[n.RJ.Flame]=[[n.RJ.Water,n.RJ.Steam]],i[n.RJ.Sandium]=[[n.RJ.Petalium,n.RJ.Gloom]],i[n.RJ.Petalium]=[[n.RJ.Sandium,n.RJ.Gloom]],i),u={},y=function(e,t,r){if(u[t.type]===r.type)return(0,a.Jx)(e,r.x,r.y,n.vZ.Empty),!0;if(u[r.type]===t.type)return(0,a.Jx)(e,t.x,t.y,n.vZ.Empty),!0;var i=c[r.type];return!!i&&i.some((function(i){return t.type===i[0]&&((0,a.Jx)(e,t.x,t.y,(0,o.n)(i[1],t.x,t.y)),l.A.useMultithreading&&(i[1]===n.RJ.WetSand?e.environment.postMessage([n.dD.PlaySound,[{id:"splash",opts:{volume:.01,fadeOut:h.A.getRandomFloatBetween(.1,2),playbackRate:h.A.getRandomFloatBetween(.1,.7)},modulateDistance:{x:r.x*l.A.cellSize,y:r.y*l.A.cellSize}},{id:"splash_2",opts:{volume:.025,playbackRate:h.A.getRandomFloatBetween(.1,1)},modulateDistance:{x:r.x*l.A.cellSize,y:r.y*l.A.cellSize}}]]):i[1]===n.RJ.Steam&&e.environment.postMessage([n.dD.PlaySound,[{id:"vaporize",opts:{volume:.1,fadeOut:h.A.getRandomFloatBetween(.1,.5),playbackRate:h.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:r.x*l.A.cellSize,y:r.y*l.A.cellSize}}]])),[t.type,r.type].includes(n.RJ.Spore)||[t.type,r.type].includes(n.RJ.Lava)?(0,a.Jx)(e,r.x,r.y,n.vZ.Empty):(0,a.Jx)(e,r.x,r.y,(0,o.n)(i[1],r.x,r.y)),l.A.useMultithreading?e.store.tutorial.active&&e.environment.postMessage([n.dD.TutorialStep,n.vJ.WetSand]):(0,s.O)(e,n.vJ.WetSand),!0)}))}},5502:(e,t,r)=>{r.d(t,{$T:()=>a,c6:()=>i}),r(4249);var i,n=r(6185);!function(e){e[e.Fire=0]="Fire",e[e.Water=1]="Water"}(i||(i={}));var a=function(e,t,r,a){var o=n.A.getDistance({x:t,y:r},{x:e.shared.playerPos[0],y:e.shared.playerPos[1]}),l=t-e.shared.playerPos[0],s=Math.min(1,Math.max(-1,l/1e3));a===i.Fire&&o<e.shared.naturalAmbience[0]?(e.shared.naturalAmbience[0]=o,e.shared.naturalAmbience[1]=s):a===i.Water&&o<e.shared.naturalAmbience[2]&&(e.shared.naturalAmbience[2]=o,e.shared.naturalAmbience[3]=s)}},446:(e,t,r)=>{r(3734),r(3844)},9025:(e,t,r)=>{r.d(t,{$4:()=>l,l2:()=>s});var i,n=r(3734),a=r(6185),o=[[92,214,214],[77,209,209]],l=[a.A.HSLToRGBA(0,0,60),a.A.HSLToRGBA(0,0,58),a.A.HSLToRGBA(0,0,65)],s=((i={})[n.vZ.Bedrock]={name:"Bedrock",interactions:["âŒ"],background:{model:"rgb",fg:l[0],bg:l[1],patternSprite:"backdrop_variant"}},i[n.vZ.Divider]={hp:1,interactions:["â›ï¸","ðŸ’¥","ðŸ”¥"]},i[n.vZ.SandSoil]={name:"Sandsoil",interactions:["â›ï¸","ðŸ’¥"],hp:4,output:{elementType:n.RJ.Sand,chance:.5}},i[n.vZ.Grass]={name:"Grass",interactions:["â›ï¸","ðŸ’¥"],hp:4,colorHSL:[94,45,48],output:{elementType:n.RJ.Sand,chance:.5}},i[n.vZ.Moss]={name:"Moss",interactions:["â›ï¸","ðŸ’¥","ðŸ”¥"],hp:1,colorHSL:[100,72,47]},i[n.vZ.GoldSoil]={hp:1,output:{elementType:n.RJ.Gold,chance:1}},i[n.vZ.Petal]={hp:1,output:{elementType:n.RJ.Petalium,chance:1}},i[n.vZ.SporeSoil]={name:"Sporemound",interactions:["â›ï¸","ðŸ’¥"],hp:4,output:{elementType:n.RJ.Spore,chance:.5}},i[n.vZ.Fog]={hp:1,backgroundElementType:n.RJ.Sand,fog:!0},i[n.vZ.FogJetpackBlock]={hp:1,background:{model:"rgb",fg:o[0],bg:o[1],patternSprite:"no_jetpack_backdrop"},fog:!0},i[n.vZ.FogWater]={hp:1,backgroundElementType:n.RJ.Sand,fog:!0},i[n.vZ.FogLava]={hp:1,backgroundElementType:n.RJ.Sand,fog:!0},i[n.vZ.FreezingIceSoil]={name:"Frostbed",interactions:["â›ï¸","ðŸ’¥"],hp:4,colorHSL:[180,30,95],background:{model:"rgb",fg:o[0],bg:o[1],patternSprite:"no_jetpack_backdrop"},output:{elementType:n.RJ.FreezingIce,chance:.5}},i[n.vZ.Fluxite]={name:"Fluxite",interactions:["â›ï¸","ðŸ’¥"],hp:8,colorHSL:[287,100,44],background:{model:"rgb",fg:a.A.HSLToRGBA(287,100,44),bg:a.A.HSLToRGBA(287,100,46)}},i[n.vZ.Ice]={name:"Ice",interactions:["ðŸ”¥"]},i[n.vZ.SandiumSoil]={name:"Redsoil",interactions:["â›ï¸","ðŸ’¥"],hp:20,output:{elementType:n.RJ.Sandium,chance:.5},colorHSL:[0,100,32]},i[n.vZ.Obsidian]={name:"Scoria",interactions:["â›ï¸","ðŸ’¥"],hp:40,output:{elementType:n.RJ.Basalt,chance:1},colorHSL:[0,100,15]},i[n.vZ.Crackstone]={name:"Crackstone",interactions:["ðŸ’¥"],hp:1,colorHSL:[40,40,80],background:{model:"rgb",fg:a.A.HSLToRGBA(40,40,64),bg:a.A.HSLToRGBA(40,40,66)}},i)},4631:(e,t,r)=>{r.d(t,{v:()=>s});var i=r(3734),n=r(1872),a=r(3812),o=r(9241),l=r(6185),s=function(e,t){var r=e.store;if(t.type!==i.RJ.Particle&&!r.machineryEngine.runLaunchers)return!1;var l=(0,o.TR)(e,t.x,t.y);if(!l)return!1;if(![i.ev.LauncherUp,i.ev.LauncherLeft,i.ev.LauncherRight].includes(l.type))return!1;var s=c(l.type);return t.type===i.RJ.Particle?(0===s.x?t.velocity.y=s.y:t.velocity=s,(0,n.Y$)(e,t.x,t.y)):(0,a.J)(e,t,s),!0},h=[.54*60,44.4],c=function(e){switch(e){case i.ev.LauncherUp:return{x:0,y:-l.A.getRandomFloatBetween(h[0],h[1])};case i.ev.LauncherLeft:return{x:-l.A.getRandomFloatBetween(h[0],h[1]),y:-l.A.getRandomFloatBetween(h[0],h[1])};case i.ev.LauncherRight:return{x:l.A.getRandomFloatBetween(h[0],h[1]),y:-l.A.getRandomFloatBetween(h[0],h[1])}}}},4571:(e,t,r)=>{r.d(t,{h:()=>s});var i=r(3734),n=r(1872),a=r(5676),o=r(6185),l=r(7028),s=function(e,t){var r=(0,a.n)(i.RJ.Slag,t.x,t.y);r.isFreeFalling=!1,(0,n.Jx)(e,t.x,t.y,r),Math.random()>=.25||(e.store.tutorial.active&&e.environment.postMessage([i.dD.TutorialStep,i.vJ.RefineGoldWithShaker]),(0,n.Jx)(e,t.x,t.y+2,(0,a.n)(i.RJ.Gold,t.x,t.y+2)),e.environment.postMessage([i.dD.PlaySound,[{id:"coin",opts:{volume:.2,fadeOut:o.A.getRandomFloatBetween(.1,2),playbackRate:o.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:t.x*l.A.cellSize,y:t.y*l.A.cellSize}}]]))}},421:(e,t,r)=>{r.d(t,{v:()=>s});var i=r(7028),n=r(3734),a=r(6185),o=r(5676),l=r(1872),s=function(e,t,r){return!(r!==n.vZ.VelocitySoaker||t.type!==n.RJ.BurntSlag||t.velocity.y<200||!h(e,t.x,t.y,n.RJ.Spore)||((0,l.Nz)(e,t),h(e,t.x,t.y,n.RJ.Gold),e.environment.postMessage([n.dD.PlaySound,[{id:"coin",opts:{volume:.2,fadeOut:a.A.getRandomFloatBetween(.1,2),playbackRate:a.A.getRandomFloatBetween(.5,1.5)},modulateDistance:{x:t.x*i.A.cellSize,y:t.y*i.A.cellSize}}]]),0))},h=function(e,t,r,n){for(var a=[{x:Math.floor(t/i.A.snapGridCellSize)*i.A.snapGridCellSize,y:r+2},{x:Math.ceil(t/i.A.snapGridCellSize)*i.A.snapGridCellSize,y:r+4}],s=a[0].y;s<=a[1].y;s++)if((0,l.Ol)((0,l.tT)(e.store,t,s)))return(0,l.Jx)(e,t,s,(0,o.n)(n,t,s)),!0;var h=Array.from({length:a[1].x-a[0].x+1},(function(e,t){return t+a[0].x})),c=Array.from({length:a[1].y-a[0].y+1},(function(e,t){return t+a[0].y}));h=h.sort((function(){return Math.random()-.5})),c=c.sort((function(){return Math.random()-.5}));for(var u=0,y=h;u<y.length;u++)for(var d=y[u],v=0,f=c;v<f.length;v++){var x=f[v];if((0,l.Ol)((0,l.tT)(e.store,d,x)))return(0,l.Jx)(e,d,x,(0,o.n)(n,d,x)),!0}return!1}},5051:(e,t,r)=>{r(3734),r(9241),r(2234)},8135:(e,t,r)=>{var i=r(3734);i.Np.Flamethrower,i.Np.Gun,i.Np.RocketLauncher,i.xQ.Drones1,i.Np.Hauler,i.Np.Bouncer},8792:(e,t,r)=>{r(6185);var i=r(7028);r(1872),r(7815),i.A.fps},4890:(e,t,r)=>{var i=r(3734);r(9241),r(7815),{}[i.KW.Artifact]="artifact"},3844:(e,t,r)=>{r.d(t,{Aq:()=>i}),r(6540);var i=function(e,t,r){void 0===r&&(r={});var i=function(e,t,r){return r.key?e.session.ui.listeners[t][r.key]:e.session.ui.listeners[t]}(e,t,r);i&&0!==i.length&&i.forEach((function(e){return e.callback()}))}},2539:(e,t,r)=>{r(3734),r(3844)},9529:(e,t,r)=>{r.d(t,{O:()=>l});var i=r(7028),n=r(3734),a=(r(9108),r(3844)),o=(r(446),r(2539),function(e){e.store.tutorial.transitioningToNextStep=e.store.meta.time,(0,a.Aq)(e,n.JU.Tutorial)}),l=function(e,t,r){if(e.store.tutorial.active&&e.store.scene.active===n.Z5.Game&&!e.store.tutorial.transitioningToNextStep&&e.store.tutorial.currentStep===t){switch(t){case n.vJ.Dig:if(e.store.tutorial.data.amount++,(0,a.Aq)(e,n.JU.Tutorial),e.store.tutorial.data.amount<5)return;break;case n.vJ.Hotbar:if(1!==r)return;return void o(e);case n.vJ.PickUpSand:var s=i.A.useMultithreading?e.shared.grabber[1]:r.tool.data[1];if((0,a.Aq)(e,n.JU.Tutorial),s<5)return;break;case n.vJ.RefineWetSand:if(e.store.tutorial.data.amount++,(0,a.Aq)(e,n.JU.Tutorial),e.store.tutorial.data.amount<3)return;break;case n.vJ.SellGold:if((0,a.Aq)(e,n.JU.Tutorial),e.store.resources.gold<20)return;break;case n.vJ.OpenTechTree:setTimeout((function(){e.store.player.tech[n.xQ.Refining1]&&l(e,n.vJ.UnlockRefining)}),5e3);break;case n.vJ.BuildShaker:if(![n.ev.ShakerLeft,n.ev.ShakerRight].includes(r))return;if(e.store.tutorial.data.amount++,(0,a.Aq)(e,n.JU.Tutorial),e.store.tutorial.data.amount<5)return;break;case n.vJ.RefineGoldWithShaker:setTimeout((function(){e.store.player.tech[n.xQ.Logistics1]&&l(e,n.vJ.UnlockLogistics)}),5e3)}o(e)}}},6185:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(7028),n={iterateToAndGetLastPosFulfillingCondition:function(e,t,r){for(var i,n=e.x,a=e.y,o=n-t.x,l=a-t.y,s=Math.abs(o)>Math.abs(l),h=o<0?1:-1,c=l<0?1:-1,u=Math.max(Math.abs(o),Math.abs(l)),y=Math.min(Math.abs(o),Math.abs(l)),d=0==y||0==u?0:y/u,v=e.x,f=e.y,x=1;x<=u;x++){i=Math.round(x*d);var g=void 0,m=void 0;s?(m=x,g=i):(g=x,m=i);var p=a+g*c,S=n+m*h;if(!r(S,p,v,f))return{x:v,y:f};v=S,f=p}return{x:v,y:f}},getAllOverlappingCellsFulfillingConditionFromPixelDimensions:function(e,t,r,n,a){for(var o=e-e%i.A.cellSize,l=t-t%i.A.cellSize,s={x:o/i.A.cellSize,y:l/i.A.cellSize},h=e+r-1-(e+r-1)%i.A.cellSize,c=t+n-1-(t+n-1)%i.A.cellSize,u=h/i.A.cellSize,y=c/i.A.cellSize,d=[],v=s.y;v<=y;v+=1)for(var f=s.x;f<=u;f+=1)a(f,v)&&d.push({x:f,y:v});return d.sort((function(e,t){return e.x-t.x})),d},getCoordinatesBetweenPoints:function(e,t){for(var r=[],i=t.x-e.x,n=t.y-e.y,a=Math.max(Math.abs(i),Math.abs(n)),o=i/a,l=n/a,s=e.x,h=e.y,c=0;c<a;c++)s+=o,h+=l,r.push({x:Math.round(s),y:Math.round(h)});return r},getCoordinatesFromAngleAndDistance:function(e,t,r){for(var i=[],n=0;n<=r;n++){var a=Math.round(Math.cos(t*Math.PI/180)*n+e.x),o=Math.round(Math.sin(t*Math.PI/180)*n+e.y);i.push({x:a,y:o})}return i},getDistance:function(e,t){var r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)},getAngle:function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},getPointFromAngleAndDistance:function(e,t,r){return{x:Math.floor(Math.cos(t*Math.PI/180)*r+e.x),y:Math.floor(Math.sin(t*Math.PI/180)*r+e.y)}},getVelocityFromAngle:function(e){return{x:Math.cos(e*Math.PI/180),y:Math.sin(e*Math.PI/180)}},getAngleFromVelocity:function(e){return 180*Math.atan2(e.y,e.x)/Math.PI},getRandomIntBetween:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)},getRandomFloatBetween:function(e,t){var r=Math.random()*(t-e)+e;return parseFloat(r)},getArmAxis:function(e){return{x:e.x+2+1*i.A.cellSize,y:e.y+2+3*i.A.cellSize+2}},getGunArmAxis:function(e){return{x:e.x+2+1*i.A.cellSize,y:e.y+2+3*i.A.cellSize+2}},getImageDataFromImage:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height)},HSLToRGBA:function(e,t,r){r/=100;var i=function(t){return(t+e/30)%12},n=(t/=100)*Math.min(r,1-r),a=function(e){return r-n*Math.max(-1,Math.min(i(e)-3,Math.min(9-i(e),1)))};return[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4)),255]},isChunkIndexInThread:function(e,t,r){return 2*Math.floor(e/2)%(2*r)==2*t},isCellXInThread:function(e,t,r){var a=Math.floor(e/i.A.chunkSize)*i.A.chunkSize/i.A.chunkSize;return n.isChunkIndexInThread(a,t,r)},getThreadIndexFromCellX:function(e,t){var r=2*i.A.chunkSize;return Math.floor(e/r)*r/r%t},isCellXAtThreadSeam:function(e){var t=2*i.A.chunkSize,r=Math.floor(e/t)*t;return e===r||e===r+t-1},getThreadColumnSize:function(){return 2*i.A.chunkSize},getNumberOfThreadColumns:function(e){return Math.floor(e.store.world.size.width/n.getThreadColumnSize())},getAllChunkIndexesInThread:function(e,t,r){for(var a=[],o=Math.floor(e.store.world.size.width/i.A.chunkSize),l=0;l<o;l+=1)n.isChunkIndexInThread(l,t,r)&&a.push(l);return a},doRectanglesOverlap:function(e,t){return!(e.x>=t.x+t.width||t.x>=e.x+e.width||e.y>=t.y+t.height||t.y>=e.y+e.height)},shuffleArray:function(e){for(var t,r=e.length-1;r>0;r--){var i=Math.floor(Math.random()*(r+1));t=[e[i],e[r]],e[r]=t[0],e[i]=t[1]}},getDirection:function(e,t){var r=t.x-e.x,i=t.y-e.y,n=Math.sqrt(r*r+i*i);return{x:n?r/n:0,y:n?i/n:0}}};const a=n},2587:(e,t,r)=>{r(6185)},7509:(e,t,r)=>{r(3734)},1656:e=>{e.exports=JSON.parse('{"conveyor-belt-left":[[4,4,4,4],[3,3,3,3],[3,3,3,3],[3,3,3,3]],"conveyor-belt-right":[[5,5,5,5],[3,3,3,3],[3,3,3,3],[3,3,3,3]],"conveyor-belt-shaker-left":[[4,6,6,6],[3,0,0,0],[3,0,0,0],[3,0,0,0]],"conveyor-belt-shaker-right":[[7,7,7,5],[0,0,0,3],[0,0,0,3],[0,0,0,3]],"splitter-left":[[0,0,8,0],[0,0,0,8],[0,0,0,3],[0,0,0,3]],"splitter-right":[[0,8,0,0],[8,0,0,0],[3,0,0,0],[3,0,0,0]],"dropper":[[8,0,0,8],[8,0,8,3],[8,0,3,3],[0,8,3,3]],"dropper-2":[[8,0,0,8],[3,0,0,3],[3,0,0,3],[3,8,0,3]],"foundation":[[3,3,3,3],[3,3,3,3],[3,3,3,3],[3,3,3,3]],"foundation-triangle-left":[[0,0,0,9],[0,0,9,3],[0,9,3,3],[9,3,3,3]],"foundation-triangle-right":[[10,0,0,0],[3,10,0,0],[3,3,10,0],[3,3,3,10]],"foundation-triangle-left-del":[[3,3,3,3],[0,3,3,3],[0,0,3,3],[0,0,0,3]],"foundation-triangle-right-del":[[3,3,3,3],[3,3,3,0],[3,3,0,0],[3,0,0,0]],"sliding-foundation":[[8,8,8,8],[8,8,8,8],[8,8,8,8],[8,8,8,8]],"velocity-soaker":[[11,11,11,11],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"grower":[[12,12,12,12],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}')}}]);